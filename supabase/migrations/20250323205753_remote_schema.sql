create extension if not exists "pg_net" with schema "public" version '0.14.0';

create sequence if not exists "public"."agent_1742397281528_id_seq";

create sequence if not exists "public"."agent_1742425072029_id_seq";

create sequence if not exists "public"."agent_1742426304880_id_seq";

create sequence if not exists "public"."ai_agent_id_seq";

create sequence if not exists "public"."airtable_id_seq";

create sequence if not exists "public"."asd_id_seq";

create sequence if not exists "public"."ask_parent_handbook_id_seq";

create sequence if not exists "public"."buffalo_school_board_id_seq";

create sequence if not exists "public"."byclicks_id_seq";

create sequence if not exists "public"."cc_id_seq";

create sequence if not exists "public"."client_3_id_seq";

create sequence if not exists "public"."coca_cola_id_seq";

create sequence if not exists "public"."coins_id_seq";

create sequence if not exists "public"."deals_id_seq";

create sequence if not exists "public"."digicel_id_seq";

create sequence if not exists "public"."document_links_id_seq";

create sequence if not exists "public"."frenniy_id_seq";

create sequence if not exists "public"."g_g_id_seq";

create sequence if not exists "public"."gaiivo_id_seq";

create sequence if not exists "public"."glouglu_id_seq";

create sequence if not exists "public"."google_drive_links_id_seq";

create sequence if not exists "public"."great_deal_id_seq";

create sequence if not exists "public"."imanye_3_id_seq";

create sequence if not exists "public"."llama11_id_seq";

create sequence if not exists "public"."llama1_id_seq";

create sequence if not exists "public"."llama3_id_seq";

create sequence if not exists "public"."llama4_id_seq";

create sequence if not exists "public"."llama5_id_seq";

create sequence if not exists "public"."llama7_id_seq";

create sequence if not exists "public"."llama9_id_seq";

create sequence if not exists "public"."mailer_id_seq";

create sequence if not exists "public"."manyel_2_id_seq";

create sequence if not exists "public"."metricool_id_seq";

create sequence if not exists "public"."n8n123_id_seq";

create sequence if not exists "public"."n8n_chat_histories_id_seq";

create sequence if not exists "public"."n8n_id_seq";

create sequence if not exists "public"."neem_25_id_seq";

create sequence if not exists "public"."news_2_id_seq";

create sequence if not exists "public"."news_3_id_seq";

create sequence if not exists "public"."news_4_id_seq";

create sequence if not exists "public"."news_5_id_seq";

create sequence if not exists "public"."news_id_seq";

create sequence if not exists "public"."news_one_id_seq";

create sequence if not exists "public"."nnmo1_id_seq";

create sequence if not exists "public"."notion_id_seq";

create sequence if not exists "public"."pet__pets_id_seq";

create sequence if not exists "public"."pierreme123_id_seq";

create sequence if not exists "public"."pierreme12_id_seq";

create sequence if not exists "public"."primelee1_id_seq";

create sequence if not exists "public"."proque_id_seq";

create sequence if not exists "public"."proton_id_seq";

create sequence if not exists "public"."sadhana_forest_id_seq";

create sequence if not exists "public"."saldo_id_seq";

create sequence if not exists "public"."story_id_seq";

create sequence if not exists "public"."teplate_id_seq";

create sequence if not exists "public"."tesi_id_seq";

create sequence if not exists "public"."test12345_id_seq";

create sequence if not exists "public"."test1t_id_seq";

create sequence if not exists "public"."test5_id_seq";

create sequence if not exists "public"."test6_gmail_com_id_seq";

create sequence if not exists "public"."test7_id_seq";

create sequence if not exists "public"."test_98_id_seq";

create sequence if not exists "public"."test_agent_1741894950_id_seq";

create sequence if not exists "public"."test_agent_1741895003_id_seq";

create sequence if not exists "public"."test_xyt7ti_id_seq";

create sequence if not exists "public"."testa_id_seq";

create sequence if not exists "public"."testab_id_seq";

create sequence if not exists "public"."testac_id_seq";

create sequence if not exists "public"."testad_id_seq";

create sequence if not exists "public"."testagen6_id_seq";

create sequence if not exists "public"."testagent1_id_seq";

create sequence if not exists "public"."testagent4_id_seq";

create sequence if not exists "public"."testagent5_id_seq";

create sequence if not exists "public"."testagent7_id_seq";

create sequence if not exists "public"."testagent8_id_seq";

create sequence if not exists "public"."testagent_id_seq";

create sequence if not exists "public"."testb_id_seq";

create sequence if not exists "public"."testc_id_seq";

create sequence if not exists "public"."testclient11_id_seq";

create sequence if not exists "public"."testclient12_id_seq";

create sequence if not exists "public"."testclient3_id_seq";

create sequence if not exists "public"."testclient4_id_seq";

create sequence if not exists "public"."testclient5_id_seq";

create sequence if not exists "public"."testd_id_seq";

create sequence if not exists "public"."teste_id_seq";

create sequence if not exists "public"."testest12_id_seq";

create sequence if not exists "public"."testest1_id_seq";

create sequence if not exists "public"."testest_id_seq";

create sequence if not exists "public"."testf_id_seq";

create sequence if not exists "public"."testg_id_seq";

create sequence if not exists "public"."testglas_id_seq";

create sequence if not exists "public"."testh_id_seq";

create sequence if not exists "public"."testheagent_id_seq";

create sequence if not exists "public"."testit_id_seq";

create sequence if not exists "public"."testj_id_seq";

create sequence if not exists "public"."testk_id_seq";

create sequence if not exists "public"."testl_id_seq";

create sequence if not exists "public"."testm_id_seq";

create sequence if not exists "public"."testme1234_id_seq";

create sequence if not exists "public"."testn_id_seq";

create sequence if not exists "public"."testo_id_seq";

create sequence if not exists "public"."testp_id_seq";

create sequence if not exists "public"."testq_id_seq";

create sequence if not exists "public"."testr_id_seq";

create sequence if not exists "public"."tests_id_seq";

create sequence if not exists "public"."testt_id_seq";

create sequence if not exists "public"."testu_id_seq";

create sequence if not exists "public"."testv_id_seq";

create sequence if not exists "public"."testw_id_seq";

create sequence if not exists "public"."the_agent_id_seq";

create sequence if not exists "public"."thetest_id_seq";

create sequence if not exists "public"."upwork_id_seq";

create sequence if not exists "public"."vahalas_id_seq";

create sequence if not exists "public"."value10_id_seq";

create sequence if not exists "public"."value11_id_seq";

create sequence if not exists "public"."value1_id_seq";

create sequence if not exists "public"."value2_id_seq";

create sequence if not exists "public"."value6_id_seq";

create sequence if not exists "public"."value7_id_seq";

create sequence if not exists "public"."value8_id_seq";

create sequence if not exists "public"."value9_id_seq";

create sequence if not exists "public"."vidgu_id_seq";

create sequence if not exists "public"."vladd2a_id_seq";

create sequence if not exists "public"."vlooh_id_seq";

create sequence if not exists "public"."voigai_id_seq";

create sequence if not exists "public"."website_urls_id_seq";

create sequence if not exists "public"."wechate_id_seq";

create sequence if not exists "public"."your_agent_id_seq";

drop trigger if exists "update_document_processing_updated_at" on "public"."document_processing";

drop policy if exists "Users can view their own AI agent data" on "public"."ai_agents";

drop policy if exists "Service role can access all activities" on "public"."client_activities";

drop policy if exists "Users can view their own activities" on "public"."client_activities";

drop policy if exists "Allow service role full access" on "public"."client_recovery_tokens";

drop policy if exists "Admins can view temp passwords" on "public"."client_temp_passwords";

drop policy if exists "Service role can manage temp passwords" on "public"."client_temp_passwords";

drop policy if exists "Service role can access all client data" on "public"."clients";

drop policy if exists "Users can view their own data" on "public"."clients";

drop policy if exists "Enable insert for authenticated users" on "public"."document_processing";

drop policy if exists "Enable read access for authenticated users" on "public"."document_processing";

drop policy if exists "Enable update for authenticated users" on "public"."document_processing";

drop policy if exists "Users can create processing jobs" on "public"."document_processing_jobs";

drop policy if exists "Users can view their own processing jobs" on "public"."document_processing_jobs";

drop policy if exists "Users can view their own processing status" on "public"."document_processing_status";

drop policy if exists "Admins can view user roles" on "public"."user_roles";

drop policy if exists "Service role can manage user roles" on "public"."user_roles";

revoke delete on table "public"."clients" from "anon";

revoke insert on table "public"."clients" from "anon";

revoke references on table "public"."clients" from "anon";

revoke select on table "public"."clients" from "anon";

revoke trigger on table "public"."clients" from "anon";

revoke truncate on table "public"."clients" from "anon";

revoke update on table "public"."clients" from "anon";

revoke delete on table "public"."clients" from "authenticated";

revoke insert on table "public"."clients" from "authenticated";

revoke references on table "public"."clients" from "authenticated";

revoke select on table "public"."clients" from "authenticated";

revoke trigger on table "public"."clients" from "authenticated";

revoke truncate on table "public"."clients" from "authenticated";

revoke update on table "public"."clients" from "authenticated";

revoke delete on table "public"."clients" from "service_role";

revoke insert on table "public"."clients" from "service_role";

revoke references on table "public"."clients" from "service_role";

revoke select on table "public"."clients" from "service_role";

revoke trigger on table "public"."clients" from "service_role";

revoke truncate on table "public"."clients" from "service_role";

revoke update on table "public"."clients" from "service_role";

revoke delete on table "public"."document_processing" from "anon";

revoke insert on table "public"."document_processing" from "anon";

revoke references on table "public"."document_processing" from "anon";

revoke select on table "public"."document_processing" from "anon";

revoke trigger on table "public"."document_processing" from "anon";

revoke truncate on table "public"."document_processing" from "anon";

revoke update on table "public"."document_processing" from "anon";

revoke delete on table "public"."document_processing" from "authenticated";

revoke insert on table "public"."document_processing" from "authenticated";

revoke references on table "public"."document_processing" from "authenticated";

revoke select on table "public"."document_processing" from "authenticated";

revoke trigger on table "public"."document_processing" from "authenticated";

revoke truncate on table "public"."document_processing" from "authenticated";

revoke update on table "public"."document_processing" from "authenticated";

revoke delete on table "public"."document_processing" from "service_role";

revoke insert on table "public"."document_processing" from "service_role";

revoke references on table "public"."document_processing" from "service_role";

revoke select on table "public"."document_processing" from "service_role";

revoke trigger on table "public"."document_processing" from "service_role";

revoke truncate on table "public"."document_processing" from "service_role";

revoke update on table "public"."document_processing" from "service_role";

revoke delete on table "public"."document_processing_status" from "anon";

revoke insert on table "public"."document_processing_status" from "anon";

revoke references on table "public"."document_processing_status" from "anon";

revoke select on table "public"."document_processing_status" from "anon";

revoke trigger on table "public"."document_processing_status" from "anon";

revoke truncate on table "public"."document_processing_status" from "anon";

revoke update on table "public"."document_processing_status" from "anon";

revoke delete on table "public"."document_processing_status" from "authenticated";

revoke insert on table "public"."document_processing_status" from "authenticated";

revoke references on table "public"."document_processing_status" from "authenticated";

revoke select on table "public"."document_processing_status" from "authenticated";

revoke trigger on table "public"."document_processing_status" from "authenticated";

revoke truncate on table "public"."document_processing_status" from "authenticated";

revoke update on table "public"."document_processing_status" from "authenticated";

revoke delete on table "public"."document_processing_status" from "service_role";

revoke insert on table "public"."document_processing_status" from "service_role";

revoke references on table "public"."document_processing_status" from "service_role";

revoke select on table "public"."document_processing_status" from "service_role";

revoke trigger on table "public"."document_processing_status" from "service_role";

revoke truncate on table "public"."document_processing_status" from "service_role";

revoke update on table "public"."document_processing_status" from "service_role";

alter table "public"."ai_agents" drop constraint if exists "ai_agents_client_id_fkey";

alter table "public"."client_activities" drop constraint if exists "client_activities_client_id_fkey";

alter table "public"."client_recovery_tokens" drop constraint if exists "client_recovery_tokens_client_id_fkey";

alter table "public"."client_recovery_tokens" drop constraint if exists "token_not_empty";

alter table "public"."client_temp_passwords" drop constraint if exists "fk_agent";

alter table "public"."clients" drop constraint if exists "clients_email_key";

alter table "public"."document_processing_jobs" drop constraint if exists "document_processing_jobs_client_id_fkey";

alter table "public"."document_processing_status" drop constraint if exists "document_processing_status_job_id_fkey";

drop function if exists "public"."update_processing_status"(p_job_id uuid, p_status text, p_progress integer, p_stage text, p_message text, p_metadata jsonb);

alter table "public"."clients" drop constraint if exists "clients_pkey";

alter table "public"."document_processing" drop constraint if exists "document_processing_pkey";

alter table "public"."document_processing_status" drop constraint if exists "document_processing_status_pkey";

drop index if exists "public"."client_recovery_tokens_token_idx";

drop index if exists "public"."client_temp_passwords_agent_id_idx";

drop index if exists "public"."client_temp_passwords_email_idx";

drop index if exists "public"."clients_email_key";

drop index if exists "public"."clients_pkey";

drop index if exists "public"."document_processing_pkey";

drop index if exists "public"."document_processing_status_pkey";

drop index if exists "public"."idx_ai_agents_openai_assistant_id";

drop index if exists "public"."idx_client_activities_client_id";

drop index if exists "public"."idx_client_activities_type";

drop index if exists "public"."idx_clients_email";

drop index if exists "public"."idx_clients_status";

drop index if exists "public"."idx_doc_processing_jobs_client_id";

drop index if exists "public"."idx_doc_processing_jobs_status";

drop index if exists "public"."idx_doc_processing_status_job_id";

drop index if exists "public"."idx_document_processing_client_id";

drop index if exists "public"."idx_document_processing_document_url";

drop index if exists "public"."idx_document_processing_status";

drop index if exists "public"."user_roles_role_idx";

drop index if exists "public"."user_roles_user_id_idx";

drop table if exists "public"."clients";

drop table if exists "public"."document_processing";

drop table if exists "public"."document_processing_status";

alter type "public"."activity_type_enum" rename to "activity_type_enum__old_version_to_be_dropped";

create table "public"."agent_1742397281528" (
    "id" bigint not null default nextval('agent_1742397281528_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."agent_1742425072029" (
    "id" bigint not null default nextval('agent_1742425072029_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."agent_1742426304880" (
    "id" bigint not null default nextval('agent_1742426304880_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ai_agent" (
    "id" bigint not null default nextval('ai_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ai_agents_backup" (
    "id" uuid,
    "client_id" uuid,
    "name" text,
    "settings" jsonb,
    "created_at" timestamp with time zone,
    "updated_at" timestamp with time zone,
    "content" text,
    "embedding" vector(1536),
    "url" text,
    "interaction_type" text,
    "query_text" text,
    "response_time_ms" integer,
    "is_error" boolean,
    "error_type" text,
    "error_message" text,
    "error_status" text,
    "topic" text,
    "sentiment" text,
    "agent_description" text
);


create table "public"."ai_documents" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "document_id" text not null,
    "document_url" text not null,
    "document_type" text not null,
    "status" text not null default 'pending'::text,
    "content" text,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now(),
    "agent_name" text not null,
    "error" text,
    "error_message" text,
    "processing_method" text,
    "metadata" jsonb default '{}'::jsonb
);


create table "public"."ai_interactions" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "agent_name" text not null,
    "query_text" text not null,
    "response_text" text not null,
    "created_at" timestamp with time zone default now(),
    "response_time_ms" integer,
    "metadata" jsonb default '{}'::jsonb
);


create table "public"."airtable" (
    "id" bigint not null default nextval('airtable_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."airtable" enable row level security;

create table "public"."asd" (
    "id" bigint not null default nextval('asd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ask_parent_handbook" (
    "id" bigint not null default nextval('ask_parent_handbook_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."buffalo_school_board" (
    "id" bigint not null default nextval('buffalo_school_board_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."buffalo_school_board" enable row level security;

create table "public"."byclicks" (
    "id" bigint not null default nextval('byclicks_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."cc" (
    "id" bigint not null default nextval('cc_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."cc" enable row level security;

create table "public"."client_3" (
    "id" bigint not null default nextval('client_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."client_invitations" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "token" uuid not null,
    "email" text not null,
    "expires_at" timestamp with time zone not null,
    "created_at" timestamp with time zone default now()
);


-- Create extension if not exists
CREATE EXTENSION IF NOT EXISTS "pg_net" WITH SCHEMA "public" VERSION '0.14.0';

-- Create sequences if they don't exist
DO $$
BEGIN
    -- Create sequences only if they don't exist
    IF NOT EXISTS (SELECT 1 FROM pg_sequences WHERE schemaname = 'public' AND sequencename = 'agent_1742397281528_id_seq') THEN
        CREATE SEQUENCE public.agent_1742397281528_id_seq;
    END IF;
END $$;

-- Handle activity type enum
DO $$
BEGIN
    -- Only create the new enum type if it doesn't exist
    IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'activity_type_enum') THEN
        CREATE TYPE activity_type_enum AS ENUM (
            'account_created',
            'account_deleted',
            'account_updated',
            'agent_created',
            'agent_deleted',
            'agent_updated',
            'document_added',
            'document_deleted',
            'document_processed',
            'document_processing_failed',
            'document_processing_started',
            'document_updated',
            'email_sent',
            'error_occurred',
            'invitation_accepted',
            'invitation_created',
            'invitation_expired',
            'login_failed',
            'login_successful',
            'logout',
            'password_changed',
            'password_reset_requested',
            'profile_updated',
            'role_assigned',
            'role_removed',
            'system_error',
            'system_update',
            'user_invited',
            'verification_failed',
            'verification_successful'
        );
    END IF;
END $$;

-- Create tables if they don't exist
CREATE TABLE IF NOT EXISTS public.agent_1742397281528 (
    id bigint NOT NULL DEFAULT nextval('agent_1742397281528_id_seq'::regclass),
    content text,
    metadata jsonb,
    embedding vector(1536)
);

-- Drop old constraints and policies if they exist
DROP POLICY IF EXISTS "Users can view their own AI agent data" ON public.ai_agents;
DROP POLICY IF EXISTS "Service role can access all activities" ON public.client_activities;
DROP POLICY IF EXISTS "Users can view their own activities" ON public.client_activities;
DROP POLICY IF EXISTS "Allow service role full access" ON public.client_recovery_tokens;
DROP POLICY IF EXISTS "Admins can view temp passwords" ON public.client_temp_passwords;
DROP POLICY IF EXISTS "Service role can manage temp passwords" ON public.client_temp_passwords;
DROP POLICY IF EXISTS "Service role can access all client data" ON public.clients;
DROP POLICY IF EXISTS "Users can view their own data" ON public.clients;

-- Drop old constraints if they exist
ALTER TABLE public.ai_agents DROP CONSTRAINT IF EXISTS ai_agents_client_id_fkey;
ALTER TABLE public.client_activities DROP CONSTRAINT IF EXISTS client_activities_client_id_fkey;
ALTER TABLE public.client_recovery_tokens DROP CONSTRAINT IF EXISTS client_recovery_tokens_client_id_fkey;
ALTER TABLE public.client_recovery_tokens DROP CONSTRAINT IF EXISTS token_not_empty;
ALTER TABLE public.client_temp_passwords DROP CONSTRAINT IF EXISTS fk_agent;
ALTER TABLE public.clients DROP CONSTRAINT IF EXISTS clients_email_key;
ALTER TABLE public.document_processing_jobs DROP CONSTRAINT IF EXISTS document_processing_jobs_client_id_fkey;
ALTER TABLE public.document_processing_status DROP CONSTRAINT IF EXISTS document_processing_status_job_id_fkey;

-- Drop old functions if they exist
DROP FUNCTION IF EXISTS public.update_processing_status(p_job_id uuid, p_status text, p_progress integer, p_stage text, p_message text, p_metadata jsonb);

-- Drop old indexes if they exist
DROP INDEX IF EXISTS public.client_recovery_tokens_token_idx;
DROP INDEX IF EXISTS public.client_temp_passwords_agent_id_idx;
DROP INDEX IF EXISTS public.client_temp_passwords_email_idx;
DROP INDEX IF EXISTS public.clients_email_key;
DROP INDEX IF EXISTS public.clients_pkey;
DROP INDEX IF EXISTS public.document_processing_pkey;
DROP INDEX IF EXISTS public.document_processing_status_pkey;
DROP INDEX IF EXISTS public.idx_ai_agents_openai_assistant_id;
DROP INDEX IF EXISTS public.idx_client_activities_client_id;
DROP INDEX IF EXISTS public.idx_client_activities_type;
DROP INDEX IF EXISTS public.idx_clients_email;
DROP INDEX IF EXISTS public.idx_clients_status;
DROP INDEX IF EXISTS public.idx_doc_processing_jobs_client_id;
DROP INDEX IF EXISTS public.idx_doc_processing_jobs_status;
DROP INDEX IF EXISTS public.idx_doc_processing_status_job_id;
DROP INDEX IF EXISTS public.idx_document_processing_client_id;
DROP INDEX IF EXISTS public.idx_document_processing_document_url;
DROP INDEX IF EXISTS public.idx_document_processing_status;
DROP INDEX IF EXISTS public.user_roles_role_idx;
DROP INDEX IF EXISTS public.user_roles_user_id_idx;


create table "public"."testclient3" (
    "id" bigint not null default nextval('testclient3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient4" (
    "id" bigint not null default nextval('testclient4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient5" (
    "id" bigint not null default nextval('testclient5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testd" (
    "id" bigint not null default nextval('testd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."teste" (
    "id" bigint not null default nextval('teste_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest" (
    "id" bigint not null default nextval('testest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest1" (
    "id" bigint not null default nextval('testest1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest12" (
    "id" bigint not null default nextval('testest12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testf" (
    "id" bigint not null default nextval('testf_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testg" (
    "id" bigint not null default nextval('testg_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testglas" (
    "id" bigint not null default nextval('testglas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testh" (
    "id" bigint not null default nextval('testh_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testheagent" (
    "id" bigint not null default nextval('testheagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testit" (
    "id" bigint not null default nextval('testit_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testj" (
    "id" bigint not null default nextval('testj_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testk" (
    "id" bigint not null default nextval('testk_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testl" (
    "id" bigint not null default nextval('testl_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testm" (
    "id" bigint not null default nextval('testm_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testme1234" (
    "id" bigint not null default nextval('testme1234_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testn" (
    "id" bigint not null default nextval('testn_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testo" (
    "id" bigint not null default nextval('testo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testp" (
    "id" bigint not null default nextval('testp_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testq" (
    "id" bigint not null default nextval('testq_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testr" (
    "id" bigint not null default nextval('testr_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tests" (
    "id" bigint not null default nextval('tests_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testt" (
    "id" bigint not null default nextval('testt_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testu" (
    "id" bigint not null default nextval('testu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testv" (
    "id" bigint not null default nextval('testv_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testw" (
    "id" bigint not null default nextval('testw_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."the_agent" (
    "id" bigint not null default nextval('the_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."thetest" (
    "id" bigint not null default nextval('thetest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."upwork" (
    "id" bigint not null default nextval('upwork_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vahalas" (
    "id" bigint not null default nextval('vahalas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value1" (
    "id" bigint not null default nextval('value1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create extension if not exists "pg_net" with schema "public" version '0.14.0';

create sequence if not exists "public"."agent_1742397281528_id_seq";

create extension if not exists "pg_net" with schema "public" version '0.14.0';

-- Instead of dropping the old enum type, we'll keep it and create a new one if needed
DO $$
BEGIN
  -- Only create the new enum type if it doesn't exist
  IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'activity_type_enum') THEN
    CREATE TYPE activity_type_enum AS ENUM (
      'account_created',
      'account_deleted',
      'account_updated',
      'agent_created',
      'agent_deleted',
      'agent_updated',
      'document_added',
      'document_deleted',
      'document_processed',
      'document_processing_failed',
      'document_processing_started',
      'document_updated',
      'email_sent',
      'error_occurred',
      'invitation_accepted',
      'invitation_created',
      'invitation_expired',
      'login_failed',
      'login_successful',
      'logout',
      'password_changed',
      'password_reset_requested',
      'profile_updated',
      'role_assigned',
      'role_removed',
      'system_error',
      'system_update',
      'user_invited',
      'verification_failed',
      'verification_successful'
    );
  END IF;
END $$;

create sequence if not exists "public"."agent_1742397281528_id_seq";

create sequence if not exists "public"."agent_1742425072029_id_seq";

create sequence if not exists "public"."agent_1742426304880_id_seq";

create sequence if not exists "public"."ai_agent_id_seq";

create sequence if not exists "public"."airtable_id_seq";

create sequence if not exists "public"."asd_id_seq";

create sequence if not exists "public"."ask_parent_handbook_id_seq";

create sequence if not exists "public"."buffalo_school_board_id_seq";

create sequence if not exists "public"."byclicks_id_seq";

create sequence if not exists "public"."cc_id_seq";

create sequence if not exists "public"."client_3_id_seq";

create sequence if not exists "public"."coca_cola_id_seq";

create sequence if not exists "public"."coins_id_seq";

create sequence if not exists "public"."deals_id_seq";

create sequence if not exists "public"."digicel_id_seq";

create sequence if not exists "public"."document_links_id_seq";

create sequence if not exists "public"."frenniy_id_seq";

create sequence if not exists "public"."g_g_id_seq";

create sequence if not exists "public"."gaiivo_id_seq";

create sequence if not exists "public"."glouglu_id_seq";

create sequence if not exists "public"."google_drive_links_id_seq";

create sequence if not exists "public"."great_deal_id_seq";

create sequence if not exists "public"."imanye_3_id_seq";

create sequence if not exists "public"."llama11_id_seq";

create sequence if not exists "public"."llama1_id_seq";

create sequence if not exists "public"."llama3_id_seq";

create sequence if not exists "public"."llama4_id_seq";

create sequence if not exists "public"."llama5_id_seq";

create sequence if not exists "public"."llama7_id_seq";

create sequence if not exists "public"."llama9_id_seq";

create sequence if not exists "public"."mailer_id_seq";

create sequence if not exists "public"."manyel_2_id_seq";

create sequence if not exists "public"."metricool_id_seq";

create sequence if not exists "public"."n8n123_id_seq";

create sequence if not exists "public"."n8n_chat_histories_id_seq";

create sequence if not exists "public"."n8n_id_seq";

create sequence if not exists "public"."neem_25_id_seq";

create sequence if not exists "public"."news_2_id_seq";

create sequence if not exists "public"."news_3_id_seq";

create sequence if not exists "public"."news_4_id_seq";

create sequence if not exists "public"."news_5_id_seq";

create sequence if not exists "public"."news_id_seq";

create sequence if not exists "public"."news_one_id_seq";

create sequence if not exists "public"."nnmo1_id_seq";

create sequence if not exists "public"."notion_id_seq";

create sequence if not exists "public"."pet__pets_id_seq";

create sequence if not exists "public"."pierreme123_id_seq";

create sequence if not exists "public"."pierreme12_id_seq";

create sequence if not exists "public"."primelee1_id_seq";

create sequence if not exists "public"."proque_id_seq";

create sequence if not exists "public"."proton_id_seq";

create sequence if not exists "public"."sadhana_forest_id_seq";

create sequence if not exists "public"."saldo_id_seq";

create sequence if not exists "public"."story_id_seq";

create sequence if not exists "public"."teplate_id_seq";

create sequence if not exists "public"."tesi_id_seq";

create sequence if not exists "public"."test12345_id_seq";

create sequence if not exists "public"."test1t_id_seq";

create sequence if not exists "public"."test5_id_seq";

create sequence if not exists "public"."test6_gmail_com_id_seq";

create sequence if not exists "public"."test7_id_seq";

create sequence if not exists "public"."test_98_id_seq";

create sequence if not exists "public"."test_agent_1741894950_id_seq";

create sequence if not exists "public"."test_agent_1741895003_id_seq";

create sequence if not exists "public"."test_xyt7ti_id_seq";

create sequence if not exists "public"."testa_id_seq";

create sequence if not exists "public"."testab_id_seq";

create sequence if not exists "public"."testac_id_seq";

create sequence if not exists "public"."testad_id_seq";

create sequence if not exists "public"."testagen6_id_seq";

create sequence if not exists "public"."testagent1_id_seq";

create sequence if not exists "public"."testagent4_id_seq";

create sequence if not exists "public"."testagent5_id_seq";

create sequence if not exists "public"."testagent7_id_seq";

create sequence if not exists "public"."testagent8_id_seq";

create sequence if not exists "public"."testagent_id_seq";

create sequence if not exists "public"."testb_id_seq";

create sequence if not exists "public"."testc_id_seq";

create extension if not exists "pg_net" with schema "public" version '0.14.0';

create sequence "public"."agent_1742397281528_id_seq";

create sequence "public"."agent_1742425072029_id_seq";

create sequence "public"."agent_1742426304880_id_seq";

create sequence "public"."ai_agent_id_seq";

create sequence "public"."airtable_id_seq";

create sequence "public"."asd_id_seq";

create sequence "public"."ask_parent_handbook_id_seq";

create sequence "public"."buffalo_school_board_id_seq";

create sequence "public"."byclicks_id_seq";

create sequence "public"."cc_id_seq";

create sequence "public"."client_3_id_seq";

create sequence "public"."coca_cola_id_seq";

create sequence "public"."coins_id_seq";

create sequence "public"."deals_id_seq";

create sequence "public"."digicel_id_seq";

create sequence "public"."document_links_id_seq";

create sequence "public"."frenniy_id_seq";

create sequence "public"."g_g_id_seq";

create sequence "public"."gaiivo_id_seq";

create sequence "public"."glouglu_id_seq";

create sequence "public"."google_drive_links_id_seq";

create sequence "public"."great_deal_id_seq";

create sequence "public"."imanye_3_id_seq";

create sequence "public"."llama11_id_seq";

create sequence "public"."llama1_id_seq";

create sequence "public"."llama3_id_seq";

create sequence "public"."llama4_id_seq";

create sequence "public"."llama5_id_seq";

create sequence "public"."llama7_id_seq";

create sequence "public"."llama9_id_seq";

create sequence "public"."mailer_id_seq";

create sequence "public"."manyel_2_id_seq";

create sequence "public"."metricool_id_seq";

create sequence "public"."n8n123_id_seq";

create sequence "public"."n8n_chat_histories_id_seq";

create sequence "public"."n8n_id_seq";

create sequence "public"."neem_25_id_seq";

create sequence "public"."news_2_id_seq";

create sequence "public"."news_3_id_seq";

create sequence "public"."news_4_id_seq";

create sequence "public"."news_5_id_seq";

create sequence "public"."news_id_seq";

create sequence "public"."news_one_id_seq";

create sequence "public"."nnmo1_id_seq";

create sequence "public"."notion_id_seq";

create sequence "public"."pet__pets_id_seq";

create sequence "public"."pierreme123_id_seq";

create sequence "public"."pierreme12_id_seq";

create sequence "public"."primelee1_id_seq";

create sequence "public"."proque_id_seq";

create sequence "public"."proton_id_seq";

create sequence "public"."sadhana_forest_id_seq";

create sequence "public"."saldo_id_seq";

create sequence "public"."story_id_seq";

create sequence "public"."teplate_id_seq";

create sequence "public"."tesi_id_seq";

create sequence "public"."test12345_id_seq";

create sequence "public"."test1t_id_seq";

create sequence "public"."test5_id_seq";

create sequence "public"."test6_gmail_com_id_seq";

create sequence "public"."test7_id_seq";

create sequence "public"."test_98_id_seq";

create sequence "public"."test_agent_1741894950_id_seq";

create sequence "public"."test_agent_1741895003_id_seq";

create sequence "public"."test_xyt7ti_id_seq";

create sequence "public"."testa_id_seq";

create sequence "public"."testab_id_seq";

create sequence "public"."testac_id_seq";

create sequence "public"."testad_id_seq";

create sequence "public"."testagen6_id_seq";

create sequence "public"."testagent1_id_seq";

create sequence "public"."testagent4_id_seq";

create sequence "public"."testagent5_id_seq";

create sequence "public"."testagent7_id_seq";

create sequence "public"."testagent8_id_seq";

create sequence "public"."testagent_id_seq";

create sequence "public"."testb_id_seq";

create sequence "public"."testc_id_seq";

create sequence "public"."testclient11_id_seq";

create sequence "public"."testclient12_id_seq";

create sequence "public"."testclient3_id_seq";

create sequence "public"."testclient4_id_seq";

create sequence "public"."testclient5_id_seq";

create sequence "public"."testd_id_seq";

create sequence "public"."teste_id_seq";

create sequence "public"."testest12_id_seq";

create sequence "public"."testest1_id_seq";

create sequence "public"."testest_id_seq";


create table "public"."llama3" (
    "id" bigint not null default nextval('llama3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama4" (
    "id" bigint not null default nextval('llama4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama5" (
    "id" bigint not null default nextval('llama5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama7" (
    "id" bigint not null default nextval('llama7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama9" (
    "id" bigint not null default nextval('llama9_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."mailer" (
    "id" bigint not null default nextval('mailer_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."mailer" enable row level security;

create table "public"."manyel_2" (
    "id" bigint not null default nextval('manyel_2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."manyel_2" enable row level security;

create table "public"."metricool" (
    "id" bigint not null default nextval('metricool_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."metricool" enable row level security;

create table "public"."n8n" (
    "id" bigint not null default nextval('n8n_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."n8n123" (
    "id" bigint not null default nextval('n8n123_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."n8n_chat_histories" (
    "id" integer not null default nextval('n8n_chat_histories_id_seq'::regclass),
    "session_id" character varying(255) not null,
    "message" jsonb not null
);


create table "public"."neem_25" (
    "id" bigint not null default nextval('neem_25_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news" (
    "id" bigint not null default nextval('news_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_2" (
    "id" bigint not null default nextval('news_2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_3" (
    "id" bigint not null default nextval('news_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_4" (
    "id" bigint not null default nextval('news_4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_5" (
    "id" bigint not null default nextval('news_5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_one" (
    "id" bigint not null default nextval('news_one_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."nnmo1" (
    "id" bigint not null default nextval('nnmo1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."notion" (
    "id" bigint not null default nextval('notion_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."notion" enable row level security;

create table "public"."pet__pets" (
    "id" bigint not null default nextval('pet__pets_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."pierreme12" (
    "id" bigint not null default nextval('pierreme12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."pierreme123" (
    "id" bigint not null default nextval('pierreme123_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."primelee1" (
    "id" bigint not null default nextval('primelee1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."profiles" (
    "id" uuid not null,
    "email" text,
    "full_name" text,
    "avatar_url" text,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now()
);


alter table "public"."profiles" enable row level security;

create table "public"."proque" (
    "id" bigint not null default nextval('proque_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."proton" (
    "id" bigint not null default nextval('proton_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."proton" enable row level security;

create table "public"."sadhana_forest" (
    "id" bigint not null default nextval('sadhana_forest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."saldo" (
    "id" bigint not null default nextval('saldo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."saldo" enable row level security;

create table "public"."story" (
    "id" bigint not null default nextval('story_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."story" enable row level security;

create table "public"."teplate" (
    "id" bigint not null default nextval('teplate_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tesi" (
    "id" bigint not null default nextval('tesi_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test12345" (
    "id" bigint not null default nextval('test12345_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test1t" (
    "id" bigint not null default nextval('test1t_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test5" (
    "id" bigint not null default nextval('test5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test6_gmail_com" (
    "id" bigint not null default nextval('test6_gmail_com_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test7" (
    "id" bigint not null default nextval('test7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_98" (
    "id" bigint not null default nextval('test_98_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_agent_1741894950" (
    "id" bigint not null default nextval('test_agent_1741894950_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_agent_1741895003" (
    "id" bigint not null default nextval('test_agent_1741895003_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_xyt7ti" (
    "id" bigint not null default nextval('test_xyt7ti_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testa" (
    "id" bigint not null default nextval('testa_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testab" (
    "id" bigint not null default nextval('testab_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testac" (
    "id" bigint not null default nextval('testac_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testad" (
    "id" bigint not null default nextval('testad_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagen6" (
    "id" bigint not null default nextval('testagen6_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent" (
    "id" bigint not null default nextval('testagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent1" (
    "id" bigint not null default nextval('testagent1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent4" (
    "id" bigint not null default nextval('testagent4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent5" (
    "id" bigint not null default nextval('testagent5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent7" (
    "id" bigint not null default nextval('testagent7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent8" (
    "id" bigint not null default nextval('testagent8_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testb" (
    "id" bigint not null default nextval('testb_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testc" (
    "id" bigint not null default nextval('testc_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient11" (
    "id" bigint not null default nextval('testclient11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient12" (
    "id" bigint not null default nextval('testclient12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient3" (
    "id" bigint not null default nextval('testclient3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient4" (
    "id" bigint not null default nextval('testclient4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient5" (
    "id" bigint not null default nextval('testclient5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testd" (
    "id" bigint not null default nextval('testd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."teste" (
    "id" bigint not null default nextval('teste_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest" (
    "id" bigint not null default nextval('testest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest1" (
    "id" bigint not null default nextval('testest1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest12" (
    "id" bigint not null default nextval('testest12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testf" (
    "id" bigint not null default nextval('testf_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testg" (
    "id" bigint not null default nextval('testg_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testglas" (
    "id" bigint not null default nextval('testglas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testh" (
    "id" bigint not null default nextval('testh_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testheagent" (
    "id" bigint not null default nextval('testheagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testit" (
    "id" bigint not null default nextval('testit_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testj" (
    "id" bigint not null default nextval('testj_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testk" (
    "id" bigint not null default nextval('testk_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testl" (
    "id" bigint not null default nextval('testl_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testm" (
    "id" bigint not null default nextval('testm_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testme1234" (
    "id" bigint not null default nextval('testme1234_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testn" (
    "id" bigint not null default nextval('testn_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testo" (
    "id" bigint not null default nextval('testo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testp" (
    "id" bigint not null default nextval('testp_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testq" (
    "id" bigint not null default nextval('testq_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testr" (
    "id" bigint not null default nextval('testr_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tests" (
    "id" bigint not null default nextval('tests_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testt" (
    "id" bigint not null default nextval('testt_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testu" (
    "id" bigint not null default nextval('testu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testv" (
    "id" bigint not null default nextval('testv_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testw" (
    "id" bigint not null default nextval('testw_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."the_agent" (
    "id" bigint not null default nextval('the_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."thetest" (
    "id" bigint not null default nextval('thetest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."upwork" (
    "id" bigint not null default nextval('upwork_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vahalas" (
    "id" bigint not null default nextval('vahalas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value1" (
    "id" bigint not null default nextval('value1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create extension if not exists "pg_net" with schema "public" version '0.14.0';

create sequence "public"."agent_1742397281528_id_seq";

create extension if not exists "pg_net" with schema "public" version '0.14.0';

-- Instead of dropping the old enum type, we'll keep it and create a new one if needed
DO $$
BEGIN
  -- Only create the new enum type if it doesn't exist
  IF NOT EXISTS (SELECT 1 FROM pg_type WHERE typname = 'activity_type_enum') THEN
    CREATE TYPE activity_type_enum AS ENUM (
      'account_created',
      'account_deleted',
      'account_updated',
      'agent_created',
      'agent_deleted',
      'agent_updated',
      'document_added',
      'document_deleted',
      'document_processed',
      'document_processing_failed',
      'document_processing_started',
      'document_updated',
      'email_sent',
      'error_occurred',
      'invitation_accepted',
      'invitation_created',
      'invitation_expired',
      'login_failed',
      'login_successful',
      'logout',
      'password_changed',
      'password_reset_requested',
      'profile_updated',
      'role_assigned',
      'role_removed',
      'system_error',
      'system_update',
      'user_invited',
      'verification_failed',
      'verification_successful'
    );
  END IF;
END $$;

create sequence "public"."agent_1742397281528_id_seq";

create sequence "public"."agent_1742425072029_id_seq";

create sequence "public"."agent_1742426304880_id_seq";

create sequence "public"."ai_agent_id_seq";

create sequence "public"."airtable_id_seq";

create sequence "public"."asd_id_seq";

create sequence "public"."ask_parent_handbook_id_seq";

create sequence "public"."buffalo_school_board_id_seq";

create sequence "public"."byclicks_id_seq";

create sequence "public"."cc_id_seq";

create sequence "public"."client_3_id_seq";

create sequence "public"."coca_cola_id_seq";

create sequence "public"."coins_id_seq";

create sequence "public"."deals_id_seq";

create sequence "public"."digicel_id_seq";

create sequence "public"."document_links_id_seq";

create sequence "public"."frenniy_id_seq";

create sequence "public"."g_g_id_seq";

create sequence "public"."gaiivo_id_seq";

create sequence "public"."glouglu_id_seq";

create sequence "public"."google_drive_links_id_seq";

create sequence "public"."great_deal_id_seq";

create sequence "public"."imanye_3_id_seq";

create sequence "public"."llama11_id_seq";

create sequence "public"."llama1_id_seq";

create sequence "public"."llama3_id_seq";

create sequence "public"."llama4_id_seq";

create sequence "public"."llama5_id_seq";

create sequence "public"."llama7_id_seq";

create sequence "public"."llama9_id_seq";

create sequence "public"."mailer_id_seq";

create sequence "public"."manyel_2_id_seq";

create sequence "public"."metricool_id_seq";

create sequence "public"."n8n123_id_seq";

create sequence "public"."n8n_chat_histories_id_seq";

create sequence "public"."n8n_id_seq";

create sequence "public"."neem_25_id_seq";

create sequence "public"."news_2_id_seq";

create sequence "public"."news_3_id_seq";

create sequence "public"."news_4_id_seq";

create sequence "public"."news_5_id_seq";

create sequence "public"."news_id_seq";

create sequence "public"."news_one_id_seq";

create sequence "public"."nnmo1_id_seq";

create sequence "public"."notion_id_seq";

create sequence "public"."pet__pets_id_seq";

create sequence "public"."pierreme123_id_seq";

create sequence "public"."pierreme12_id_seq";

create sequence "public"."primelee1_id_seq";

create sequence "public"."proque_id_seq";

create sequence "public"."proton_id_seq";

create sequence "public"."sadhana_forest_id_seq";

create sequence "public"."saldo_id_seq";

create sequence "public"."story_id_seq";

create sequence "public"."teplate_id_seq";

create sequence "public"."tesi_id_seq";

create sequence "public"."test12345_id_seq";

create sequence "public"."test1t_id_seq";

create sequence "public"."test5_id_seq";

create sequence "public"."test6_gmail_com_id_seq";

create sequence "public"."test7_id_seq";

create sequence "public"."test_98_id_seq";

create sequence "public"."test_agent_1741894950_id_seq";

create sequence "public"."test_agent_1741895003_id_seq";

create sequence "public"."test_xyt7ti_id_seq";

create sequence "public"."testa_id_seq";

create sequence "public"."testab_id_seq";

create sequence "public"."testac_id_seq";

create sequence "public"."testad_id_seq";

create sequence "public"."testagen6_id_seq";

create sequence "public"."testagent1_id_seq";

create sequence "public"."testagent4_id_seq";

create sequence "public"."testagent5_id_seq";

create sequence "public"."testagent7_id_seq";

create sequence "public"."testagent8_id_seq";

create sequence "public"."testagent_id_seq";

create sequence "public"."testb_id_seq";

create sequence "public"."testc_id_seq";

create sequence "public"."testclient11_id_seq";

create sequence "public"."testclient12_id_seq";

create sequence "public"."testclient3_id_seq";

create sequence "public"."testclient4_id_seq";

create sequence "public"."testclient5_id_seq";

create sequence "public"."testd_id_seq";

create sequence "public"."teste_id_seq";

create sequence "public"."testest12_id_seq";

create sequence "public"."testest1_id_seq";

create sequence "public"."testest_id_seq";

create sequence "public"."testf_id_seq";

create sequence "public"."testg_id_seq";

create sequence "public"."testglas_id_seq";

create sequence "public"."testh_id_seq";

create sequence "public"."testheagent_id_seq";

create sequence "public"."testit_id_seq";

create sequence "public"."testj_id_seq";

create sequence "public"."testk_id_seq";

create sequence "public"."testl_id_seq";

create sequence "public"."testm_id_seq";

create sequence "public"."testme1234_id_seq";

create sequence "public"."testn_id_seq";

create sequence "public"."testo_id_seq";

create sequence "public"."testp_id_seq";

create sequence "public"."testq_id_seq";

create sequence "public"."testr_id_seq";

create sequence "public"."tests_id_seq";

create sequence "public"."testt_id_seq";

create sequence "public"."testu_id_seq";

create sequence "public"."testv_id_seq";

create sequence "public"."testw_id_seq";

create sequence "public"."the_agent_id_seq";

create sequence "public"."thetest_id_seq";

create sequence "public"."upwork_id_seq";

create sequence "public"."vahalas_id_seq";

create sequence "public"."value10_id_seq";

create sequence "public"."value11_id_seq";

create sequence "public"."value1_id_seq";

create sequence "public"."value2_id_seq";

create sequence "public"."value6_id_seq";

create sequence "public"."value7_id_seq";

create sequence "public"."value8_id_seq";

create sequence "public"."value9_id_seq";

create sequence "public"."vidgu_id_seq";

create sequence "public"."vladd2a_id_seq";

create sequence "public"."vlooh_id_seq";

create sequence "public"."voigai_id_seq";

create sequence "public"."website_urls_id_seq";

create sequence "public"."wechate_id_seq";

create sequence "public"."your_agent_id_seq";

drop trigger if exists "update_document_processing_updated_at" on "public"."document_processing";

drop policy "Users can view their own AI agent data" on "public"."ai_agents";

drop policy "Service role can access all activities" on "public"."client_activities";

drop policy "Users can view their own activities" on "public"."client_activities";

drop policy "Allow service role full access" on "public"."client_recovery_tokens";

drop policy "Admins can view temp passwords" on "public"."client_temp_passwords";

drop policy "Service role can manage temp passwords" on "public"."client_temp_passwords";

drop policy "Service role can access all client data" on "public"."clients";

drop policy "Users can view their own data" on "public"."clients";

drop policy "Enable insert for authenticated users" on "public"."document_processing";

drop policy "Enable read access for authenticated users" on "public"."document_processing";

drop policy "Enable update for authenticated users" on "public"."document_processing";

drop policy "Users can create processing jobs" on "public"."document_processing_jobs";

drop policy "Users can view their own processing jobs" on "public"."document_processing_jobs";

drop policy "Users can view their own processing status" on "public"."document_processing_status";

drop policy "Admins can view user roles" on "public"."user_roles";

drop policy "Service role can manage user roles" on "public"."user_roles";

revoke delete on table "public"."clients" from "anon";

revoke insert on table "public"."clients" from "anon";

revoke references on table "public"."clients" from "anon";

revoke select on table "public"."clients" from "anon";

revoke trigger on table "public"."clients" from "anon";

revoke truncate on table "public"."clients" from "anon";

revoke update on table "public"."clients" from "anon";

revoke delete on table "public"."clients" from "authenticated";

revoke insert on table "public"."clients" from "authenticated";

revoke references on table "public"."clients" from "authenticated";

revoke select on table "public"."clients" from "authenticated";

revoke trigger on table "public"."clients" from "authenticated";

revoke truncate on table "public"."clients" from "authenticated";

revoke update on table "public"."clients" from "authenticated";

revoke delete on table "public"."clients" from "service_role";

revoke insert on table "public"."clients" from "service_role";

revoke references on table "public"."clients" from "service_role";

revoke select on table "public"."clients" from "service_role";

revoke trigger on table "public"."clients" from "service_role";

revoke truncate on table "public"."clients" from "service_role";

revoke update on table "public"."clients" from "service_role";

revoke delete on table "public"."document_processing" from "anon";

revoke insert on table "public"."document_processing" from "anon";

revoke references on table "public"."document_processing" from "anon";

revoke select on table "public"."document_processing" from "anon";

revoke trigger on table "public"."document_processing" from "anon";

revoke truncate on table "public"."document_processing" from "anon";

revoke update on table "public"."document_processing" from "anon";

revoke delete on table "public"."document_processing" from "authenticated";

revoke insert on table "public"."document_processing" from "authenticated";

revoke references on table "public"."document_processing" from "authenticated";

revoke select on table "public"."document_processing" from "authenticated";

revoke trigger on table "public"."document_processing" from "authenticated";

revoke truncate on table "public"."document_processing" from "authenticated";

revoke update on table "public"."document_processing" from "authenticated";

revoke delete on table "public"."document_processing" from "service_role";

revoke insert on table "public"."document_processing" from "service_role";

revoke references on table "public"."document_processing" from "service_role";

revoke select on table "public"."document_processing" from "service_role";

revoke trigger on table "public"."document_processing" from "service_role";

revoke truncate on table "public"."document_processing" from "service_role";

revoke update on table "public"."document_processing" from "service_role";

revoke delete on table "public"."document_processing_status" from "anon";

revoke insert on table "public"."document_processing_status" from "anon";

revoke references on table "public"."document_processing_status" from "anon";

revoke select on table "public"."document_processing_status" from "anon";

revoke trigger on table "public"."document_processing_status" from "anon";

revoke truncate on table "public"."document_processing_status" from "anon";

revoke update on table "public"."document_processing_status" from "anon";

revoke delete on table "public"."document_processing_status" from "authenticated";

revoke insert on table "public"."document_processing_status" from "authenticated";

revoke references on table "public"."document_processing_status" from "authenticated";

revoke select on table "public"."document_processing_status" from "authenticated";

revoke trigger on table "public"."document_processing_status" from "authenticated";

revoke truncate on table "public"."document_processing_status" from "authenticated";

revoke update on table "public"."document_processing_status" from "authenticated";

revoke delete on table "public"."document_processing_status" from "service_role";

revoke insert on table "public"."document_processing_status" from "service_role";

revoke references on table "public"."document_processing_status" from "service_role";

revoke select on table "public"."document_processing_status" from "service_role";

revoke trigger on table "public"."document_processing_status" from "service_role";

revoke truncate on table "public"."document_processing_status" from "service_role";

revoke update on table "public"."document_processing_status" from "service_role";

alter table "public"."ai_agents" drop constraint "ai_agents_client_id_fkey";

alter table "public"."client_activities" drop constraint "client_activities_client_id_fkey";

alter table "public"."client_recovery_tokens" drop constraint "client_recovery_tokens_client_id_fkey";

alter table "public"."client_recovery_tokens" drop constraint "token_not_empty";

alter table "public"."client_temp_passwords" drop constraint "fk_agent";

alter table "public"."clients" drop constraint "clients_email_key";

alter table "public"."document_processing_jobs" drop constraint "document_processing_jobs_client_id_fkey";

alter table "public"."document_processing_status" drop constraint "document_processing_status_job_id_fkey";

drop function if exists "public"."update_processing_status"(p_job_id uuid, p_status text, p_progress integer, p_stage text, p_message text, p_metadata jsonb);

alter table "public"."clients" drop constraint "clients_pkey";

alter table "public"."document_processing" drop constraint "document_processing_pkey";

alter table "public"."document_processing_status" drop constraint "document_processing_status_pkey";

drop index if exists "public"."client_recovery_tokens_token_idx";

drop index if exists "public"."client_temp_passwords_agent_id_idx";

drop index if exists "public"."client_temp_passwords_email_idx";

drop index if exists "public"."clients_email_key";

drop index if exists "public"."clients_pkey";

drop index if exists "public"."document_processing_pkey";

drop index if exists "public"."document_processing_status_pkey";

drop index if exists "public"."idx_ai_agents_openai_assistant_id";

drop index if exists "public"."idx_client_activities_client_id";

drop index if exists "public"."idx_client_activities_type";

drop index if exists "public"."idx_clients_email";

drop index if exists "public"."idx_clients_status";

drop index if exists "public"."idx_doc_processing_jobs_client_id";

drop index if exists "public"."idx_doc_processing_jobs_status";

drop index if exists "public"."idx_doc_processing_status_job_id";

drop index if exists "public"."idx_document_processing_client_id";

drop index if exists "public"."idx_document_processing_document_url";

drop index if exists "public"."idx_document_processing_status";

drop index if exists "public"."user_roles_role_idx";

drop index if exists "public"."user_roles_user_id_idx";

drop table "public"."clients";

drop table "public"."document_processing";

drop table "public"."document_processing_status";

alter type "public"."activity_type_enum" rename to "activity_type_enum__old_version_to_be_dropped";

create table "public"."agent_1742397281528" (
    "id" bigint not null default nextval('agent_1742397281528_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."agent_1742425072029" (
    "id" bigint not null default nextval('agent_1742425072029_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."agent_1742426304880" (
    "id" bigint not null default nextval('agent_1742426304880_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ai_agent" (
    "id" bigint not null default nextval('ai_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ai_agents_backup" (
    "id" uuid,
    "client_id" uuid,
    "name" text,
    "settings" jsonb,
    "created_at" timestamp with time zone,
    "updated_at" timestamp with time zone,
    "content" text,
    "embedding" vector(1536),
    "url" text,
    "interaction_type" text,
    "query_text" text,
    "response_time_ms" integer,
    "is_error" boolean,
    "error_type" text,
    "error_message" text,
    "error_status" text,
    "topic" text,
    "sentiment" text,
    "agent_description" text
);


create table "public"."ai_documents" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "document_id" text not null,
    "document_url" text not null,
    "document_type" text not null,
    "status" text not null default 'pending'::text,
    "content" text,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now(),
    "agent_name" text not null,
    "error" text,
    "error_message" text,
    "processing_method" text,
    "metadata" jsonb default '{}'::jsonb
);


create table "public"."ai_interactions" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "agent_name" text not null,
    "query_text" text not null,
    "response_text" text not null,
    "created_at" timestamp with time zone default now(),
    "response_time_ms" integer,
    "metadata" jsonb default '{}'::jsonb
);


create table "public"."airtable" (
    "id" bigint not null default nextval('airtable_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."airtable" enable row level security;

create table "public"."asd" (
    "id" bigint not null default nextval('asd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ask_parent_handbook" (
    "id" bigint not null default nextval('ask_parent_handbook_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."buffalo_school_board" (
    "id" bigint not null default nextval('buffalo_school_board_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."buffalo_school_board" enable row level security;

create table "public"."byclicks" (
    "id" bigint not null default nextval('byclicks_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."cc" (
    "id" bigint not null default nextval('cc_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."cc" enable row level security;

create table "public"."client_3" (
    "id" bigint not null default nextval('client_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."client_invitations" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "token" uuid not null,
    "email" text not null,
    "expires_at" timestamp with time zone not null,
    "created_at" timestamp with time zone default now()
);


alter table "public"."client_invitations" enable row level security;

create table "public"."coca_cola" (
    "id" bigint not null default nextval('coca_cola_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."coins" (
    "id" bigint not null default nextval('coins_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."coins" enable row level security;

create table "public"."common_queries" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid,
    "query_text" text not null,
    "frequency" integer default 1,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now()
);


alter table "public"."common_queries" enable row level security;

create table "public"."deals" (
    "id" bigint not null default nextval('deals_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."digicel" (
    "id" bigint not null default nextval('digicel_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."document_links" (
    "id" integer not null default nextval('document_links_id_seq'::regclass),
    "client_id" uuid not null,
    "link" text not null,
    "document_type" text default 'google_drive'::text,
    "refresh_rate" integer not null default 30,
    "access_status" text default 'unknown'::text,
    "notified_at" timestamp with time zone,
    "created_at" timestamp with time zone default now()
);


create table "public"."email_logs" (
    "id" uuid not null default gen_random_uuid(),
    "email_to" text not null,
    "subject" text not null,
    "sent_at" timestamp with time zone default now(),
    "status" text not null,
    "error" text,
    "metadata" jsonb default '{}'::jsonb
);


alter table "public"."email_logs" enable row level security;

create table "public"."error_logs" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid,
    "error_type" text not null,
    "message" text not null,
    "status" text,
    "created_at" timestamp with time zone default now()
);


alter table "public"."error_logs" enable row level security;

create table "public"."frenniy" (
    "id" bigint not null default nextval('frenniy_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."g_g" (
    "id" bigint not null default nextval('g_g_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."gaiivo" (
    "id" bigint not null default nextval('gaiivo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."gaiivo" enable row level security;

create table "public"."glouglu" (
    "id" bigint not null default nextval('glouglu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."glouglu" enable row level security;

create table "public"."google_drive_links" (
    "id" integer not null default nextval('google_drive_links_id_seq'::regclass),
    "client_id" uuid,
    "link" text not null,
    "refresh_rate" integer not null default 30,
    "created_at" timestamp without time zone default CURRENT_TIMESTAMP,
    "access_status" text default 'unknown'::text,
    "notified_at" timestamp with time zone
);


create table "public"."great_deal" (
    "id" bigint not null default nextval('great_deal_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."imanye_3" (
    "id" bigint not null default nextval('imanye_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."imanye_3" enable row level security;

create table "public"."invitations" (
    "id" uuid not null default gen_random_uuid(),
    "email" text not null,
    "token" text not null,
    "role_type" text not null,
    "status" invitation_status default 'pending'::invitation_status,
    "created_by" uuid not null,
    "created_at" timestamp with time zone default now(),
    "expires_at" timestamp with time zone not null,
    "accepted_at" timestamp with time zone
);


alter table "public"."invitations" enable row level security;

create table "public"."llama1" (
    "id" bigint not null default nextval('llama1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama11" (
    "id" bigint not null default nextval('llama11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama3" (
    "id" bigint not null default nextval('llama3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama4" (
    "id" bigint not null default nextval('llama4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama5" (
    "id" bigint not null default nextval('llama5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama7" (
    "id" bigint not null default nextval('llama7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama9" (
    "id" bigint not null default nextval('llama9_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."mailer" (
    "id" bigint not null default nextval('mailer_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."mailer" enable row level security;

create table "public"."manyel_2" (
    "id" bigint not null default nextval('manyel_2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."manyel_2" enable row level security;

create table "public"."metricool" (
    "id" bigint not null default nextval('metricool_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."metricool" enable row level security;

create table "public"."n8n" (
    "id" bigint not null default nextval('n8n_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."n8n123" (
    "id" bigint not null default nextval('n8n123_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."n8n_chat_histories" (
    "id" integer not null default nextval('n8n_chat_histories_id_seq'::regclass),
    "session_id" character varying(255) not null,
    "message" jsonb not null
);


create table "public"."neem_25" (
    "id" bigint not null default nextval('neem_25_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news" (
    "id" bigint not null default nextval('news_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_2" (
    "id" bigint not null default nextval('news_2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_3" (
    "id" bigint not null default nextval('news_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_4" (
    "id" bigint not null default nextval('news_4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_5" (
    "id" bigint not null default nextval('news_5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_one" (
    "id" bigint not null default nextval('news_one_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."nnmo1" (
    "id" bigint not null default nextval('nnmo1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."notion" (
    "id" bigint not null default nextval('notion_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."notion" enable row level security;

create table "public"."pet__pets" (
    "id" bigint not null default nextval('pet__pets_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."pierreme12" (
    "id" bigint not null default nextval('pierreme12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."pierreme123" (
    "id" bigint not null default nextval('pierreme123_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."primelee1" (
    "id" bigint not null default nextval('primelee1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."profiles" (
    "id" uuid not null,
    "email" text,
    "full_name" text,
    "avatar_url" text,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now()
);


alter table "public"."profiles" enable row level security;

create table "public"."proque" (
    "id" bigint not null default nextval('proque_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."proton" (
    "id" bigint not null default nextval('proton_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."proton" enable row level security;

create table "public"."sadhana_forest" (
    "id" bigint not null default nextval('sadhana_forest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."saldo" (
    "id" bigint not null default nextval('saldo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."saldo" enable row level security;

create table "public"."story" (
    "id" bigint not null default nextval('story_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."story" enable row level security;

create table "public"."teplate" (
    "id" bigint not null default nextval('teplate_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tesi" (
    "id" bigint not null default nextval('tesi_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test12345" (
    "id" bigint not null default nextval('test12345_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test1t" (
    "id" bigint not null default nextval('test1t_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test5" (
    "id" bigint not null default nextval('test5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test6_gmail_com" (
    "id" bigint not null default nextval('test6_gmail_com_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test7" (
    "id" bigint not null default nextval('test7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_98" (
    "id" bigint not null default nextval('test_98_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_agent_1741894950" (
    "id" bigint not null default nextval('test_agent_1741894950_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_agent_1741895003" (
    "id" bigint not null default nextval('test_agent_1741895003_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_xyt7ti" (
    "id" bigint not null default nextval('test_xyt7ti_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testa" (
    "id" bigint not null default nextval('testa_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testab" (
    "id" bigint not null default nextval('testab_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testac" (
    "id" bigint not null default nextval('testac_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testad" (
    "id" bigint not null default nextval('testad_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagen6" (
    "id" bigint not null default nextval('testagen6_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent" (
    "id" bigint not null default nextval('testagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent1" (
    "id" bigint not null default nextval('testagent1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent4" (
    "id" bigint not null default nextval('testagent4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent5" (
    "id" bigint not null default nextval('testagent5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent7" (
    "id" bigint not null default nextval('testagent7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent8" (
    "id" bigint not null default nextval('testagent8_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testb" (
    "id" bigint not null default nextval('testb_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testc" (
    "id" bigint not null default nextval('testc_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient11" (
    "id" bigint not null default nextval('testclient11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient12" (
    "id" bigint not null default nextval('testclient12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient3" (
    "id" bigint not null default nextval('testclient3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient4" (
    "id" bigint not null default nextval('testclient4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient5" (
    "id" bigint not null default nextval('testclient5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testd" (
    "id" bigint not null default nextval('testd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."teste" (
    "id" bigint not null default nextval('teste_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest" (
    "id" bigint not null default nextval('testest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest1" (
    "id" bigint not null default nextval('testest1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest12" (
    "id" bigint not null default nextval('testest12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testf" (
    "id" bigint not null default nextval('testf_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testg" (
    "id" bigint not null default nextval('testg_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testglas" (
    "id" bigint not null default nextval('testglas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testh" (
    "id" bigint not null default nextval('testh_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testheagent" (
    "id" bigint not null default nextval('testheagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testit" (
    "id" bigint not null default nextval('testit_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testj" (
    "id" bigint not null default nextval('testj_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testk" (
    "id" bigint not null default nextval('testk_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testl" (
    "id" bigint not null default nextval('testl_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testm" (
    "id" bigint not null default nextval('testm_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testme1234" (
    "id" bigint not null default nextval('testme1234_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testn" (
    "id" bigint not null default nextval('testn_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testo" (
    "id" bigint not null default nextval('testo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testp" (
    "id" bigint not null default nextval('testp_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testq" (
    "id" bigint not null default nextval('testq_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testr" (
    "id" bigint not null default nextval('testr_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tests" (
    "id" bigint not null default nextval('tests_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testt" (
    "id" bigint not null default nextval('testt_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testu" (
    "id" bigint not null default nextval('testu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testv" (
    "id" bigint not null default nextval('testv_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testw" (
    "id" bigint not null default nextval('testw_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."the_agent" (
    "id" bigint not null default nextval('the_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."thetest" (
    "id" bigint not null default nextval('thetest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."upwork" (
    "id" bigint not null default nextval('upwork_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vahalas" (
    "id" bigint not null default nextval('vahalas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value1" (
    "id" bigint not null default nextval('value1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create extension if not exists "pg_net" with schema "public" version '0.14.0';

-- Handle activity type enum in a DO block
DO $$
DECLARE
  r RECORD;
BEGIN
  -- Drop dependencies on the old enum type if it exists
  IF EXISTS (SELECT 1 FROM pg_type WHERE typname = 'activity_type_enum__old_version_to_be_dropped') THEN
    -- First, find all columns using this type and change them to text temporarily
    FOR r IN (
      SELECT 
        format('ALTER TABLE %I.%I ALTER COLUMN %I TYPE text USING %I::text',
          nsp.nspname, cls.relname, att.attname, att.attname) as alter_cmd
      FROM pg_type t
      JOIN pg_enum e ON t.oid = e.enumtypid
      JOIN pg_attribute att ON att.atttypid = t.oid
      JOIN pg_class cls ON cls.oid = att.attrelid
      JOIN pg_namespace nsp ON nsp.oid = cls.relnamespace
      WHERE t.typname = 'activity_type_enum__old_version_to_be_dropped'
    ) LOOP
      EXECUTE r.alter_cmd;
    END LOOP;
    
    -- Now we can safely drop the type
    DROP TYPE IF EXISTS activity_type_enum__old_version_to_be_dropped;
  END IF;
END $$;

create sequence "public"."agent_1742397281528_id_seq";

create sequence "public"."agent_1742425072029_id_seq";

create sequence "public"."agent_1742426304880_id_seq";

create sequence "public"."ai_agent_id_seq";

create sequence "public"."airtable_id_seq";

create sequence "public"."asd_id_seq";

create sequence "public"."ask_parent_handbook_id_seq";

create sequence "public"."buffalo_school_board_id_seq";

create sequence "public"."byclicks_id_seq";

create sequence "public"."cc_id_seq";

create sequence "public"."client_3_id_seq";

create sequence "public"."coca_cola_id_seq";

create sequence "public"."coins_id_seq";

create sequence "public"."deals_id_seq";

create sequence "public"."digicel_id_seq";

create sequence "public"."document_links_id_seq";

create sequence "public"."frenniy_id_seq";

create sequence "public"."g_g_id_seq";

create sequence "public"."gaiivo_id_seq";

create sequence "public"."glouglu_id_seq";

create sequence "public"."google_drive_links_id_seq";

create sequence "public"."great_deal_id_seq";

create sequence "public"."imanye_3_id_seq";

create sequence "public"."llama11_id_seq";

create sequence "public"."llama1_id_seq";

create sequence "public"."llama3_id_seq";

create sequence "public"."llama4_id_seq";

create sequence "public"."llama5_id_seq";

create sequence "public"."llama7_id_seq";

create sequence "public"."llama9_id_seq";

create sequence "public"."mailer_id_seq";

create sequence "public"."manyel_2_id_seq";

create sequence "public"."metricool_id_seq";

create sequence "public"."n8n123_id_seq";

create sequence "public"."n8n_chat_histories_id_seq";

create sequence "public"."n8n_id_seq";

create sequence "public"."neem_25_id_seq";

create sequence "public"."news_2_id_seq";

create sequence "public"."news_3_id_seq";

create sequence "public"."news_4_id_seq";

create sequence "public"."news_5_id_seq";

create sequence "public"."news_id_seq";

create sequence "public"."news_one_id_seq";

create sequence "public"."nnmo1_id_seq";

create sequence "public"."notion_id_seq";

create sequence "public"."pet__pets_id_seq";

create sequence "public"."pierreme123_id_seq";

create sequence "public"."pierreme12_id_seq";

create sequence "public"."primelee1_id_seq";

create sequence "public"."proque_id_seq";

create sequence "public"."proton_id_seq";

create sequence "public"."sadhana_forest_id_seq";

create sequence "public"."saldo_id_seq";

create sequence "public"."story_id_seq";

create sequence "public"."teplate_id_seq";

create sequence "public"."tesi_id_seq";

create sequence "public"."test12345_id_seq";

create sequence "public"."test1t_id_seq";

create sequence "public"."test5_id_seq";

create sequence "public"."test6_gmail_com_id_seq";

create sequence "public"."test7_id_seq";

create sequence "public"."test_98_id_seq";

create sequence "public"."test_agent_1741894950_id_seq";

create sequence "public"."test_agent_1741895003_id_seq";

create sequence "public"."test_xyt7ti_id_seq";

create sequence "public"."testa_id_seq";

create sequence "public"."testab_id_seq";

create sequence "public"."testac_id_seq";

create sequence "public"."testad_id_seq";

create sequence "public"."testagen6_id_seq";

create sequence "public"."testagent1_id_seq";

create sequence "public"."testagent4_id_seq";

create sequence "public"."testagent5_id_seq";

create sequence "public"."testagent7_id_seq";

create sequence "public"."testagent8_id_seq";

create sequence "public"."testagent_id_seq";

create sequence "public"."testb_id_seq";

create sequence "public"."testc_id_seq";

create sequence "public"."testclient11_id_seq";

create sequence "public"."testclient12_id_seq";

create sequence "public"."testclient3_id_seq";

create sequence "public"."testclient4_id_seq";

create sequence "public"."testclient5_id_seq";

create sequence "public"."testd_id_seq";

create sequence "public"."teste_id_seq";

create sequence "public"."testest12_id_seq";

create sequence "public"."testest1_id_seq";

create sequence "public"."testest_id_seq";

create sequence "public"."testf_id_seq";

create sequence "public"."testg_id_seq";

create sequence "public"."testglas_id_seq";

create sequence "public"."testh_id_seq";

create sequence "public"."testheagent_id_seq";

create sequence "public"."testit_id_seq";

create sequence "public"."testj_id_seq";

create sequence "public"."testk_id_seq";

create sequence "public"."testl_id_seq";

create sequence "public"."testm_id_seq";

create sequence "public"."testme1234_id_seq";

create sequence "public"."testn_id_seq";

create sequence "public"."testo_id_seq";

create sequence "public"."testp_id_seq";

create sequence "public"."testq_id_seq";

create sequence "public"."testr_id_seq";

create sequence "public"."tests_id_seq";

create sequence "public"."testt_id_seq";

create sequence "public"."testu_id_seq";

create sequence "public"."testv_id_seq";

create sequence "public"."testw_id_seq";

create sequence "public"."the_agent_id_seq";

create sequence "public"."thetest_id_seq";

create sequence "public"."upwork_id_seq";

create sequence "public"."vahalas_id_seq";

create sequence "public"."value10_id_seq";

create sequence "public"."value11_id_seq";

create sequence "public"."value1_id_seq";

create sequence "public"."value2_id_seq";

create sequence "public"."value6_id_seq";

create sequence "public"."value7_id_seq";

create sequence "public"."value8_id_seq";

create sequence "public"."value9_id_seq";

create sequence "public"."vidgu_id_seq";

create sequence "public"."vladd2a_id_seq";

create sequence "public"."vlooh_id_seq";

create sequence "public"."voigai_id_seq";

create sequence "public"."website_urls_id_seq";

create sequence "public"."wechate_id_seq";

create sequence "public"."your_agent_id_seq";

drop trigger if exists "update_document_processing_updated_at" on "public"."document_processing";

drop policy "Users can view their own AI agent data" on "public"."ai_agents";

drop policy "Service role can access all activities" on "public"."client_activities";

drop policy "Users can view their own activities" on "public"."client_activities";

drop policy "Allow service role full access" on "public"."client_recovery_tokens";

drop policy "Admins can view temp passwords" on "public"."client_temp_passwords";

drop policy "Service role can manage temp passwords" on "public"."client_temp_passwords";

drop policy "Service role can access all client data" on "public"."clients";

drop policy "Users can view their own data" on "public"."clients";

drop policy "Enable insert for authenticated users" on "public"."document_processing";

drop policy "Enable read access for authenticated users" on "public"."document_processing";

drop policy "Enable update for authenticated users" on "public"."document_processing";

drop policy "Users can create processing jobs" on "public"."document_processing_jobs";

drop policy "Users can view their own processing jobs" on "public"."document_processing_jobs";

drop policy "Users can view their own processing status" on "public"."document_processing_status";

drop policy "Admins can view user roles" on "public"."user_roles";

drop policy "Service role can manage user roles" on "public"."user_roles";

revoke delete on table "public"."clients" from "anon";

revoke insert on table "public"."clients" from "anon";

revoke references on table "public"."clients" from "anon";

revoke select on table "public"."clients" from "anon";

revoke trigger on table "public"."clients" from "anon";

revoke truncate on table "public"."clients" from "anon";

revoke update on table "public"."clients" from "anon";

revoke delete on table "public"."clients" from "authenticated";

revoke insert on table "public"."clients" from "authenticated";

revoke references on table "public"."clients" from "authenticated";

revoke select on table "public"."clients" from "authenticated";

revoke trigger on table "public"."clients" from "authenticated";

revoke truncate on table "public"."clients" from "authenticated";

revoke update on table "public"."clients" from "authenticated";

revoke delete on table "public"."clients" from "service_role";

revoke insert on table "public"."clients" from "service_role";

revoke references on table "public"."clients" from "service_role";

revoke select on table "public"."clients" from "service_role";

revoke trigger on table "public"."clients" from "service_role";

revoke truncate on table "public"."clients" from "service_role";

revoke update on table "public"."clients" from "service_role";

revoke delete on table "public"."document_processing" from "anon";

revoke insert on table "public"."document_processing" from "anon";

revoke references on table "public"."document_processing" from "anon";

revoke select on table "public"."document_processing" from "anon";

revoke trigger on table "public"."document_processing" from "anon";

revoke truncate on table "public"."document_processing" from "anon";

revoke update on table "public"."document_processing" from "anon";

revoke delete on table "public"."document_processing" from "authenticated";

revoke insert on table "public"."document_processing" from "authenticated";

revoke references on table "public"."document_processing" from "authenticated";

revoke select on table "public"."document_processing" from "authenticated";

revoke trigger on table "public"."document_processing" from "authenticated";

revoke truncate on table "public"."document_processing" from "authenticated";

revoke update on table "public"."document_processing" from "authenticated";

revoke delete on table "public"."document_processing" from "service_role";

revoke insert on table "public"."document_processing" from "service_role";

revoke references on table "public"."document_processing" from "service_role";

revoke select on table "public"."document_processing" from "service_role";

revoke trigger on table "public"."document_processing" from "service_role";

revoke truncate on table "public"."document_processing" from "service_role";

revoke update on table "public"."document_processing" from "service_role";

revoke delete on table "public"."document_processing_status" from "anon";

revoke insert on table "public"."document_processing_status" from "anon";

revoke references on table "public"."document_processing_status" from "anon";

revoke select on table "public"."document_processing_status" from "anon";

revoke trigger on table "public"."document_processing_status" from "anon";

revoke truncate on table "public"."document_processing_status" from "anon";

revoke update on table "public"."document_processing_status" from "anon";

revoke delete on table "public"."document_processing_status" from "authenticated";

revoke insert on table "public"."document_processing_status" from "authenticated";

revoke references on table "public"."document_processing_status" from "authenticated";

revoke select on table "public"."document_processing_status" from "authenticated";

revoke trigger on table "public"."document_processing_status" from "authenticated";

revoke truncate on table "public"."document_processing_status" from "authenticated";

revoke update on table "public"."document_processing_status" from "authenticated";

revoke delete on table "public"."document_processing_status" from "service_role";

revoke insert on table "public"."document_processing_status" from "service_role";

revoke references on table "public"."document_processing_status" from "service_role";

revoke select on table "public"."document_processing_status" from "service_role";

revoke trigger on table "public"."document_processing_status" from "service_role";

revoke truncate on table "public"."document_processing_status" from "service_role";

revoke update on table "public"."document_processing_status" from "service_role";

alter table "public"."ai_agents" drop constraint "ai_agents_client_id_fkey";

alter table "public"."client_activities" drop constraint "client_activities_client_id_fkey";

alter table "public"."client_recovery_tokens" drop constraint "client_recovery_tokens_client_id_fkey";

alter table "public"."client_recovery_tokens" drop constraint "token_not_empty";

alter table "public"."client_temp_passwords" drop constraint "fk_agent";

alter table "public"."clients" drop constraint "clients_email_key";

alter table "public"."document_processing_jobs" drop constraint "document_processing_jobs_client_id_fkey";

alter table "public"."document_processing_status" drop constraint "document_processing_status_job_id_fkey";

drop function if exists "public"."update_processing_status"(p_job_id uuid, p_status text, p_progress integer, p_stage text, p_message text, p_metadata jsonb);

alter table "public"."clients" drop constraint "clients_pkey";

alter table "public"."document_processing" drop constraint "document_processing_pkey";

alter table "public"."document_processing_status" drop constraint "document_processing_status_pkey";

drop index if exists "public"."client_recovery_tokens_token_idx";

drop index if exists "public"."client_temp_passwords_agent_id_idx";

drop index if exists "public"."client_temp_passwords_email_idx";

drop index if exists "public"."clients_email_key";

drop index if exists "public"."clients_pkey";

drop index if exists "public"."document_processing_pkey";

drop index if exists "public"."document_processing_status_pkey";

drop index if exists "public"."idx_ai_agents_openai_assistant_id";

drop index if exists "public"."idx_client_activities_client_id";

drop index if exists "public"."idx_client_activities_type";

drop index if exists "public"."idx_clients_email";

drop index if exists "public"."idx_clients_status";

drop index if exists "public"."idx_doc_processing_jobs_client_id";

drop index if exists "public"."idx_doc_processing_jobs_status";

drop index if exists "public"."idx_doc_processing_status_job_id";

drop index if exists "public"."idx_document_processing_client_id";

drop index if exists "public"."idx_document_processing_document_url";

drop index if exists "public"."idx_document_processing_status";

drop index if exists "public"."user_roles_role_idx";

drop index if exists "public"."user_roles_user_id_idx";

drop table "public"."clients";

drop table "public"."document_processing";

drop table "public"."document_processing_status";

alter type "public"."activity_type_enum" rename to "activity_type_enum__old_version_to_be_dropped";

create table "public"."agent_1742397281528" (
    "id" bigint not null default nextval('agent_1742397281528_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."agent_1742425072029" (
    "id" bigint not null default nextval('agent_1742425072029_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."agent_1742426304880" (
    "id" bigint not null default nextval('agent_1742426304880_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ai_agent" (
    "id" bigint not null default nextval('ai_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ai_agents_backup" (
    "id" uuid,
    "client_id" uuid,
    "name" text,
    "settings" jsonb,
    "created_at" timestamp with time zone,
    "updated_at" timestamp with time zone,
    "content" text,
    "embedding" vector(1536),
    "url" text,
    "interaction_type" text,
    "query_text" text,
    "response_time_ms" integer,
    "is_error" boolean,
    "error_type" text,
    "error_message" text,
    "error_status" text,
    "topic" text,
    "sentiment" text,
    "agent_description" text
);


create table "public"."ai_documents" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "document_id" text not null,
    "document_url" text not null,
    "document_type" text not null,
    "status" text not null default 'pending'::text,
    "content" text,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now(),
    "agent_name" text not null,
    "error" text,
    "error_message" text,
    "processing_method" text,
    "metadata" jsonb default '{}'::jsonb
);


create table "public"."ai_interactions" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "agent_name" text not null,
    "query_text" text not null,
    "response_text" text not null,
    "created_at" timestamp with time zone default now(),
    "response_time_ms" integer,
    "metadata" jsonb default '{}'::jsonb
);


create table "public"."airtable" (
    "id" bigint not null default nextval('airtable_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."airtable" enable row level security;

create table "public"."asd" (
    "id" bigint not null default nextval('asd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ask_parent_handbook" (
    "id" bigint not null default nextval('ask_parent_handbook_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."buffalo_school_board" (
    "id" bigint not null default nextval('buffalo_school_board_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."buffalo_school_board" enable row level security;

create table "public"."byclicks" (
    "id" bigint not null default nextval('byclicks_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."cc" (
    "id" bigint not null default nextval('cc_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."cc" enable row level security;

create table "public"."client_3" (
    "id" bigint not null default nextval('client_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."client_invitations" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "token" uuid not null,
    "email" text not null,
    "expires_at" timestamp with time zone not null,
    "created_at" timestamp with time zone default now()
);


alter table "public"."client_invitations" enable row level security;

create table "public"."coca_cola" (
    "id" bigint not null default nextval('coca_cola_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."coins" (
    "id" bigint not null default nextval('coins_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."coins" enable row level security;

create table "public"."common_queries" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid,
    "query_text" text not null,
    "frequency" integer default 1,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now()
);


alter table "public"."common_queries" enable row level security;

create table "public"."deals" (
    "id" bigint not null default nextval('deals_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."digicel" (
    "id" bigint not null default nextval('digicel_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."document_links" (
    "id" integer not null default nextval('document_links_id_seq'::regclass),
    "client_id" uuid not null,
    "link" text not null,
    "document_type" text default 'google_drive'::text,
    "refresh_rate" integer not null default 30,
    "access_status" text default 'unknown'::text,
    "notified_at" timestamp with time zone,
    "created_at" timestamp with time zone default now()
);


create table "public"."email_logs" (
    "id" uuid not null default gen_random_uuid(),
    "email_to" text not null,
    "subject" text not null,
    "sent_at" timestamp with time zone default now(),
    "status" text not null,
    "error" text,
    "metadata" jsonb default '{}'::jsonb
);


alter table "public"."email_logs" enable row level security;

create table "public"."error_logs" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid,
    "error_type" text not null,
    "message" text not null,
    "status" text,
    "created_at" timestamp with time zone default now()
);


alter table "public"."error_logs" enable row level security;

create table "public"."frenniy" (
    "id" bigint not null default nextval('frenniy_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."g_g" (
    "id" bigint not null default nextval('g_g_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."gaiivo" (
    "id" bigint not null default nextval('gaiivo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."gaiivo" enable row level security;

create table "public"."glouglu" (
    "id" bigint not null default nextval('glouglu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."glouglu" enable row level security;

create table "public"."google_drive_links" (
    "id" integer not null default nextval('google_drive_links_id_seq'::regclass),
    "client_id" uuid,
    "link" text not null,
    "refresh_rate" integer not null default 30,
    "created_at" timestamp without time zone default CURRENT_TIMESTAMP,
    "access_status" text default 'unknown'::text,
    "notified_at" timestamp with time zone
);


create table "public"."great_deal" (
    "id" bigint not null default nextval('great_deal_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."imanye_3" (
    "id" bigint not null default nextval('imanye_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."imanye_3" enable row level security;

create table "public"."invitations" (
    "id" uuid not null default gen_random_uuid(),
    "email" text not null,
    "token" text not null,
    "role_type" text not null,
    "status" invitation_status default 'pending'::invitation_status,
    "created_by" uuid not null,
    "created_at" timestamp with time zone default now(),
    "expires_at" timestamp with time zone not null,
    "accepted_at" timestamp with time zone
);


alter table "public"."invitations" enable row level security;

create table "public"."llama1" (
    "id" bigint not null default nextval('llama1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama11" (
    "id" bigint not null default nextval('llama11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama3" (
    "id" bigint not null default nextval('llama3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama4" (
    "id" bigint not null default nextval('llama4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama5" (
    "id" bigint not null default nextval('llama5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama7" (
    "id" bigint not null default nextval('llama7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama9" (
    "id" bigint not null default nextval('llama9_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."mailer" (
    "id" bigint not null default nextval('mailer_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."mailer" enable row level security;

create table "public"."manyel_2" (
    "id" bigint not null default nextval('manyel_2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."manyel_2" enable row level security;

create table "public"."metricool" (
    "id" bigint not null default nextval('metricool_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."metricool" enable row level security;

create table "public"."n8n" (
    "id" bigint not null default nextval('n8n_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."n8n123" (
    "id" bigint not null default nextval('n8n123_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."n8n_chat_histories" (
    "id" integer not null default nextval('n8n_chat_histories_id_seq'::regclass),
    "session_id" character varying(255) not null,
    "message" jsonb not null
);


create table "public"."neem_25" (
    "id" bigint not null default nextval('neem_25_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news" (
    "id" bigint not null default nextval('news_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_2" (
    "id" bigint not null default nextval('news_2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_3" (
    "id" bigint not null default nextval('news_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_4" (
    "id" bigint not null default nextval('news_4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_5" (
    "id" bigint not null default nextval('news_5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_one" (
    "id" bigint not null default nextval('news_one_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."nnmo1" (
    "id" bigint not null default nextval('nnmo1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."notion" (
    "id" bigint not null default nextval('notion_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."notion" enable row level security;

create table "public"."pet__pets" (
    "id" bigint not null default nextval('pet__pets_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."pierreme12" (
    "id" bigint not null default nextval('pierreme12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."pierreme123" (
    "id" bigint not null default nextval('pierreme123_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."primelee1" (
    "id" bigint not null default nextval('primelee1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."profiles" (
    "id" uuid not null,
    "email" text,
    "full_name" text,
    "avatar_url" text,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now()
);


alter table "public"."profiles" enable row level security;

create table "public"."proque" (
    "id" bigint not null default nextval('proque_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."proton" (
    "id" bigint not null default nextval('proton_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."proton" enable row level security;

create table "public"."sadhana_forest" (
    "id" bigint not null default nextval('sadhana_forest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."saldo" (
    "id" bigint not null default nextval('saldo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."saldo" enable row level security;

create table "public"."story" (
    "id" bigint not null default nextval('story_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."story" enable row level security;

create table "public"."teplate" (
    "id" bigint not null default nextval('teplate_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tesi" (
    "id" bigint not null default nextval('tesi_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test12345" (
    "id" bigint not null default nextval('test12345_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test1t" (
    "id" bigint not null default nextval('test1t_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test5" (
    "id" bigint not null default nextval('test5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test6_gmail_com" (
    "id" bigint not null default nextval('test6_gmail_com_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test7" (
    "id" bigint not null default nextval('test7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_98" (
    "id" bigint not null default nextval('test_98_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_agent_1741894950" (
    "id" bigint not null default nextval('test_agent_1741894950_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_agent_1741895003" (
    "id" bigint not null default nextval('test_agent_1741895003_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_xyt7ti" (
    "id" bigint not null default nextval('test_xyt7ti_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testa" (
    "id" bigint not null default nextval('testa_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testab" (
    "id" bigint not null default nextval('testab_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testac" (
    "id" bigint not null default nextval('testac_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testad" (
    "id" bigint not null default nextval('testad_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagen6" (
    "id" bigint not null default nextval('testagen6_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent" (
    "id" bigint not null default nextval('testagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent1" (
    "id" bigint not null default nextval('testagent1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent4" (
    "id" bigint not null default nextval('testagent4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent5" (
    "id" bigint not null default nextval('testagent5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent7" (
    "id" bigint not null default nextval('testagent7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent8" (
    "id" bigint not null default nextval('testagent8_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testb" (
    "id" bigint not null default nextval('testb_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testc" (
    "id" bigint not null default nextval('testc_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient11" (
    "id" bigint not null default nextval('testclient11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient12" (
    "id" bigint not null default nextval('testclient12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient3" (
    "id" bigint not null default nextval('testclient3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient4" (
    "id" bigint not null default nextval('testclient4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient5" (
    "id" bigint not null default nextval('testclient5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testd" (
    "id" bigint not null default nextval('testd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."teste" (
    "id" bigint not null default nextval('teste_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest" (
    "id" bigint not null default nextval('testest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest1" (
    "id" bigint not null default nextval('testest1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest12" (
    "id" bigint not null default nextval('testest12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testf" (
    "id" bigint not null default nextval('testf_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testg" (
    "id" bigint not null default nextval('testg_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testglas" (
    "id" bigint not null default nextval('testglas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testh" (
    "id" bigint not null default nextval('testh_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testheagent" (
    "id" bigint not null default nextval('testheagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testit" (
    "id" bigint not null default nextval('testit_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testj" (
    "id" bigint not null default nextval('testj_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testk" (
    "id" bigint not null default nextval('testk_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testl" (
    "id" bigint not null default nextval('testl_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testm" (
    "id" bigint not null default nextval('testm_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testme1234" (
    "id" bigint not null default nextval('testme1234_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testn" (
    "id" bigint not null default nextval('testn_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testo" (
    "id" bigint not null default nextval('testo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testp" (
    "id" bigint not null default nextval('testp_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testq" (
    "id" bigint not null default nextval('testq_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testr" (
    "id" bigint not null default nextval('testr_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tests" (
    "id" bigint not null default nextval('tests_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testt" (
    "id" bigint not null default nextval('testt_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testu" (
    "id" bigint not null default nextval('testu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testv" (
    "id" bigint not null default nextval('testv_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testw" (
    "id" bigint not null default nextval('testw_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."the_agent" (
    "id" bigint not null default nextval('the_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."thetest" (
    "id" bigint not null default nextval('thetest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."upwork" (
    "id" bigint not null default nextval('upwork_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vahalas" (
    "id" bigint not null default nextval('vahalas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value1" (
    "id" bigint not null default nextval('value1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value10" (
    "id" bigint not null default nextval('value10_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value11" (
    "id" bigint not null default nextval('value11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value2" (
    "id" bigint not null default nextval('value2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value6" (
    "id" bigint not null default nextval('value6_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value7" (
    "id" bigint not null default nextval('value7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value8" (
    "id" bigint not null default nextval('value8_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value9" (
    "id" bigint not null default nextval('value9_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vidgu" (
    "id" bigint not null default nextval('vidgu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vladd2a" (
    "id" bigint not null default nextval('vladd2a_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vlooh" (
    "id" bigint not null default nextval('vlooh_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."voigai" (
    "id" bigint not null default nextval('voigai_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."website_urls" (
    "id" integer not null default nextval('website_urls_id_seq'::regclass),
    "client_id" uuid not null,
    "url" text not null,
    "refresh_rate" integer not null default 30,
    "created_at" timestamp without time zone default CURRENT_TIMESTAMP,
    "notified_at" timestamp with time zone,
    "last_crawled" timestamp with time zone,
    "status" text
);


create table "public"."wechate" (
    "id" bigint not null default nextval('wechate_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."your_agent" (
    "id" bigint not null default nextval('your_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


drop type "public"."activity_type_enum__old_version_to_be_dropped";

alter table "public"."ai_agents" drop column "chunk_index";

alter table "public"."ai_agents" drop column "chunk_metadata";

alter table "public"."ai_agents" drop column "total_chunks";

alter table "public"."ai_agents" add column "ai_prompt" text;

alter table "public"."ai_agents" add column "assistant_id" text;

alter table "public"."ai_agents" add column "company" text;

alter table "public"."ai_agents" add column "deleted_at" timestamp with time zone;

alter table "public"."ai_agents" add column "deletion_scheduled_at" timestamp with time zone;

alter table "public"."ai_agents" add column "description" text;

alter table "public"."ai_agents" add column "drive_link" text;

alter table "public"."ai_agents" add column "drive_link_added_at" timestamp with time zone;

alter table "public"."ai_agents" add column "drive_link_refresh_rate" integer default 30;

alter table "public"."ai_agents" add column "drive_urls" text[] default '{}'::text[];

alter table "public"."ai_agents" add column "last_active" timestamp with time zone;

alter table "public"."ai_agents" add column "metadata" jsonb default '{}'::jsonb;

alter table "public"."ai_agents" add column "size" integer;

alter table "public"."ai_agents" add column "status" text default 'active'::text;

alter table "public"."ai_agents" add column "type" text;

alter table "public"."ai_agents" add column "uploadDate" timestamp with time zone;

alter table "public"."ai_agents" add column "urls" text[] default '{}'::text[];

alter table "public"."ai_agents" add column "website_url_refresh_rate" integer default 30;

alter table "public"."ai_agents" alter column "created_at" set default now();

alter table "public"."ai_agents" alter column "openai_assistant_id" set data type character varying(255) using "openai_assistant_id"::character varying(255);

alter table "public"."ai_agents" alter column "updated_at" set default now();

alter table "public"."client_activities" alter column "activity_type" set data type activity_type_enum using "activity_type"::activity_type_enum;

alter table "public"."client_activities" alter column "created_at" set default now();

alter table "public"."client_activities" alter column "description" set not null;

alter table "public"."client_recovery_tokens" alter column "client_id" drop not null;

alter table "public"."client_recovery_tokens" alter column "id" set default gen_random_uuid();

alter table "public"."client_recovery_tokens" disable row level security;

alter table "public"."client_temp_passwords" drop column "expires_at";

alter table "public"."client_temp_passwords" add column "used" boolean default false;

alter table "public"."document_processing_jobs" add column "content" text;

alter table "public"."document_processing_jobs" add column "error_message" text;

alter table "public"."document_processing_jobs" alter column "agent_name" set not null;

alter table "public"."document_processing_jobs" alter column "client_id" set not null;

alter table "public"."document_processing_jobs" alter column "created_at" set default now();

alter table "public"."document_processing_jobs" alter column "created_at" set not null;

alter table "public"."document_processing_jobs" alter column "document_id" set not null;

alter table "public"."document_processing_jobs" alter column "processing_method" drop not null;

alter table "public"."document_processing_jobs" alter column "updated_at" set default now();

alter table "public"."document_processing_jobs" alter column "updated_at" set not null;

alter table "public"."user_roles" drop column "updated_at";

alter table "public"."user_roles" add column "client_id" uuid;

alter table "public"."user_roles" alter column "role" set data type app_role using "role"::app_role;

alter sequence "public"."agent_1742397281528_id_seq" owned by "public"."agent_1742397281528"."id";

alter sequence "public"."agent_1742425072029_id_seq" owned by "public"."agent_1742425072029"."id";

alter sequence "public"."agent_1742426304880_id_seq" owned by "public"."agent_1742426304880"."id";

alter sequence "public"."ai_agent_id_seq" owned by "public"."ai_agent"."id";

alter sequence "public"."airtable_id_seq" owned by "public"."airtable"."id";

alter sequence "public"."asd_id_seq" owned by "public"."asd"."id";

alter sequence "public"."ask_parent_handbook_id_seq" owned by "public"."ask_parent_handbook"."id";

alter sequence "public"."buffalo_school_board_id_seq" owned by "public"."buffalo_school_board"."id";

alter sequence "public"."byclicks_id_seq" owned by "public"."byclicks"."id";

alter sequence "public"."cc_id_seq" owned by "public"."cc"."id";

alter sequence "public"."client_3_id_seq" owned by "public"."client_3"."id";

alter sequence "public"."coca_cola_id_seq" owned by "public"."coca_cola"."id";

alter sequence "public"."coins_id_seq" owned by "public"."coins"."id";

alter sequence "public"."deals_id_seq" owned by "public"."deals"."id";

alter sequence "public"."digicel_id_seq" owned by "public"."digicel"."id";

alter sequence "public"."document_links_id_seq" owned by "public"."document_links"."id";

alter sequence "public"."frenniy_id_seq" owned by "public"."frenniy"."id";

alter sequence "public"."g_g_id_seq" owned by "public"."g_g"."id";

alter sequence "public"."gaiivo_id_seq" owned by "public"."gaiivo"."id";

alter sequence "public"."glouglu_id_seq" owned by "public"."glouglu"."id";

alter sequence "public"."google_drive_links_id_seq" owned by "public"."google_drive_links"."id";

alter sequence "public"."great_deal_id_seq" owned by "public"."great_deal"."id";

alter sequence "public"."imanye_3_id_seq" owned by "public"."imanye_3"."id";

alter sequence "public"."llama11_id_seq" owned by "public"."llama11"."id";

alter sequence "public"."llama1_id_seq" owned by "public"."llama1"."id";

alter sequence "public"."llama3_id_seq" owned by "public"."llama3"."id";

alter sequence "public"."llama4_id_seq" owned by "public"."llama4"."id";

alter sequence "public"."llama5_id_seq" owned by "public"."llama5"."id";

alter sequence "public"."llama7_id_seq" owned by "public"."llama7"."id";

alter sequence "public"."llama9_id_seq" owned by "public"."llama9"."id";

alter sequence "public"."mailer_id_seq" owned by "public"."mailer"."id";

alter sequence "public"."manyel_2_id_seq" owned by "public"."manyel_2"."id";

alter sequence "public"."metricool_id_seq" owned by "public"."metricool"."id";

alter sequence "public"."n8n123_id_seq" owned by "public"."n8n123"."id";

alter sequence "public"."n8n_chat_histories_id_seq" owned by "public"."n8n_chat_histories"."id";

alter sequence "public"."n8n_id_seq" owned by "public"."n8n"."id";

alter sequence "public"."neem_25_id_seq" owned by "public"."neem_25"."id";

alter sequence "public"."news_2_id_seq" owned by "public"."news_2"."id";

alter sequence "public"."news_3_id_seq" owned by "public"."news_3"."id";

alter sequence "public"."news_4_id_seq" owned by "public"."news_4"."id";

alter sequence "public"."news_5_id_seq" owned by "public"."news_5"."id";

alter sequence "public"."news_id_seq" owned by "public"."news"."id";

alter sequence "public"."news_one_id_seq" owned by "public"."news_one"."id";

alter sequence "public"."nnmo1_id_seq" owned by "public"."nnmo1"."id";

alter sequence "public"."notion_id_seq" owned by "public"."notion"."id";

alter sequence "public"."pet__pets_id_seq" owned by "public"."pet__pets"."id";

alter sequence "public"."pierreme123_id_seq" owned by "public"."pierreme123"."id";

alter sequence "public"."pierreme12_id_seq" owned by "public"."pierreme12"."id";

alter sequence "public"."primelee1_id_seq" owned by "public"."primelee1"."id";

alter sequence "public"."proque_id_seq" owned by "public"."proque"."id";

alter sequence "public"."proton_id_seq" owned by "public"."proton"."id";

alter sequence "public"."sadhana_forest_id_seq" owned by "public"."sadhana_forest"."id";

alter sequence "public"."saldo_id_seq" owned by "public"."saldo"."id";

alter sequence "public"."story_id_seq" owned by "public"."story"."id";

alter sequence "public"."teplate_id_seq" owned by "public"."teplate"."id";

alter sequence "public"."tesi_id_seq" owned by "public"."tesi"."id";

alter sequence "public"."test12345_id_seq" owned by "public"."test12345"."id";

alter sequence "public"."test1t_id_seq" owned by "public"."test1t"."id";

alter sequence "public"."test5_id_seq" owned by "public"."test5"."id";

alter sequence "public"."test6_gmail_com_id_seq" owned by "public"."test6_gmail_com"."id";

alter sequence "public"."test7_id_seq" owned by "public"."test7"."id";

alter sequence "public"."test_98_id_seq" owned by "public"."test_98"."id";

alter sequence "public"."test_agent_1741894950_id_seq" owned by "public"."test_agent_1741894950"."id";

alter sequence "public"."test_agent_1741895003_id_seq" owned by "public"."test_agent_1741895003"."id";

alter sequence "public"."test_xyt7ti_id_seq" owned by "public"."test_xyt7ti"."id";

alter sequence "public"."testa_id_seq" owned by "public"."testa"."id";

alter sequence "public"."testab_id_seq" owned by "public"."testab"."id";

alter sequence "public"."testac_id_seq" owned by "public"."testac"."id";

alter sequence "public"."testad_id_seq" owned by "public"."testad"."id";

alter sequence "public"."testagen6_id_seq" owned by "public"."testagen6"."id";

alter sequence "public"."testagent1_id_seq" owned by "public"."testagent1"."id";

alter sequence "public"."testagent4_id_seq" owned by "public"."testagent4"."id";

alter sequence "public"."testagent5_id_seq" owned by "public"."testagent5"."id";

alter sequence "public"."testagent7_id_seq" owned by "public"."testagent7"."id";

alter sequence "public"."testagent8_id_seq" owned by "public"."testagent8"."id";

alter sequence "public"."testagent_id_seq" owned by "public"."testagent"."id";

alter sequence "public"."testb_id_seq" owned by "public"."testb"."id";

alter sequence "public"."testc_id_seq" owned by "public"."testc"."id";

alter sequence "public"."testclient11_id_seq" owned by "public"."testclient11"."id";

alter sequence "public"."testclient12_id_seq" owned by "public"."testclient12"."id";

alter sequence "public"."testclient3_id_seq" owned by "public"."testclient3"."id";

alter sequence "public"."testclient4_id_seq" owned by "public"."testclient4"."id";

alter sequence "public"."testclient5_id_seq" owned by "public"."testclient5"."id";

alter sequence "public"."testd_id_seq" owned by "public"."testd"."id";

alter sequence "public"."teste_id_seq" owned by "public"."teste"."id";

alter sequence "public"."testest12_id_seq" owned by "public"."testest12"."id";

alter sequence "public"."testest1_id_seq" owned by "public"."testest1"."id";

alter sequence "public"."testest_id_seq" owned by "public"."testest"."id";

alter sequence "public"."testf_id_seq" owned by "public"."testf"."id";

alter sequence "public"."testg_id_seq" owned by "public"."testg"."id";

alter sequence "public"."testglas_id_seq" owned by "public"."testglas"."id";

alter sequence "public"."testh_id_seq" owned by "public"."testh"."id";

alter sequence "public"."testheagent_id_seq" owned by "public"."testheagent"."id";

alter sequence "public"."testit_id_seq" owned by "public"."testit"."id";

alter sequence "public"."testj_id_seq" owned by "public"."testj"."id";

alter sequence "public"."testk_id_seq" owned by "public"."testk"."id";

alter sequence "public"."testl_id_seq" owned by "public"."testl"."id";

alter sequence "public"."testm_id_seq" owned by "public"."testm"."id";

alter sequence "public"."testme1234_id_seq" owned by "public"."testme1234"."id";

alter sequence "public"."testn_id_seq" owned by "public"."testn"."id";

alter sequence "public"."testo_id_seq" owned by "public"."testo"."id";

alter sequence "public"."testp_id_seq" owned by "public"."testp"."id";

alter sequence "public"."testq_id_seq" owned by "public"."testq"."id";

alter sequence "public"."testr_id_seq" owned by "public"."testr"."id";

alter sequence "public"."tests_id_seq" owned by "public"."tests"."id";

alter sequence "public"."testt_id_seq" owned by "public"."testt"."id";

alter sequence "public"."testu_id_seq" owned by "public"."testu"."id";

alter sequence "public"."testv_id_seq" owned by "public"."testv"."id";

alter sequence "public"."testw_id_seq" owned by "public"."testw"."id";

alter sequence "public"."the_agent_id_seq" owned by "public"."the_agent"."id";

alter sequence "public"."thetest_id_seq" owned by "public"."thetest"."id";

alter sequence "public"."upwork_id_seq" owned by "public"."upwork"."id";

alter sequence "public"."vahalas_id_seq" owned by "public"."vahalas"."id";

alter sequence "public"."value10_id_seq" owned by "public"."value10"."id";

alter sequence "public"."value11_id_seq" owned by "public"."value11"."id";

alter sequence "public"."value1_id_seq" owned by "public"."value1"."id";

alter sequence "public"."value2_id_seq" owned by "public"."value2"."id";

alter sequence "public"."value6_id_seq" owned by "public"."value6"."id";

alter sequence "public"."value7_id_seq" owned by "public"."value7"."id";

alter sequence "public"."value8_id_seq" owned by "public"."value8"."id";

alter sequence "public"."value9_id_seq" owned by "public"."value9"."id";

alter sequence "public"."vidgu_id_seq" owned by "public"."vidgu"."id";

alter sequence "public"."vladd2a_id_seq" owned by "public"."vladd2a"."id";

alter sequence "public"."vlooh_id_seq" owned by "public"."vlooh"."id";

alter sequence "public"."voigai_id_seq" owned by "public"."voigai"."id";

alter sequence "public"."website_urls_id_seq" owned by "public"."website_urls"."id";

alter sequence "public"."wechate_id_seq" owned by "public"."wechate"."id";

alter sequence "public"."your_agent_id_seq" owned by "public"."your_agent"."id";

drop sequence if exists "public"."document_processing_id_seq";

CREATE UNIQUE INDEX agent_1742397281528_pkey ON public.agent_1742397281528 USING btree (id);

CREATE UNIQUE INDEX agent_1742425072029_pkey ON public.agent_1742425072029 USING btree (id);

CREATE UNIQUE INDEX agent_1742426304880_pkey ON public.agent_1742426304880 USING btree (id);

CREATE UNIQUE INDEX ai_agent_pkey ON public.ai_agent USING btree (id);

CREATE UNIQUE INDEX ai_documents_pkey ON public.ai_documents USING btree (id);

CREATE UNIQUE INDEX ai_interactions_pkey ON public.ai_interactions USING btree (id);

CREATE UNIQUE INDEX airtable_pkey ON public.airtable USING btree (id);

CREATE UNIQUE INDEX asd_pkey ON public.asd USING btree (id);

CREATE UNIQUE INDEX ask_parent_handbook_pkey ON public.ask_parent_handbook USING btree (id);

CREATE UNIQUE INDEX buffalo_school_board_pkey ON public.buffalo_school_board USING btree (id);

CREATE UNIQUE INDEX byclicks_pkey ON public.byclicks USING btree (id);

CREATE UNIQUE INDEX cc_pkey ON public.cc USING btree (id);

CREATE UNIQUE INDEX client_3_pkey ON public.client_3 USING btree (id);

CREATE UNIQUE INDEX client_invitations_pkey ON public.client_invitations USING btree (id);

CREATE UNIQUE INDEX coca_cola_pkey ON public.coca_cola USING btree (id);

CREATE UNIQUE INDEX coins_pkey ON public.coins USING btree (id);

alter table "public"."common_queries" add constraint "common_queries_pkey" PRIMARY KEY using index "common_queries_pkey";

alter table "public"."deals" add constraint "deals_pkey" PRIMARY KEY using index "deals_pkey";

alter table "public"."digicel" add constraint "digicel_pkey" PRIMARY KEY using index "digicel_pkey";

alter table "public"."document_links" add constraint "document_links_pkey" PRIMARY KEY using index "document_links_pkey";

alter table "public"."email_logs" add constraint "email_logs_pkey" PRIMARY KEY using index "email_logs_pkey";

alter table "public"."error_logs" add constraint "error_logs_pkey" PRIMARY KEY using index "error_logs_pkey";

alter table "public"."frenniy" add constraint "frenniy_pkey" PRIMARY KEY using index "frenniy_pkey";

alter table "public"."g_g" add constraint "g_g_pkey" PRIMARY KEY using index "g_g_pkey";

alter table "public"."gaiivo" add constraint "gaiivo_pkey" PRIMARY KEY using index "gaiivo_pkey";

alter table "public"."glouglu" add constraint "glouglu_pkey" PRIMARY KEY using index "glouglu_pkey";

alter table "public"."google_drive_links" add constraint "google_drive_links_pkey" PRIMARY KEY using index "google_drive_links_pkey";

alter table "public"."great_deal" add constraint "great_deal_pkey" PRIMARY KEY using index "great_deal_pkey";

alter table "public"."imanye_3" add constraint "imanye_3_pkey" PRIMARY KEY using index "imanye_3_pkey";

alter table "public"."invitations" add constraint "invitations_pkey" PRIMARY KEY using index "invitations_pkey";

alter table "public"."llama1" add constraint "llama1_pkey" PRIMARY KEY using index "llama1_pkey";

alter table "public"."llama11" add constraint "llama11_pkey" PRIMARY KEY using index "llama11_pkey";

alter table "public"."llama3" add constraint "llama3_pkey" PRIMARY KEY using index "llama3_pkey";

alter table "public"."llama4" add constraint "llama4_pkey" PRIMARY KEY using index "llama4_pkey";

alter table "public"."llama5" add constraint "llama5_pkey" PRIMARY KEY using index "llama5_pkey";

alter table "public"."llama7" add constraint "llama7_pkey" PRIMARY KEY using index "llama7_pkey";

alter table "public"."llama9" add constraint "llama9_pkey" PRIMARY KEY using index "llama9_pkey";

alter table "public"."mailer" add constraint "mailer_pkey" PRIMARY KEY using index "mailer_pkey";

alter table "public"."manyel_2" add constraint "manyel_2_pkey" PRIMARY KEY using index "manyel_2_pkey";

alter table "public"."metricool" add constraint "metricool_pkey" PRIMARY KEY using index "metricool_pkey";

alter table "public"."n8n" add constraint "n8n_pkey" PRIMARY KEY using index "n8n_pkey";

alter table "public"."n8n123" add constraint "n8n123_pkey" PRIMARY KEY using index "n8n123_pkey";

alter table "public"."n8n_chat_histories" add constraint "n8n_chat_histories_pkey" PRIMARY KEY using index "n8n_chat_histories_pkey";

alter table "public"."neem_25" add constraint "neem_25_pkey" PRIMARY KEY using index "neem_25_pkey";

alter table "public"."news" add constraint "news_pkey" PRIMARY KEY using index "news_pkey";

alter table "public"."news_2" add constraint "news_2_pkey" PRIMARY KEY using index "news_2_pkey";

alter table "public"."news_3" add constraint "news_3_pkey" PRIMARY KEY using index "news_3_pkey";

alter table "public"."news_4" add constraint "news_4_pkey" PRIMARY KEY using index "news_4_pkey";

alter table "public"."news_5" add constraint "news_5_pkey" PRIMARY KEY using index "news_5_pkey";

alter table "public"."news_one" add constraint "news_one_pkey" PRIMARY KEY using index "news_one_pkey";

alter table "public"."nnmo1" add constraint "nnmo1_pkey" PRIMARY KEY using index "nnmo1_pkey";

alter table "public"."notion" add constraint "notion_pkey" PRIMARY KEY using index "notion_pkey";

alter table "public"."pet__pets" add constraint "pet__pets_pkey" PRIMARY KEY using index "pet__pets_pkey";

alter table "public"."pierreme12" add constraint "pierreme12_pkey" PRIMARY KEY using index "pierreme12_pkey";

alter table "public"."pierreme123" add constraint "pierreme123_pkey" PRIMARY KEY using index "pierreme123_pkey";

alter table "public"."primelee1" add constraint "primelee1_pkey" PRIMARY KEY using index "primelee1_pkey";

alter table "public"."profiles" add constraint "profiles_pkey" PRIMARY KEY using index "profiles_pkey";

alter table "public"."proque" add constraint "proque_pkey" PRIMARY KEY using index "proque_pkey";

alter table "public"."proton" add constraint "proton_pkey" PRIMARY KEY using index "proton_pkey";

alter table "public"."sadhana_forest" add constraint "sadhana_forest_pkey" PRIMARY KEY using index "sadhana_forest_pkey";

alter table "public"."saldo" add constraint "saldo_pkey" PRIMARY KEY using index "saldo_pkey";

alter table "public"."story" add constraint "story_pkey" PRIMARY KEY using index "story_pkey";

alter table "public"."teplate" add constraint "teplate_pkey" PRIMARY KEY using index "teplate_pkey";

alter table "public"."tesi" add constraint "tesi_pkey" PRIMARY KEY using index "tesi_pkey";

alter table "public"."test12345" add constraint "test12345_pkey" PRIMARY KEY using index "test12345_pkey";

alter table "public"."test1t" add constraint "test1t_pkey" PRIMARY KEY using index "test1t_pkey";

alter table "public"."test5" add constraint "test5_pkey" PRIMARY KEY using index "test5_pkey";

alter table "public"."test6_gmail_com" add constraint "test6_gmail_com_pkey" PRIMARY KEY using index "test6_gmail_com_pkey";

alter table "public"."test7" add constraint "test7_pkey" PRIMARY KEY using index "test7_pkey";

alter table "public"."test_98" add constraint "test_98_pkey" PRIMARY KEY using index "test_98_pkey";

alter table "public"."test_agent_1741894950" add constraint "test_agent_1741894950_pkey" PRIMARY KEY using index "test_agent_1741894950_pkey";

alter table "public"."test_agent_1741895003" add constraint "test_agent_1741895003_pkey" PRIMARY KEY using index "test_agent_1741895003_pkey";

alter table "public"."test_xyt7ti" add constraint "test_xyt7ti_pkey" PRIMARY KEY using index "test_xyt7ti_pkey";

alter table "public"."testa" add constraint "testa_pkey" PRIMARY KEY using index "testa_pkey";

alter table "public"."testab" add constraint "testab_pkey" PRIMARY KEY using index "testab_pkey";

alter table "public"."testac" add constraint "testac_pkey" PRIMARY KEY using index "testac_pkey";

alter table "public"."testad" add constraint "testad_pkey" PRIMARY KEY using index "testad_pkey";

alter table "public"."testagen6" add constraint "testagen6_pkey" PRIMARY KEY using index "testagen6_pkey";

alter table "public"."testagent" add constraint "testagent_pkey" PRIMARY KEY using index "testagent_pkey";

alter table "public"."testagent1" add constraint "testagent1_pkey" PRIMARY KEY using index "testagent1_pkey";

alter table "public"."testagent4" add constraint "testagent4_pkey" PRIMARY KEY using index "testagent4_pkey";

alter table "public"."testagent5" add constraint "testagent5_pkey" PRIMARY KEY using index "testagent5_pkey";

alter table "public"."testagent7" add constraint "testagent7_pkey" PRIMARY KEY using index "testagent7_pkey";

alter table "public"."testagent8" add constraint "testagent8_pkey" PRIMARY KEY using index "testagent8_pkey";

alter table "public"."testb" add constraint "testb_pkey" PRIMARY KEY using index "testb_pkey";

alter table "public"."testc" add constraint "testc_pkey" PRIMARY KEY using index "testc_pkey";

alter table "public"."testclient11" add constraint "testclient11_pkey" PRIMARY KEY using index "testclient11_pkey";

alter table "public"."testclient12" add constraint "testclient12_pkey" PRIMARY KEY using index "testclient12_pkey";

alter table "public"."testclient3" add constraint "testclient3_pkey" PRIMARY KEY using index "testclient3_pkey";

alter table "public"."testclient4" add constraint "testclient4_pkey" PRIMARY KEY using index "testclient4_pkey";

alter table "public"."testclient5" add constraint "testclient5_pkey" PRIMARY KEY using index "testclient5_pkey";

alter table "public"."testd" add constraint "testd_pkey" PRIMARY KEY using index "testd_pkey";

alter table "public"."teste" add constraint "teste_pkey" PRIMARY KEY using index "teste_pkey";

alter table "public"."testest" add constraint "testest_pkey" PRIMARY KEY using index "testest_pkey";

alter table "public"."testest1" add constraint "testest1_pkey" PRIMARY KEY using index "testest1_pkey";

alter table "public"."testest12" add constraint "testest12_pkey" PRIMARY KEY using index "testest12_pkey";

alter table "public"."testf" add constraint "testf_pkey" PRIMARY KEY using index "testf_pkey";

alter table "public"."testg" add constraint "testg_pkey" PRIMARY KEY using index "testg_pkey";

alter table "public"."testglas" add constraint "testglas_pkey" PRIMARY KEY using index "testglas_pkey";

alter table "public"."testh" add constraint "testh_pkey" PRIMARY KEY using index "testh_pkey";

alter table "public"."testheagent" add constraint "testheagent_pkey" PRIMARY KEY using index "testheagent_pkey";

alter table "public"."testit" add constraint "testit_pkey" PRIMARY KEY using index "testit_pkey";

alter table "public"."testj" add constraint "testj_pkey" PRIMARY KEY using index "testj_pkey";

alter table "public"."testk" add constraint "testk_pkey" PRIMARY KEY using index "testk_pkey";

alter table "public"."testl" add constraint "testl_pkey" PRIMARY KEY using index "testl_pkey";

alter table "public"."testm" add constraint "testm_pkey" PRIMARY KEY using index "testm_pkey";

alter table "public"."testme1234" add constraint "testme1234_pkey" PRIMARY KEY using index "testme1234_pkey";

alter table "public"."testn" add constraint "testn_pkey" PRIMARY KEY using index "testn_pkey";

alter table "public"."testo" add constraint "testo_pkey" PRIMARY KEY using index "testo_pkey";

alter table "public"."testp" add constraint "testp_pkey" PRIMARY KEY using index "testp_pkey";

alter table "public"."testq" add constraint "testq_pkey" PRIMARY KEY using index "testq_pkey";

alter table "public"."testr" add constraint "testr_pkey" PRIMARY KEY using index "testr_pkey";

alter table "public"."tests" add constraint "tests_pkey" PRIMARY KEY using index "tests_pkey";

alter table "public"."testt" add constraint "testt_pkey" PRIMARY KEY using index "testt_pkey";

alter table "public"."testu" add constraint "testu_pkey" PRIMARY KEY using index "testu_pkey";

alter table "public"."testv" add constraint "testv_pkey" PRIMARY KEY using index "testv_pkey";

alter table "public"."testw" add constraint "testw_pkey" PRIMARY KEY using index "testw_pkey";

alter table "public"."the_agent" add constraint "the_agent_pkey" PRIMARY KEY using index "the_agent_pkey";

alter table "public"."thetest" add constraint "thetest_pkey" PRIMARY KEY using index "thetest_pkey";

alter table "public"."upwork" add constraint "upwork_pkey" PRIMARY KEY using index "upwork_pkey";

alter table "public"."vahalas" add constraint "vahalas_pkey" PRIMARY KEY using index "vahalas_pkey";

alter table "public"."value1" add constraint "value1_pkey" PRIMARY KEY using index "value1_pkey";

alter table "public"."value10" add constraint "value10_pkey" PRIMARY KEY using index "value10_pkey";

alter table "public"."value11" add constraint "value11_pkey" PRIMARY KEY using index "value11_pkey";

alter table "public"."value2" add constraint "value2_pkey" PRIMARY KEY using index "value2_pkey";

alter table "public"."value6" add constraint "value6_pkey" PRIMARY KEY using index "value6_pkey";

alter table "public"."value7" add constraint "value7_pkey" PRIMARY KEY using index "value7_pkey";

alter table "public"."value8" add constraint "value8_pkey" PRIMARY KEY using index "value8_pkey";

alter table "public"."value9" add constraint "value9_pkey" PRIMARY KEY using index "value9_pkey";

alter table "public"."vidgu" add constraint "vidgu_pkey" PRIMARY KEY using index "vidgu_pkey";

alter table "public"."vladd2a" add constraint "vladd2a_pkey" PRIMARY KEY using index "vladd2a_pkey";

alter table "public"."vlooh" add constraint "vlooh_pkey" PRIMARY KEY using index "vlooh_pkey";

alter table "public"."voigai" add constraint "voigai_pkey" PRIMARY KEY using index "voigai_pkey";

alter table "public"."website_urls" add constraint "website_urls_pkey" PRIMARY KEY using index "website_urls_pkey";

alter table "public"."wechate" add constraint "wechate_pkey" PRIMARY KEY using index "wechate_pkey";

alter table "public"."your_agent" add constraint "your_agent_pkey" PRIMARY KEY using index "your_agent_pkey";

alter table "public"."ai_documents" add constraint "ai_documents_client_id_fkey" FOREIGN KEY (client_id) REFERENCES ai_agents(id) ON DELETE CASCADE not valid;

alter table "public"."ai_documents" validate constraint "ai_documents_client_id_fkey";

alter table "public"."ai_interactions" add constraint "ai_interactions_client_id_fkey" FOREIGN KEY (client_id) REFERENCES ai_agents(id) ON DELETE CASCADE not valid;

alter table "public"."ai_interactions" validate constraint "ai_interactions_client_id_fkey";

alter table "public"."document_links" add constraint "document_links_client_id_fkey" FOREIGN KEY (client_id) REFERENCES ai_agents(id) ON DELETE CASCADE not valid;

alter table "public"."document_links" validate constraint "document_links_client_id_fkey";

alter table "public"."document_processing_jobs" add constraint "valid_processing_method" CHECK ((processing_method = ANY (ARRAY['llamaparse'::text, 'firecrawl'::text]))) not valid;

alter table "public"."document_processing_jobs" validate constraint "valid_processing_method";

alter table "public"."invitations" add constraint "fk_created_by" FOREIGN KEY (created_by) REFERENCES auth.users(id) ON DELETE CASCADE not valid;

alter table "public"."invitations" validate constraint "fk_created_by";

alter table "public"."invitations" add constraint "invitations_role_type_check" CHECK ((role_type = ANY (ARRAY['admin'::text, 'client'::text]))) not valid;

alter table "public"."invitations" validate constraint "invitations_role_type_check";

alter table "public"."invitations" add constraint "invitations_token_key" UNIQUE using index "invitations_token_key";

alter table "public"."profiles" add constraint "profiles_id_fkey" FOREIGN KEY (id) REFERENCES auth.users(id) ON DELETE CASCADE not valid;

alter table "public"."profiles" validate constraint "profiles_id_fkey";

alter table "public"."user_roles" add constraint "user_roles_user_id_role_key" UNIQUE using index "user_roles_user_id_role_key";

alter table "public"."user_roles" add constraint "user_roles_user_id_unique" UNIQUE using index "user_roles_user_id_unique";

set check_function_bodies = off;

CREATE OR REPLACE FUNCTION public.accept_invitation(token_param text, accepting_user_id uuid)
 RETURNS text
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    invite_record invitations%ROWTYPE;
BEGIN
    SELECT * INTO invite_record
    FROM invitations
    WHERE token = token_param
    AND status = 'pending'
    AND expires_at > now()
    FOR UPDATE;

    IF NOT FOUND THEN
        RAISE EXCEPTION 'Invalid or expired invitation';
    END IF;

    UPDATE invitations
    SET status = 'accepted',
        accepted_at = now()
    WHERE token = token_param;

    INSERT INTO user_roles (user_id, role)
    VALUES (accepting_user_id, invite_record.role_type::app_role);

    RETURN invite_record.role_type;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.audit_agent_names()
 RETURNS TABLE(client_id uuid, client_name text, client_agent_name text, ai_agent_name text, record_count bigint)
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
create extension if not exists "pg_net" with schema "public" version '0.14.0';

create sequence "public"."agent_1742397281528_id_seq";

create sequence "public"."agent_1742425072029_id_seq";

create sequence "public"."agent_1742426304880_id_seq";

create sequence "public"."ai_agent_id_seq";

create sequence "public"."airtable_id_seq";

create sequence "public"."asd_id_seq";

create sequence "public"."ask_parent_handbook_id_seq";

create sequence "public"."buffalo_school_board_id_seq";

create sequence "public"."byclicks_id_seq";

create sequence "public"."cc_id_seq";

create sequence "public"."client_3_id_seq";

create sequence "public"."coca_cola_id_seq";

create sequence "public"."coins_id_seq";

create sequence "public"."deals_id_seq";

create sequence "public"."digicel_id_seq";

create sequence "public"."document_links_id_seq";

create sequence "public"."frenniy_id_seq";

create sequence "public"."g_g_id_seq";

create sequence "public"."gaiivo_id_seq";

create sequence "public"."glouglu_id_seq";

create sequence "public"."google_drive_links_id_seq";

create sequence "public"."great_deal_id_seq";

create sequence "public"."imanye_3_id_seq";

create sequence "public"."llama11_id_seq";

create sequence "public"."llama1_id_seq";

create sequence "public"."llama3_id_seq";

create sequence "public"."llama4_id_seq";

create sequence "public"."llama5_id_seq";

create sequence "public"."llama7_id_seq";

create sequence "public"."llama9_id_seq";

create sequence "public"."mailer_id_seq";

create sequence "public"."manyel_2_id_seq";

create sequence "public"."metricool_id_seq";

create sequence "public"."n8n123_id_seq";

create sequence "public"."n8n_chat_histories_id_seq";

create sequence "public"."n8n_id_seq";

create sequence "public"."neem_25_id_seq";

create sequence "public"."news_2_id_seq";

create sequence "public"."news_3_id_seq";

create sequence "public"."news_4_id_seq";

create sequence "public"."news_5_id_seq";

create sequence "public"."news_id_seq";

create sequence "public"."news_one_id_seq";

create sequence "public"."nnmo1_id_seq";

create sequence "public"."notion_id_seq";

create sequence "public"."pet__pets_id_seq";

create sequence "public"."pierreme123_id_seq";

create sequence "public"."pierreme12_id_seq";

create sequence "public"."primelee1_id_seq";

create sequence "public"."proque_id_seq";

create sequence "public"."proton_id_seq";

create sequence "public"."sadhana_forest_id_seq";

create sequence "public"."saldo_id_seq";

create sequence "public"."story_id_seq";

create sequence "public"."teplate_id_seq";

create sequence "public"."tesi_id_seq";

create sequence "public"."test12345_id_seq";

create sequence "public"."test1t_id_seq";

create sequence "public"."test5_id_seq";

create sequence "public"."test6_gmail_com_id_seq";

create sequence "public"."test7_id_seq";

create sequence "public"."test_98_id_seq";

create sequence "public"."test_agent_1741894950_id_seq";

create sequence "public"."test_agent_1741895003_id_seq";

create sequence "public"."test_xyt7ti_id_seq";

create sequence "public"."testa_id_seq";

create sequence "public"."testab_id_seq";

create sequence "public"."testac_id_seq";

create sequence "public"."testad_id_seq";

create sequence "public"."testagen6_id_seq";

create sequence "public"."testagent1_id_seq";

create sequence "public"."testagent4_id_seq";

create sequence "public"."testagent5_id_seq";

create sequence "public"."testagent7_id_seq";

create sequence "public"."testagent8_id_seq";

create sequence "public"."testagent_id_seq";

create sequence "public"."testb_id_seq";

create sequence "public"."testc_id_seq";

create sequence "public"."testclient11_id_seq";

create sequence "public"."testclient12_id_seq";

create sequence "public"."testclient3_id_seq";

create sequence "public"."testclient4_id_seq";

create sequence "public"."testclient5_id_seq";

create sequence "public"."testd_id_seq";

create sequence "public"."teste_id_seq";

create sequence "public"."testest12_id_seq";

create sequence "public"."testest1_id_seq";

create sequence "public"."testest_id_seq";

create sequence "public"."testf_id_seq";

create sequence "public"."testg_id_seq";

create sequence "public"."testglas_id_seq";

create sequence "public"."testh_id_seq";

create sequence "public"."testheagent_id_seq";

create sequence "public"."testit_id_seq";

create sequence "public"."testj_id_seq";

create sequence "public"."testk_id_seq";

create sequence "public"."testl_id_seq";

create sequence "public"."testm_id_seq";

create sequence "public"."testme1234_id_seq";

create sequence "public"."testn_id_seq";

create sequence "public"."testo_id_seq";

create sequence "public"."testp_id_seq";

create sequence "public"."testq_id_seq";

create sequence "public"."testr_id_seq";

create sequence "public"."tests_id_seq";

create sequence "public"."testt_id_seq";

create sequence "public"."testu_id_seq";

create sequence "public"."testv_id_seq";

create sequence "public"."testw_id_seq";

create sequence "public"."the_agent_id_seq";

create sequence "public"."thetest_id_seq";

create sequence "public"."upwork_id_seq";

create sequence "public"."vahalas_id_seq";

create sequence "public"."value10_id_seq";

create sequence "public"."value11_id_seq";

create sequence "public"."value1_id_seq";

create sequence "public"."value2_id_seq";

create sequence "public"."value6_id_seq";

create sequence "public"."value7_id_seq";

create sequence "public"."value8_id_seq";

create sequence "public"."value9_id_seq";

create sequence "public"."vidgu_id_seq";

create sequence "public"."vladd2a_id_seq";

create sequence "public"."vlooh_id_seq";

create sequence "public"."voigai_id_seq";

create sequence "public"."website_urls_id_seq";

create sequence "public"."wechate_id_seq";

create sequence "public"."your_agent_id_seq";

drop trigger if exists "update_document_processing_updated_at" on "public"."document_processing";

drop policy "Users can view their own AI agent data" on "public"."ai_agents";

drop policy "Service role can access all activities" on "public"."client_activities";

drop policy "Users can view their own activities" on "public"."client_activities";

drop policy "Allow service role full access" on "public"."client_recovery_tokens";

drop policy "Admins can view temp passwords" on "public"."client_temp_passwords";

drop policy "Service role can manage temp passwords" on "public"."client_temp_passwords";

drop policy "Service role can access all client data" on "public"."clients";

drop policy "Users can view their own data" on "public"."clients";

drop policy "Enable insert for authenticated users" on "public"."document_processing";

drop policy "Enable read access for authenticated users" on "public"."document_processing";

drop policy "Enable update for authenticated users" on "public"."document_processing";

drop policy "Users can create processing jobs" on "public"."document_processing_jobs";

drop policy "Users can view their own processing jobs" on "public"."document_processing_jobs";

drop policy "Users can view their own processing status" on "public"."document_processing_status";

drop policy "Admins can view user roles" on "public"."user_roles";

drop policy "Service role can manage user roles" on "public"."user_roles";

revoke delete on table "public"."clients" from "anon";

revoke insert on table "public"."clients" from "anon";

revoke references on table "public"."clients" from "anon";

revoke select on table "public"."clients" from "anon";

revoke trigger on table "public"."clients" from "anon";

revoke truncate on table "public"."clients" from "anon";

revoke update on table "public"."clients" from "anon";

revoke delete on table "public"."clients" from "authenticated";

revoke insert on table "public"."clients" from "authenticated";

revoke references on table "public"."clients" from "authenticated";

revoke select on table "public"."clients" from "authenticated";

revoke trigger on table "public"."clients" from "authenticated";

revoke truncate on table "public"."clients" from "authenticated";

revoke update on table "public"."clients" from "authenticated";

revoke delete on table "public"."clients" from "service_role";

revoke insert on table "public"."clients" from "service_role";

revoke references on table "public"."clients" from "service_role";

revoke select on table "public"."clients" from "service_role";

revoke trigger on table "public"."clients" from "service_role";

revoke truncate on table "public"."clients" from "service_role";

revoke update on table "public"."clients" from "service_role";

revoke delete on table "public"."document_processing" from "anon";

revoke insert on table "public"."document_processing" from "anon";

revoke references on table "public"."document_processing" from "anon";

revoke select on table "public"."document_processing" from "anon";

revoke trigger on table "public"."document_processing" from "anon";

revoke truncate on table "public"."document_processing" from "anon";

revoke update on table "public"."document_processing" from "anon";

revoke delete on table "public"."document_processing" from "authenticated";

revoke insert on table "public"."document_processing" from "authenticated";

revoke references on table "public"."document_processing" from "authenticated";

revoke select on table "public"."document_processing" from "authenticated";

revoke trigger on table "public"."document_processing" from "authenticated";

revoke truncate on table "public"."document_processing" from "authenticated";

revoke update on table "public"."document_processing" from "authenticated";

revoke delete on table "public"."document_processing" from "service_role";

revoke insert on table "public"."document_processing" from "service_role";

revoke references on table "public"."document_processing" from "service_role";

revoke select on table "public"."document_processing" from "service_role";

revoke trigger on table "public"."document_processing" from "service_role";

revoke truncate on table "public"."document_processing" from "service_role";

revoke update on table "public"."document_processing" from "service_role";

revoke delete on table "public"."document_processing_status" from "anon";

revoke insert on table "public"."document_processing_status" from "anon";

revoke references on table "public"."document_processing_status" from "anon";

revoke select on table "public"."document_processing_status" from "anon";

revoke trigger on table "public"."document_processing_status" from "anon";

revoke truncate on table "public"."document_processing_status" from "anon";

revoke update on table "public"."document_processing_status" from "anon";

revoke delete on table "public"."document_processing_status" from "authenticated";

revoke insert on table "public"."document_processing_status" from "authenticated";

revoke references on table "public"."document_processing_status" from "authenticated";

revoke select on table "public"."document_processing_status" from "authenticated";

revoke trigger on table "public"."document_processing_status" from "authenticated";

revoke truncate on table "public"."document_processing_status" from "authenticated";

revoke update on table "public"."document_processing_status" from "authenticated";

revoke delete on table "public"."document_processing_status" from "service_role";

revoke insert on table "public"."document_processing_status" from "service_role";

revoke references on table "public"."document_processing_status" from "service_role";

revoke select on table "public"."document_processing_status" from "service_role";

revoke trigger on table "public"."document_processing_status" from "service_role";

revoke truncate on table "public"."document_processing_status" from "service_role";

revoke update on table "public"."document_processing_status" from "service_role";

alter table "public"."ai_agents" drop constraint "ai_agents_client_id_fkey";

alter table "public"."client_activities" drop constraint "client_activities_client_id_fkey";

alter table "public"."client_recovery_tokens" drop constraint "client_recovery_tokens_client_id_fkey";

alter table "public"."client_recovery_tokens" drop constraint "token_not_empty";

alter table "public"."client_temp_passwords" drop constraint "fk_agent";

alter table "public"."clients" drop constraint "clients_email_key";

alter table "public"."document_processing_jobs" drop constraint "document_processing_jobs_client_id_fkey";

alter table "public"."document_processing_status" drop constraint "document_processing_status_job_id_fkey";

drop function if exists "public"."update_processing_status"(p_job_id uuid, p_status text, p_progress integer, p_stage text, p_message text, p_metadata jsonb);

alter table "public"."clients" drop constraint "clients_pkey";

alter table "public"."document_processing" drop constraint "document_processing_pkey";

alter table "public"."document_processing_status" drop constraint "document_processing_status_pkey";

drop index if exists "public"."client_recovery_tokens_token_idx";

drop index if exists "public"."client_temp_passwords_agent_id_idx";

drop index if exists "public"."client_temp_passwords_email_idx";

drop index if exists "public"."clients_email_key";

drop index if exists "public"."clients_pkey";

drop index if exists "public"."document_processing_pkey";

drop index if exists "public"."document_processing_status_pkey";

drop index if exists "public"."idx_ai_agents_openai_assistant_id";

drop index if exists "public"."idx_client_activities_client_id";

drop index if exists "public"."idx_client_activities_type";

drop index if exists "public"."idx_clients_email";

drop index if exists "public"."idx_clients_status";

drop index if exists "public"."idx_doc_processing_jobs_client_id";

drop index if exists "public"."idx_doc_processing_jobs_status";

drop index if exists "public"."idx_doc_processing_status_job_id";

drop index if exists "public"."idx_document_processing_client_id";

drop index if exists "public"."idx_document_processing_document_url";

drop index if exists "public"."idx_document_processing_status";

drop index if exists "public"."user_roles_role_idx";

drop index if exists "public"."user_roles_user_id_idx";

drop table "public"."clients";

drop table "public"."document_processing";

drop table "public"."document_processing_status";

alter type "public"."activity_type_enum" rename to "activity_type_enum__old_version_to_be_dropped";

create table "public"."agent_1742397281528" (
    "id" bigint not null default nextval('agent_1742397281528_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."agent_1742425072029" (
    "id" bigint not null default nextval('agent_1742425072029_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."agent_1742426304880" (
    "id" bigint not null default nextval('agent_1742426304880_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ai_agent" (
    "id" bigint not null default nextval('ai_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ai_agents_backup" (
    "id" uuid,
    "client_id" uuid,
    "name" text,
    "settings" jsonb,
    "created_at" timestamp with time zone,
    "updated_at" timestamp with time zone,
    "content" text,
    "embedding" vector(1536),
    "url" text,
    "interaction_type" text,
    "query_text" text,
    "response_time_ms" integer,
    "is_error" boolean,
    "error_type" text,
    "error_message" text,
    "error_status" text,
    "topic" text,
    "sentiment" text,
    "agent_description" text
);


create table "public"."ai_documents" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "document_id" text not null,
    "document_url" text not null,
    "document_type" text not null,
    "status" text not null default 'pending'::text,
    "content" text,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now(),
    "agent_name" text not null,
    "error" text,
    "error_message" text,
    "processing_method" text,
    "metadata" jsonb default '{}'::jsonb
);


create table "public"."ai_interactions" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "agent_name" text not null,
    "query_text" text not null,
    "response_text" text not null,
    "created_at" timestamp with time zone default now(),
    "response_time_ms" integer,
    "metadata" jsonb default '{}'::jsonb
);


create table "public"."airtable" (
    "id" bigint not null default nextval('airtable_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."airtable" enable row level security;

create table "public"."asd" (
    "id" bigint not null default nextval('asd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."ask_parent_handbook" (
    "id" bigint not null default nextval('ask_parent_handbook_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."buffalo_school_board" (
    "id" bigint not null default nextval('buffalo_school_board_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."buffalo_school_board" enable row level security;

create table "public"."byclicks" (
    "id" bigint not null default nextval('byclicks_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."cc" (
    "id" bigint not null default nextval('cc_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."cc" enable row level security;

create table "public"."client_3" (
    "id" bigint not null default nextval('client_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."client_invitations" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid not null,
    "token" uuid not null,
    "email" text not null,
    "expires_at" timestamp with time zone not null,
    "created_at" timestamp with time zone default now()
);


alter table "public"."client_invitations" enable row level security;

create table "public"."coca_cola" (
    "id" bigint not null default nextval('coca_cola_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."coins" (
    "id" bigint not null default nextval('coins_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."coins" enable row level security;

create table "public"."common_queries" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid,
    "query_text" text not null,
    "frequency" integer default 1,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now()
);


alter table "public"."common_queries" enable row level security;

create table "public"."deals" (
    "id" bigint not null default nextval('deals_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."digicel" (
    "id" bigint not null default nextval('digicel_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."document_links" (
    "id" integer not null default nextval('document_links_id_seq'::regclass),
    "client_id" uuid not null,
    "link" text not null,
    "document_type" text default 'google_drive'::text,
    "refresh_rate" integer not null default 30,
    "access_status" text default 'unknown'::text,
    "notified_at" timestamp with time zone,
    "created_at" timestamp with time zone default now()
);


create table "public"."email_logs" (
    "id" uuid not null default gen_random_uuid(),
    "email_to" text not null,
    "subject" text not null,
    "sent_at" timestamp with time zone default now(),
    "status" text not null,
    "error" text,
    "metadata" jsonb default '{}'::jsonb
);


alter table "public"."email_logs" enable row level security;

create table "public"."error_logs" (
    "id" uuid not null default gen_random_uuid(),
    "client_id" uuid,
    "error_type" text not null,
    "message" text not null,
    "status" text,
    "created_at" timestamp with time zone default now()
);


alter table "public"."error_logs" enable row level security;

create table "public"."frenniy" (
    "id" bigint not null default nextval('frenniy_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."g_g" (
    "id" bigint not null default nextval('g_g_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."gaiivo" (
    "id" bigint not null default nextval('gaiivo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."gaiivo" enable row level security;

create table "public"."glouglu" (
    "id" bigint not null default nextval('glouglu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."glouglu" enable row level security;

create table "public"."google_drive_links" (
    "id" integer not null default nextval('google_drive_links_id_seq'::regclass),
    "client_id" uuid,
    "link" text not null,
    "refresh_rate" integer not null default 30,
    "created_at" timestamp without time zone default CURRENT_TIMESTAMP,
    "access_status" text default 'unknown'::text,
    "notified_at" timestamp with time zone
);


create table "public"."great_deal" (
    "id" bigint not null default nextval('great_deal_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."imanye_3" (
    "id" bigint not null default nextval('imanye_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."imanye_3" enable row level security;

create table "public"."invitations" (
    "id" uuid not null default gen_random_uuid(),
    "email" text not null,
    "token" text not null,
    "role_type" text not null,
    "status" invitation_status default 'pending'::invitation_status,
    "created_by" uuid not null,
    "created_at" timestamp with time zone default now(),
    "expires_at" timestamp with time zone not null,
    "accepted_at" timestamp with time zone
);


alter table "public"."invitations" enable row level security;

create table "public"."llama1" (
    "id" bigint not null default nextval('llama1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama11" (
    "id" bigint not null default nextval('llama11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama3" (
    "id" bigint not null default nextval('llama3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama4" (
    "id" bigint not null default nextval('llama4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama5" (
    "id" bigint not null default nextval('llama5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama7" (
    "id" bigint not null default nextval('llama7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."llama9" (
    "id" bigint not null default nextval('llama9_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."mailer" (
    "id" bigint not null default nextval('mailer_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."mailer" enable row level security;

create table "public"."manyel_2" (
    "id" bigint not null default nextval('manyel_2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."manyel_2" enable row level security;

create table "public"."metricool" (
    "id" bigint not null default nextval('metricool_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."metricool" enable row level security;

create table "public"."n8n" (
    "id" bigint not null default nextval('n8n_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."n8n123" (
    "id" bigint not null default nextval('n8n123_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."n8n_chat_histories" (
    "id" integer not null default nextval('n8n_chat_histories_id_seq'::regclass),
    "session_id" character varying(255) not null,
    "message" jsonb not null
);


create table "public"."neem_25" (
    "id" bigint not null default nextval('neem_25_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news" (
    "id" bigint not null default nextval('news_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_2" (
    "id" bigint not null default nextval('news_2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_3" (
    "id" bigint not null default nextval('news_3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_4" (
    "id" bigint not null default nextval('news_4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_5" (
    "id" bigint not null default nextval('news_5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."news_one" (
    "id" bigint not null default nextval('news_one_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."nnmo1" (
    "id" bigint not null default nextval('nnmo1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."notion" (
    "id" bigint not null default nextval('notion_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."notion" enable row level security;

create table "public"."pet__pets" (
    "id" bigint not null default nextval('pet__pets_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."pierreme12" (
    "id" bigint not null default nextval('pierreme12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."pierreme123" (
    "id" bigint not null default nextval('pierreme123_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."primelee1" (
    "id" bigint not null default nextval('primelee1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."profiles" (
    "id" uuid not null,
    "email" text,
    "full_name" text,
    "avatar_url" text,
    "created_at" timestamp with time zone default now(),
    "updated_at" timestamp with time zone default now()
);


alter table "public"."profiles" enable row level security;

create table "public"."proque" (
    "id" bigint not null default nextval('proque_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."proton" (
    "id" bigint not null default nextval('proton_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."proton" enable row level security;

create table "public"."sadhana_forest" (
    "id" bigint not null default nextval('sadhana_forest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."saldo" (
    "id" bigint not null default nextval('saldo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."saldo" enable row level security;

create table "public"."story" (
    "id" bigint not null default nextval('story_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


alter table "public"."story" enable row level security;

create table "public"."teplate" (
    "id" bigint not null default nextval('teplate_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tesi" (
    "id" bigint not null default nextval('tesi_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test12345" (
    "id" bigint not null default nextval('test12345_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test1t" (
    "id" bigint not null default nextval('test1t_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test5" (
    "id" bigint not null default nextval('test5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test6_gmail_com" (
    "id" bigint not null default nextval('test6_gmail_com_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test7" (
    "id" bigint not null default nextval('test7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_98" (
    "id" bigint not null default nextval('test_98_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_agent_1741894950" (
    "id" bigint not null default nextval('test_agent_1741894950_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_agent_1741895003" (
    "id" bigint not null default nextval('test_agent_1741895003_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."test_xyt7ti" (
    "id" bigint not null default nextval('test_xyt7ti_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testa" (
    "id" bigint not null default nextval('testa_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testab" (
    "id" bigint not null default nextval('testab_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testac" (
    "id" bigint not null default nextval('testac_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testad" (
    "id" bigint not null default nextval('testad_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagen6" (
    "id" bigint not null default nextval('testagen6_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent" (
    "id" bigint not null default nextval('testagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent1" (
    "id" bigint not null default nextval('testagent1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent4" (
    "id" bigint not null default nextval('testagent4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent5" (
    "id" bigint not null default nextval('testagent5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent7" (
    "id" bigint not null default nextval('testagent7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testagent8" (
    "id" bigint not null default nextval('testagent8_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testb" (
    "id" bigint not null default nextval('testb_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testc" (
    "id" bigint not null default nextval('testc_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient11" (
    "id" bigint not null default nextval('testclient11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient12" (
    "id" bigint not null default nextval('testclient12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient3" (
    "id" bigint not null default nextval('testclient3_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient4" (
    "id" bigint not null default nextval('testclient4_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testclient5" (
    "id" bigint not null default nextval('testclient5_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testd" (
    "id" bigint not null default nextval('testd_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."teste" (
    "id" bigint not null default nextval('teste_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest" (
    "id" bigint not null default nextval('testest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest1" (
    "id" bigint not null default nextval('testest1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testest12" (
    "id" bigint not null default nextval('testest12_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testf" (
    "id" bigint not null default nextval('testf_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testg" (
    "id" bigint not null default nextval('testg_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testglas" (
    "id" bigint not null default nextval('testglas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testh" (
    "id" bigint not null default nextval('testh_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testheagent" (
    "id" bigint not null default nextval('testheagent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testit" (
    "id" bigint not null default nextval('testit_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testj" (
    "id" bigint not null default nextval('testj_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testk" (
    "id" bigint not null default nextval('testk_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testl" (
    "id" bigint not null default nextval('testl_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testm" (
    "id" bigint not null default nextval('testm_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testme1234" (
    "id" bigint not null default nextval('testme1234_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testn" (
    "id" bigint not null default nextval('testn_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testo" (
    "id" bigint not null default nextval('testo_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testp" (
    "id" bigint not null default nextval('testp_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testq" (
    "id" bigint not null default nextval('testq_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testr" (
    "id" bigint not null default nextval('testr_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."tests" (
    "id" bigint not null default nextval('tests_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testt" (
    "id" bigint not null default nextval('testt_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testu" (
    "id" bigint not null default nextval('testu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testv" (
    "id" bigint not null default nextval('testv_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."testw" (
    "id" bigint not null default nextval('testw_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."the_agent" (
    "id" bigint not null default nextval('the_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."thetest" (
    "id" bigint not null default nextval('thetest_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."upwork" (
    "id" bigint not null default nextval('upwork_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vahalas" (
    "id" bigint not null default nextval('vahalas_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value1" (
    "id" bigint not null default nextval('value1_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value10" (
    "id" bigint not null default nextval('value10_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value11" (
    "id" bigint not null default nextval('value11_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value2" (
    "id" bigint not null default nextval('value2_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value6" (
    "id" bigint not null default nextval('value6_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value7" (
    "id" bigint not null default nextval('value7_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value8" (
    "id" bigint not null default nextval('value8_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."value9" (
    "id" bigint not null default nextval('value9_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vidgu" (
    "id" bigint not null default nextval('vidgu_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vladd2a" (
    "id" bigint not null default nextval('vladd2a_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."vlooh" (
    "id" bigint not null default nextval('vlooh_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."voigai" (
    "id" bigint not null default nextval('voigai_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."website_urls" (
    "id" integer not null default nextval('website_urls_id_seq'::regclass),
    "client_id" uuid not null,
    "url" text not null,
    "refresh_rate" integer not null default 30,
    "created_at" timestamp without time zone default CURRENT_TIMESTAMP,
    "notified_at" timestamp with time zone,
    "last_crawled" timestamp with time zone,
    "status" text
);


create table "public"."wechate" (
    "id" bigint not null default nextval('wechate_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


create table "public"."your_agent" (
    "id" bigint not null default nextval('your_agent_id_seq'::regclass),
    "content" text,
    "metadata" jsonb,
    "embedding" vector(1536)
);


drop type "public"."activity_type_enum__old_version_to_be_dropped";

alter table "public"."ai_agents" drop column "chunk_index";

alter table "public"."ai_agents" drop column "chunk_metadata";

alter table "public"."ai_agents" drop column "total_chunks";

alter table "public"."ai_agents" add column "ai_prompt" text;

alter table "public"."ai_agents" add column "assistant_id" text;

alter table "public"."ai_agents" add column "company" text;

alter table "public"."ai_agents" add column "deleted_at" timestamp with time zone;

alter table "public"."ai_agents" add column "deletion_scheduled_at" timestamp with time zone;

alter table "public"."ai_agents" add column "description" text;

alter table "public"."ai_agents" add column "drive_link" text;

alter table "public"."ai_agents" add column "drive_link_added_at" timestamp with time zone;

alter table "public"."ai_agents" add column "drive_link_refresh_rate" integer default 30;

alter table "public"."ai_agents" add column "drive_urls" text[] default '{}'::text[];

alter table "public"."ai_agents" add column "last_active" timestamp with time zone;

alter table "public"."ai_agents" add column "metadata" jsonb default '{}'::jsonb;

alter table "public"."ai_agents" add column "size" integer;

alter table "public"."ai_agents" add column "status" text default 'active'::text;

alter table "public"."ai_agents" add column "type" text;

alter table "public"."ai_agents" add column "uploadDate" timestamp with time zone;

alter table "public"."ai_agents" add column "urls" text[] default '{}'::text[];

alter table "public"."ai_agents" add column "website_url_refresh_rate" integer default 30;

alter table "public"."ai_agents" alter column "created_at" set default now();

alter table "public"."ai_agents" alter column "openai_assistant_id" set data type character varying(255) using "openai_assistant_id"::character varying(255);

alter table "public"."ai_agents" alter column "updated_at" set default now();

alter table "public"."client_activities" alter column "activity_type" set data type activity_type_enum using "activity_type"::activity_type_enum;

alter table "public"."client_activities" alter column "created_at" set default now();

alter table "public"."client_activities" alter column "description" set not null;

alter table "public"."client_recovery_tokens" alter column "client_id" drop not null;

alter table "public"."client_recovery_tokens" alter column "id" set default gen_random_uuid();

alter table "public"."client_recovery_tokens" disable row level security;

alter table "public"."client_temp_passwords" drop column "expires_at";

alter table "public"."client_temp_passwords" add column "used" boolean default false;

alter table "public"."document_processing_jobs" add column "content" text;

alter table "public"."document_processing_jobs" add column "error_message" text;

alter table "public"."document_processing_jobs" alter column "agent_name" set not null;

alter table "public"."document_processing_jobs" alter column "client_id" set not null;

alter table "public"."document_processing_jobs" alter column "created_at" set default now();

alter table "public"."document_processing_jobs" alter column "created_at" set not null;

alter table "public"."document_processing_jobs" alter column "document_id" set not null;

alter table "public"."document_processing_jobs" alter column "processing_method" drop not null;

alter table "public"."document_processing_jobs" alter column "updated_at" set default now();

alter table "public"."document_processing_jobs" alter column "updated_at" set not null;

alter table "public"."user_roles" drop column "updated_at";

alter table "public"."user_roles" add column "client_id" uuid;

alter table "public"."user_roles" alter column "role" set data type app_role using "role"::app_role;

alter sequence "public"."agent_1742397281528_id_seq" owned by "public"."agent_1742397281528"."id";

alter sequence "public"."agent_1742425072029_id_seq" owned by "public"."agent_1742425072029"."id";

alter sequence "public"."agent_1742426304880_id_seq" owned by "public"."agent_1742426304880"."id";

alter sequence "public"."ai_agent_id_seq" owned by "public"."ai_agent"."id";

alter sequence "public"."airtable_id_seq" owned by "public"."airtable"."id";

alter sequence "public"."asd_id_seq" owned by "public"."asd"."id";

alter sequence "public"."ask_parent_handbook_id_seq" owned by "public"."ask_parent_handbook"."id";

alter sequence "public"."buffalo_school_board_id_seq" owned by "public"."buffalo_school_board"."id";

alter sequence "public"."byclicks_id_seq" owned by "public"."byclicks"."id";

alter sequence "public"."cc_id_seq" owned by "public"."cc"."id";

alter sequence "public"."client_3_id_seq" owned by "public"."client_3"."id";

alter sequence "public"."coca_cola_id_seq" owned by "public"."coca_cola"."id";

alter sequence "public"."coins_id_seq" owned by "public"."coins"."id";

alter sequence "public"."deals_id_seq" owned by "public"."deals"."id";

alter sequence "public"."digicel_id_seq" owned by "public"."digicel"."id";

alter sequence "public"."document_links_id_seq" owned by "public"."document_links"."id";

alter sequence "public"."frenniy_id_seq" owned by "public"."frenniy"."id";

alter sequence "public"."g_g_id_seq" owned by "public"."g_g"."id";

alter sequence "public"."gaiivo_id_seq" owned by "public"."gaiivo"."id";

alter sequence "public"."glouglu_id_seq" owned by "public"."glouglu"."id";

alter sequence "public"."google_drive_links_id_seq" owned by "public"."google_drive_links"."id";

alter sequence "public"."great_deal_id_seq" owned by "public"."great_deal"."id";

alter sequence "public"."imanye_3_id_seq" owned by "public"."imanye_3"."id";

alter sequence "public"."llama11_id_seq" owned by "public"."llama11"."id";

alter sequence "public"."llama1_id_seq" owned by "public"."llama1"."id";

alter sequence "public"."llama3_id_seq" owned by "public"."llama3"."id";

alter sequence "public"."llama4_id_seq" owned by "public"."llama4"."id";

alter sequence "public"."llama5_id_seq" owned by "public"."llama5"."id";

alter sequence "public"."llama7_id_seq" owned by "public"."llama7"."id";

alter sequence "public"."llama9_id_seq" owned by "public"."llama9"."id";

alter sequence "public"."mailer_id_seq" owned by "public"."mailer"."id";

alter sequence "public"."manyel_2_id_seq" owned by "public"."manyel_2"."id";

alter sequence "public"."metricool_id_seq" owned by "public"."metricool"."id";

alter sequence "public"."n8n123_id_seq" owned by "public"."n8n123"."id";

alter sequence "public"."n8n_chat_histories_id_seq" owned by "public"."n8n_chat_histories"."id";

alter sequence "public"."n8n_id_seq" owned by "public"."n8n"."id";

alter sequence "public"."neem_25_id_seq" owned by "public"."neem_25"."id";

alter sequence "public"."news_2_id_seq" owned by "public"."news_2"."id";

alter sequence "public"."news_3_id_seq" owned by "public"."news_3"."id";

alter sequence "public"."news_4_id_seq" owned by "public"."news_4"."id";

alter sequence "public"."news_5_id_seq" owned by "public"."news_5"."id";

alter sequence "public"."news_id_seq" owned by "public"."news"."id";

alter sequence "public"."news_one_id_seq" owned by "public"."news_one"."id";

alter sequence "public"."nnmo1_id_seq" owned by "public"."nnmo1"."id";

alter sequence "public"."notion_id_seq" owned by "public"."notion"."id";

alter sequence "public"."pet__pets_id_seq" owned by "public"."pet__pets"."id";

alter sequence "public"."pierreme123_id_seq" owned by "public"."pierreme123"."id";

alter sequence "public"."pierreme12_id_seq" owned by "public"."pierreme12"."id";

alter sequence "public"."primelee1_id_seq" owned by "public"."primelee1"."id";

alter sequence "public"."proque_id_seq" owned by "public"."proque"."id";

alter sequence "public"."proton_id_seq" owned by "public"."proton"."id";

alter sequence "public"."sadhana_forest_id_seq" owned by "public"."sadhana_forest"."id";

alter sequence "public"."saldo_id_seq" owned by "public"."saldo"."id";

alter sequence "public"."story_id_seq" owned by "public"."story"."id";

alter sequence "public"."teplate_id_seq" owned by "public"."teplate"."id";

alter sequence "public"."tesi_id_seq" owned by "public"."tesi"."id";

alter sequence "public"."test12345_id_seq" owned by "public"."test12345"."id";

alter sequence "public"."test1t_id_seq" owned by "public"."test1t"."id";

alter sequence "public"."test5_id_seq" owned by "public"."test5"."id";

alter sequence "public"."test6_gmail_com_id_seq" owned by "public"."test6_gmail_com"."id";

alter sequence "public"."test7_id_seq" owned by "public"."test7"."id";

alter sequence "public"."test_98_id_seq" owned by "public"."test_98"."id";

alter sequence "public"."test_agent_1741894950_id_seq" owned by "public"."test_agent_1741894950"."id";

alter sequence "public"."test_agent_1741895003_id_seq" owned by "public"."test_agent_1741895003"."id";

alter sequence "public"."test_xyt7ti_id_seq" owned by "public"."test_xyt7ti"."id";

alter sequence "public"."testa_id_seq" owned by "public"."testa"."id";

alter sequence "public"."testab_id_seq" owned by "public"."testab"."id";

alter sequence "public"."testac_id_seq" owned by "public"."testac"."id";

alter sequence "public"."testad_id_seq" owned by "public"."testad"."id";

alter sequence "public"."testagen6_id_seq" owned by "public"."testagen6"."id";

alter sequence "public"."testagent1_id_seq" owned by "public"."testagent1"."id";

alter sequence "public"."testagent4_id_seq" owned by "public"."testagent4"."id";

alter sequence "public"."testagent5_id_seq" owned by "public"."testagent5"."id";

alter sequence "public"."testagent7_id_seq" owned by "public"."testagent7"."id";

alter sequence "public"."testagent8_id_seq" owned by "public"."testagent8"."id";

alter sequence "public"."testagent_id_seq" owned by "public"."testagent"."id";

alter sequence "public"."testb_id_seq" owned by "public"."testb"."id";

alter sequence "public"."testc_id_seq" owned by "public"."testc"."id";

alter sequence "public"."testclient11_id_seq" owned by "public"."testclient11"."id";

alter sequence "public"."testclient12_id_seq" owned by "public"."testclient12"."id";

alter sequence "public"."testclient3_id_seq" owned by "public"."testclient3"."id";

alter sequence "public"."testclient4_id_seq" owned by "public"."testclient4"."id";

alter sequence "public"."testclient5_id_seq" owned by "public"."testclient5"."id";

alter sequence "public"."testd_id_seq" owned by "public"."testd"."id";

alter sequence "public"."teste_id_seq" owned by "public"."teste"."id";

alter sequence "public"."testest12_id_seq" owned by "public"."testest12"."id";

alter sequence "public"."testest1_id_seq" owned by "public"."testest1"."id";

alter sequence "public"."testest_id_seq" owned by "public"."testest"."id";

alter sequence "public"."testf_id_seq" owned by "public"."testf"."id";

alter sequence "public"."testg_id_seq" owned by "public"."testg"."id";

alter sequence "public"."testglas_id_seq" owned by "public"."testglas"."id";

alter sequence "public"."testh_id_seq" owned by "public"."testh"."id";

alter sequence "public"."testheagent_id_seq" owned by "public"."testheagent"."id";

alter sequence "public"."testit_id_seq" owned by "public"."testit"."id";

alter sequence "public"."testj_id_seq" owned by "public"."testj"."id";

alter sequence "public"."testk_id_seq" owned by "public"."testk"."id";

alter sequence "public"."testl_id_seq" owned by "public"."testl"."id";

alter sequence "public"."testm_id_seq" owned by "public"."testm"."id";

alter sequence "public"."testme1234_id_seq" owned by "public"."testme1234"."id";

alter sequence "public"."testn_id_seq" owned by "public"."testn"."id";

alter sequence "public"."testo_id_seq" owned by "public"."testo"."id";

alter sequence "public"."testp_id_seq" owned by "public"."testp"."id";

alter sequence "public"."testq_id_seq" owned by "public"."testq"."id";

alter sequence "public"."testr_id_seq" owned by "public"."testr"."id";

alter sequence "public"."tests_id_seq" owned by "public"."tests"."id";

alter sequence "public"."testt_id_seq" owned by "public"."testt"."id";

alter sequence "public"."testu_id_seq" owned by "public"."testu"."id";

alter sequence "public"."testv_id_seq" owned by "public"."testv"."id";

alter sequence "public"."testw_id_seq" owned by "public"."testw"."id";

alter sequence "public"."the_agent_id_seq" owned by "public"."the_agent"."id";

alter sequence "public"."thetest_id_seq" owned by "public"."thetest"."id";

alter sequence "public"."upwork_id_seq" owned by "public"."upwork"."id";

alter sequence "public"."vahalas_id_seq" owned by "public"."vahalas"."id";

alter sequence "public"."value10_id_seq" owned by "public"."value10"."id";

alter sequence "public"."value11_id_seq" owned by "public"."value11"."id";

alter sequence "public"."value1_id_seq" owned by "public"."value1"."id";

alter sequence "public"."value2_id_seq" owned by "public"."value2"."id";

alter sequence "public"."value6_id_seq" owned by "public"."value6"."id";

alter sequence "public"."value7_id_seq" owned by "public"."value7"."id";

alter sequence "public"."value8_id_seq" owned by "public"."value8"."id";

alter sequence "public"."value9_id_seq" owned by "public"."value9"."id";

alter sequence "public"."vidgu_id_seq" owned by "public"."vidgu"."id";

alter sequence "public"."vladd2a_id_seq" owned by "public"."vladd2a"."id";

alter sequence "public"."vlooh_id_seq" owned by "public"."vlooh"."id";

alter sequence "public"."voigai_id_seq" owned by "public"."voigai"."id";

alter sequence "public"."website_urls_id_seq" owned by "public"."website_urls"."id";

alter sequence "public"."wechate_id_seq" owned by "public"."wechate"."id";

alter sequence "public"."your_agent_id_seq" owned by "public"."your_agent"."id";

drop sequence if exists "public"."document_processing_id_seq";

CREATE UNIQUE INDEX agent_1742397281528_pkey ON public.agent_1742397281528 USING btree (id);

CREATE UNIQUE INDEX agent_1742425072029_pkey ON public.agent_1742425072029 USING btree (id);

CREATE UNIQUE INDEX agent_1742426304880_pkey ON public.agent_1742426304880 USING btree (id);

CREATE UNIQUE INDEX ai_agent_pkey ON public.ai_agent USING btree (id);

CREATE UNIQUE INDEX ai_documents_pkey ON public.ai_documents USING btree (id);

CREATE UNIQUE INDEX ai_interactions_pkey ON public.ai_interactions USING btree (id);

CREATE UNIQUE INDEX airtable_pkey ON public.airtable USING btree (id);

CREATE UNIQUE INDEX asd_pkey ON public.asd USING btree (id);

CREATE UNIQUE INDEX ask_parent_handbook_pkey ON public.ask_parent_handbook USING btree (id);

CREATE UNIQUE INDEX buffalo_school_board_pkey ON public.buffalo_school_board USING btree (id);

CREATE UNIQUE INDEX byclicks_pkey ON public.byclicks USING btree (id);

CREATE UNIQUE INDEX cc_pkey ON public.cc USING btree (id);

CREATE UNIQUE INDEX client_3_pkey ON public.client_3 USING btree (id);

CREATE UNIQUE INDEX client_invitations_pkey ON public.client_invitations USING btree (id);

CREATE UNIQUE INDEX coca_cola_pkey ON public.coca_cola USING btree (id);

CREATE UNIQUE INDEX coins_pkey ON public.coins USING btree (id);

alter table "public"."common_queries" add constraint "common_queries_pkey" PRIMARY KEY using index "common_queries_pkey";

alter table "public"."deals" add constraint "deals_pkey" PRIMARY KEY using index "deals_pkey";

alter table "public"."digicel" add constraint "digicel_pkey" PRIMARY KEY using index "digicel_pkey";

alter table "public"."document_links" add constraint "document_links_pkey" PRIMARY KEY using index "document_links_pkey";

alter table "public"."email_logs" add constraint "email_logs_pkey" PRIMARY KEY using index "email_logs_pkey";

alter table "public"."error_logs" add constraint "error_logs_pkey" PRIMARY KEY using index "error_logs_pkey";

alter table "public"."frenniy" add constraint "frenniy_pkey" PRIMARY KEY using index "frenniy_pkey";

alter table "public"."g_g" add constraint "g_g_pkey" PRIMARY KEY using index "g_g_pkey";

alter table "public"."gaiivo" add constraint "gaiivo_pkey" PRIMARY KEY using index "gaiivo_pkey";

alter table "public"."glouglu" add constraint "glouglu_pkey" PRIMARY KEY using index "glouglu_pkey";

alter table "public"."google_drive_links" add constraint "google_drive_links_pkey" PRIMARY KEY using index "google_drive_links_pkey";

alter table "public"."great_deal" add constraint "great_deal_pkey" PRIMARY KEY using index "great_deal_pkey";

alter table "public"."imanye_3" add constraint "imanye_3_pkey" PRIMARY KEY using index "imanye_3_pkey";

alter table "public"."invitations" add constraint "invitations_pkey" PRIMARY KEY using index "invitations_pkey";

alter table "public"."llama1" add constraint "llama1_pkey" PRIMARY KEY using index "llama1_pkey";

alter table "public"."llama11" add constraint "llama11_pkey" PRIMARY KEY using index "llama11_pkey";

alter table "public"."llama3" add constraint "llama3_pkey" PRIMARY KEY using index "llama3_pkey";

alter table "public"."llama4" add constraint "llama4_pkey" PRIMARY KEY using index "llama4_pkey";

alter table "public"."llama5" add constraint "llama5_pkey" PRIMARY KEY using index "llama5_pkey";

alter table "public"."llama7" add constraint "llama7_pkey" PRIMARY KEY using index "llama7_pkey";

alter table "public"."llama9" add constraint "llama9_pkey" PRIMARY KEY using index "llama9_pkey";

alter table "public"."mailer" add constraint "mailer_pkey" PRIMARY KEY using index "mailer_pkey";

alter table "public"."manyel_2" add constraint "manyel_2_pkey" PRIMARY KEY using index "manyel_2_pkey";

alter table "public"."metricool" add constraint "metricool_pkey" PRIMARY KEY using index "metricool_pkey";

alter table "public"."n8n" add constraint "n8n_pkey" PRIMARY KEY using index "n8n_pkey";

alter table "public"."n8n123" add constraint "n8n123_pkey" PRIMARY KEY using index "n8n123_pkey";

alter table "public"."n8n_chat_histories" add constraint "n8n_chat_histories_pkey" PRIMARY KEY using index "n8n_chat_histories_pkey";

alter table "public"."neem_25" add constraint "neem_25_pkey" PRIMARY KEY using index "neem_25_pkey";

alter table "public"."news" add constraint "news_pkey" PRIMARY KEY using index "news_pkey";

alter table "public"."news_2" add constraint "news_2_pkey" PRIMARY KEY using index "news_2_pkey";

alter table "public"."news_3" add constraint "news_3_pkey" PRIMARY KEY using index "news_3_pkey";

alter table "public"."news_4" add constraint "news_4_pkey" PRIMARY KEY using index "news_4_pkey";

alter table "public"."news_5" add constraint "news_5_pkey" PRIMARY KEY using index "news_5_pkey";

alter table "public"."news_one" add constraint "news_one_pkey" PRIMARY KEY using index "news_one_pkey";

alter table "public"."nnmo1" add constraint "nnmo1_pkey" PRIMARY KEY using index "nnmo1_pkey";

alter table "public"."notion" add constraint "notion_pkey" PRIMARY KEY using index "notion_pkey";

alter table "public"."pet__pets" add constraint "pet__pets_pkey" PRIMARY KEY using index "pet__pets_pkey";

alter table "public"."pierreme12" add constraint "pierreme12_pkey" PRIMARY KEY using index "pierreme12_pkey";

alter table "public"."pierreme123" add constraint "pierreme123_pkey" PRIMARY KEY using index "pierreme123_pkey";

alter table "public"."primelee1" add constraint "primelee1_pkey" PRIMARY KEY using index "primelee1_pkey";

alter table "public"."profiles" add constraint "profiles_pkey" PRIMARY KEY using index "profiles_pkey";

alter table "public"."proque" add constraint "proque_pkey" PRIMARY KEY using index "proque_pkey";

alter table "public"."proton" add constraint "proton_pkey" PRIMARY KEY using index "proton_pkey";

alter table "public"."sadhana_forest" add constraint "sadhana_forest_pkey" PRIMARY KEY using index "sadhana_forest_pkey";

alter table "public"."saldo" add constraint "saldo_pkey" PRIMARY KEY using index "saldo_pkey";

alter table "public"."story" add constraint "story_pkey" PRIMARY KEY using index "story_pkey";

alter table "public"."teplate" add constraint "teplate_pkey" PRIMARY KEY using index "teplate_pkey";

alter table "public"."tesi" add constraint "tesi_pkey" PRIMARY KEY using index "tesi_pkey";

alter table "public"."test12345" add constraint "test12345_pkey" PRIMARY KEY using index "test12345_pkey";

alter table "public"."test1t" add constraint "test1t_pkey" PRIMARY KEY using index "test1t_pkey";

alter table "public"."test5" add constraint "test5_pkey" PRIMARY KEY using index "test5_pkey";

alter table "public"."test6_gmail_com" add constraint "test6_gmail_com_pkey" PRIMARY KEY using index "test6_gmail_com_pkey";

alter table "public"."test7" add constraint "test7_pkey" PRIMARY KEY using index "test7_pkey";

alter table "public"."test_98" add constraint "test_98_pkey" PRIMARY KEY using index "test_98_pkey";

alter table "public"."test_agent_1741894950" add constraint "test_agent_1741894950_pkey" PRIMARY KEY using index "test_agent_1741894950_pkey";

alter table "public"."test_agent_1741895003" add constraint "test_agent_1741895003_pkey" PRIMARY KEY using index "test_agent_1741895003_pkey";

alter table "public"."test_xyt7ti" add constraint "test_xyt7ti_pkey" PRIMARY KEY using index "test_xyt7ti_pkey";

alter table "public"."testa" add constraint "testa_pkey" PRIMARY KEY using index "testa_pkey";

alter table "public"."testab" add constraint "testab_pkey" PRIMARY KEY using index "testab_pkey";

alter table "public"."testac" add constraint "testac_pkey" PRIMARY KEY using index "testac_pkey";

alter table "public"."testad" add constraint "testad_pkey" PRIMARY KEY using index "testad_pkey";

alter table "public"."testagen6" add constraint "testagen6_pkey" PRIMARY KEY using index "testagen6_pkey";

alter table "public"."testagent" add constraint "testagent_pkey" PRIMARY KEY using index "testagent_pkey";

alter table "public"."testagent1" add constraint "testagent1_pkey" PRIMARY KEY using index "testagent1_pkey";

alter table "public"."testagent4" add constraint "testagent4_pkey" PRIMARY KEY using index "testagent4_pkey";

alter table "public"."testagent5" add constraint "testagent5_pkey" PRIMARY KEY using index "testagent5_pkey";

alter table "public"."testagent7" add constraint "testagent7_pkey" PRIMARY KEY using index "testagent7_pkey";

alter table "public"."testagent8" add constraint "testagent8_pkey" PRIMARY KEY using index "testagent8_pkey";

alter table "public"."testb" add constraint "testb_pkey" PRIMARY KEY using index "testb_pkey";

alter table "public"."testc" add constraint "testc_pkey" PRIMARY KEY using index "testc_pkey";

alter table "public"."testclient11" add constraint "testclient11_pkey" PRIMARY KEY using index "testclient11_pkey";

alter table "public"."testclient12" add constraint "testclient12_pkey" PRIMARY KEY using index "testclient12_pkey";

alter table "public"."testclient3" add constraint "testclient3_pkey" PRIMARY KEY using index "testclient3_pkey";

alter table "public"."testclient4" add constraint "testclient4_pkey" PRIMARY KEY using index "testclient4_pkey";

alter table "public"."testclient5" add constraint "testclient5_pkey" PRIMARY KEY using index "testclient5_pkey";

alter table "public"."testd" add constraint "testd_pkey" PRIMARY KEY using index "testd_pkey";

alter table "public"."teste" add constraint "teste_pkey" PRIMARY KEY using index "teste_pkey";

alter table "public"."testest" add constraint "testest_pkey" PRIMARY KEY using index "testest_pkey";

alter table "public"."testest1" add constraint "testest1_pkey" PRIMARY KEY using index "testest1_pkey";

alter table "public"."testest12" add constraint "testest12_pkey" PRIMARY KEY using index "testest12_pkey";

alter table "public"."testf" add constraint "testf_pkey" PRIMARY KEY using index "testf_pkey";

alter table "public"."testg" add constraint "testg_pkey" PRIMARY KEY using index "testg_pkey";

alter table "public"."testglas" add constraint "testglas_pkey" PRIMARY KEY using index "testglas_pkey";

alter table "public"."testh" add constraint "testh_pkey" PRIMARY KEY using index "testh_pkey";

alter table "public"."testheagent" add constraint "testheagent_pkey" PRIMARY KEY using index "testheagent_pkey";

alter table "public"."testit" add constraint "testit_pkey" PRIMARY KEY using index "testit_pkey";

alter table "public"."testj" add constraint "testj_pkey" PRIMARY KEY using index "testj_pkey";

alter table "public"."testk" add constraint "testk_pkey" PRIMARY KEY using index "testk_pkey";

alter table "public"."testl" add constraint "testl_pkey" PRIMARY KEY using index "testl_pkey";

alter table "public"."testm" add constraint "testm_pkey" PRIMARY KEY using index "testm_pkey";

alter table "public"."testme1234" add constraint "testme1234_pkey" PRIMARY KEY using index "testme1234_pkey";

alter table "public"."testn" add constraint "testn_pkey" PRIMARY KEY using index "testn_pkey";

alter table "public"."testo" add constraint "testo_pkey" PRIMARY KEY using index "testo_pkey";

alter table "public"."testp" add constraint "testp_pkey" PRIMARY KEY using index "testp_pkey";

alter table "public"."testq" add constraint "testq_pkey" PRIMARY KEY using index "testq_pkey";

alter table "public"."testr" add constraint "testr_pkey" PRIMARY KEY using index "testr_pkey";

alter table "public"."tests" add constraint "tests_pkey" PRIMARY KEY using index "tests_pkey";

alter table "public"."testt" add constraint "testt_pkey" PRIMARY KEY using index "testt_pkey";

alter table "public"."testu" add constraint "testu_pkey" PRIMARY KEY using index "testu_pkey";

alter table "public"."testv" add constraint "testv_pkey" PRIMARY KEY using index "testv_pkey";

alter table "public"."testw" add constraint "testw_pkey" PRIMARY KEY using index "testw_pkey";

alter table "public"."the_agent" add constraint "the_agent_pkey" PRIMARY KEY using index "the_agent_pkey";

alter table "public"."thetest" add constraint "thetest_pkey" PRIMARY KEY using index "thetest_pkey";

alter table "public"."upwork" add constraint "upwork_pkey" PRIMARY KEY using index "upwork_pkey";

alter table "public"."vahalas" add constraint "vahalas_pkey" PRIMARY KEY using index "vahalas_pkey";

alter table "public"."value1" add constraint "value1_pkey" PRIMARY KEY using index "value1_pkey";

alter table "public"."value10" add constraint "value10_pkey" PRIMARY KEY using index "value10_pkey";

alter table "public"."value11" add constraint "value11_pkey" PRIMARY KEY using index "value11_pkey";

alter table "public"."value2" add constraint "value2_pkey" PRIMARY KEY using index "value2_pkey";

alter table "public"."value6" add constraint "value6_pkey" PRIMARY KEY using index "value6_pkey";

alter table "public"."value7" add constraint "value7_pkey" PRIMARY KEY using index "value7_pkey";

alter table "public"."value8" add constraint "value8_pkey" PRIMARY KEY using index "value8_pkey";

alter table "public"."value9" add constraint "value9_pkey" PRIMARY KEY using index "value9_pkey";

alter table "public"."vidgu" add constraint "vidgu_pkey" PRIMARY KEY using index "vidgu_pkey";

alter table "public"."vladd2a" add constraint "vladd2a_pkey" PRIMARY KEY using index "vladd2a_pkey";

alter table "public"."vlooh" add constraint "vlooh_pkey" PRIMARY KEY using index "vlooh_pkey";

alter table "public"."voigai" add constraint "voigai_pkey" PRIMARY KEY using index "voigai_pkey";

alter table "public"."website_urls" add constraint "website_urls_pkey" PRIMARY KEY using index "website_urls_pkey";

alter table "public"."wechate" add constraint "wechate_pkey" PRIMARY KEY using index "wechate_pkey";

alter table "public"."your_agent" add constraint "your_agent_pkey" PRIMARY KEY using index "your_agent_pkey";

alter table "public"."ai_documents" add constraint "ai_documents_client_id_fkey" FOREIGN KEY (client_id) REFERENCES ai_agents(id) ON DELETE CASCADE not valid;

alter table "public"."ai_documents" validate constraint "ai_documents_client_id_fkey";

alter table "public"."ai_interactions" add constraint "ai_interactions_client_id_fkey" FOREIGN KEY (client_id) REFERENCES ai_agents(id) ON DELETE CASCADE not valid;

alter table "public"."ai_interactions" validate constraint "ai_interactions_client_id_fkey";

alter table "public"."document_links" add constraint "document_links_client_id_fkey" FOREIGN KEY (client_id) REFERENCES ai_agents(id) ON DELETE CASCADE not valid;

alter table "public"."document_links" validate constraint "document_links_client_id_fkey";

alter table "public"."document_processing_jobs" add constraint "valid_processing_method" CHECK ((processing_method = ANY (ARRAY['llamaparse'::text, 'firecrawl'::text]))) not valid;

alter table "public"."document_processing_jobs" validate constraint "valid_processing_method";

alter table "public"."invitations" add constraint "fk_created_by" FOREIGN KEY (created_by) REFERENCES auth.users(id) ON DELETE CASCADE not valid;

alter table "public"."invitations" validate constraint "fk_created_by";

alter table "public"."invitations" add constraint "invitations_role_type_check" CHECK ((role_type = ANY (ARRAY['admin'::text, 'client'::text]))) not valid;

alter table "public"."invitations" validate constraint "invitations_role_type_check";

alter table "public"."invitations" add constraint "invitations_token_key" UNIQUE using index "invitations_token_key";

alter table "public"."profiles" add constraint "profiles_id_fkey" FOREIGN KEY (id) REFERENCES auth.users(id) ON DELETE CASCADE not valid;

alter table "public"."profiles" validate constraint "profiles_id_fkey";

alter table "public"."user_roles" add constraint "user_roles_user_id_role_key" UNIQUE using index "user_roles_user_id_role_key";

alter table "public"."user_roles" add constraint "user_roles_user_id_unique" UNIQUE using index "user_roles_user_id_unique";

set check_function_bodies = off;

CREATE OR REPLACE FUNCTION public.accept_invitation(token_param text, accepting_user_id uuid)
 RETURNS text
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    invite_record invitations%ROWTYPE;
BEGIN
    SELECT * INTO invite_record
    FROM invitations
    WHERE token = token_param
    AND status = 'pending'
    AND expires_at > now()
    FOR UPDATE;

    IF NOT FOUND THEN
        RAISE EXCEPTION 'Invalid or expired invitation';
    END IF;

    UPDATE invitations
    SET status = 'accepted',
        accepted_at = now()
    WHERE token = token_param;

    INSERT INTO user_roles (user_id, role)
    VALUES (accepting_user_id, invite_record.role_type::app_role);

    RETURN invite_record.role_type;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.audit_agent_names()
 RETURNS TABLE(client_id uuid, client_name text, client_agent_name text, ai_agent_name text, record_count bigint)
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN QUERY
    SELECT 
        c.id as client_id,
        c.client_name,
        c.agent_name as client_agent_name,
        a.name as ai_agent_name,
        COUNT(a.id) as record_count
    FROM
        clients c
    LEFT JOIN
        ai_agents a ON c.id = a.client_id
    WHERE
        c.agent_name IS NOT NULL
        AND a.id IS NOT NULL
        AND c.agent_name <> a.name
    GROUP BY
        c.id, c.client_name, c.agent_name, a.name
    ORDER BY
        record_count DESC;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.check_and_notify_new_urls()
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    website_urls_cursor CURSOR FOR 
        SELECT wu.id, wu.url, wu.client_id, c.client_name
        FROM website_urls wu
        JOIN clients c ON wu.client_id = c.id
        WHERE wu.notified_at IS NULL
        ORDER BY wu.created_at DESC;
    
    drive_links_cursor CURSOR FOR 
        SELECT dl.id, dl.link, dl.client_id, c.client_name
        FROM google_drive_links dl
        JOIN clients c ON dl.client_id = c.id
        WHERE dl.notified_at IS NULL
        ORDER BY dl.created_at DESC;
    
    url_record RECORD;
    result_data JSONB;
BEGIN
    -- Process website URLs
    FOR url_record IN website_urls_cursor LOOP
        -- Send to webhook
        SELECT 
            content::jsonb AS response_data
        INTO result_data
        FROM net.http_post(
            url:='https://primary-production-1029c.up.railway.app/webhook/chatbots',
            headers:=jsonb_build_object(
                'Content-Type', 'application/json'
            ),
            body:=jsonb_build_object(
                'id', url_record.id,
                'url', url_record.url,
                'client_id', url_record.client_id,
                'client_name', url_record.client_name,
                'source_type', 'website_url',
                'created_at', now()
            )
        );
        
        -- Create activity record
        INSERT INTO client_activities (
            client_id,
            activity_type,
            description,
            metadata
        ) VALUES (
            url_record.client_id,
            'webhook_sent',
            'Website URL sent to webhook system',
            jsonb_build_object(
                'url', url_record.url,
                'webhook', 'chatbots',
                'response', result_data
            )
        );
        
        -- Update the URL as notified
        UPDATE website_urls
        SET notified_at = NOW()
        WHERE id = url_record.id;
        
        -- Log the action
        RAISE NOTICE 'Sent website URL % to webhook', url_record.url;
    END LOOP;
    
    -- Process Google Drive links
    FOR url_record IN drive_links_cursor LOOP
        -- Send to webhook
        SELECT 
            content::jsonb AS response_data
        INTO result_data
        FROM net.http_post(
            url:='https://primary-production-1029c.up.railway.app/webhook/01375bf5-770b-47cf-9a3b-5e14bd211d37',
            headers:=jsonb_build_object(
                'Content-Type', 'application/json'
            ),
            body:=jsonb_build_object(
                'id', url_record.id,
                'url', url_record.link,
                'client_id', url_record.client_id,
                'client_name', url_record.client_name,
                'source_type', 'google_drive',
                'created_at', now()
            )
        );
        
        -- Create activity record
        INSERT INTO client_activities (
            client_id,
            activity_type,
            description,
            metadata
        ) VALUES (
            url_record.client_id,
            'webhook_sent',
            'Google Drive link sent to webhook system',
            jsonb_build_object(
                'link', url_record.link,
                'webhook', 'google_drive',
                'response', result_data
            )
        );
        
        -- Update the link as notified
        UPDATE google_drive_links
        SET notified_at = NOW()
        WHERE id = url_record.id;
        
        -- Log the action
        RAISE NOTICE 'Sent Google Drive link % to webhook', url_record.link;
    END LOOP;

END;
$function$
;

CREATE OR REPLACE FUNCTION public.check_invitation_token(token_param text)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN EXISTS (
        SELECT 1 FROM invitations
        WHERE token = token_param
        AND status = 'pending'
        AND expires_at > now()
    );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.check_user_role(allowed_roles text[])
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
 SET search_path TO 'public'
AS $function$
BEGIN
    RETURN EXISTS (
        SELECT 1
        FROM user_roles
        WHERE user_id = auth.uid()
        AND role::text = ANY(allowed_roles)
    );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.create_ai_agent_on_client_create()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  INSERT INTO public.ai_agents (
    client_id,
    name,
    description
  ) VALUES (
    NEW.id,
    COALESCE(NEW.agent_name, 'AI Assistant'),
    NEW.widget_settings->>'agent_description'
  );
  
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.create_chatbot_embeddings_table(chatbot_name text)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Create the embeddings table
    EXECUTE format('
        CREATE TABLE IF NOT EXISTS %I (
            id bigserial primary key,
            content text,
            metadata jsonb,
            embedding vector(1536)
        )', chatbot_name);
        
    -- Create the matching function
    EXECUTE format('
        CREATE OR REPLACE FUNCTION match_%I (
            query_embedding vector(1536),
            match_count int default null,
            filter jsonb DEFAULT ''{}'')
        RETURNS TABLE (
            id bigint,
            content text,
            metadata jsonb,
            similarity float
        )
        LANGUAGE plpgsql
        AS $func$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (%I.embedding <=> query_embedding) as similarity
            FROM %I
            WHERE metadata @> filter
            ORDER BY %I.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $func$', chatbot_name, chatbot_name, chatbot_name, chatbot_name);
END;
$function$
;

CREATE OR REPLACE FUNCTION public.create_chatbot_table(table_name text)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Create the documents table with chatbot name
    EXECUTE format('
        CREATE TABLE IF NOT EXISTS %I (
            id bigserial primary key,
            content text,
            metadata jsonb,
            embedding vector(1536)
        )', table_name);
        
    -- Create the matching function for the chatbot
    EXECUTE format('
        CREATE OR REPLACE FUNCTION match_%I (
            query_embedding vector(1536),
            match_count int default null,
            filter jsonb DEFAULT ''{}'')
        RETURNS TABLE (
            id bigint,
            content text,
            metadata jsonb,
            similarity float
        )
        LANGUAGE plpgsql
        AS $func$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (%I.embedding <=> query_embedding) as similarity
            FROM %I
            WHERE metadata @> filter
            ORDER BY %I.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $func$', table_name, table_name, table_name, table_name);
END;
$function$
;

CREATE OR REPLACE FUNCTION public.create_new_client(p_client_name text, p_email text, p_agent_name text DEFAULT 'AI Assistant'::text, p_agent_description text DEFAULT NULL::text, p_logo_url text DEFAULT NULL::text, p_logo_storage_path text DEFAULT NULL::text, p_widget_settings jsonb DEFAULT '{}'::jsonb, p_status text DEFAULT 'active'::text)
 RETURNS uuid
 LANGUAGE plpgsql
AS $function$
DECLARE
  new_client_id UUID;
BEGIN
  -- Insert into clients table
  INSERT INTO clients (
    client_name,
    email,
    agent_name,
    agent_description,
    logo_url,
    logo_storage_path,
    widget_settings,
    status,
    created_at,
    updated_at
  ) VALUES (
    p_client_name,
    p_email,
    p_agent_name,
    p_agent_description,
    p_logo_url,
    p_logo_storage_path,
    p_widget_settings,
    p_status,
    NOW(),
    NOW()
  )
  RETURNING id INTO new_client_id;
  
  -- Insert into ai_agents table
  INSERT INTO ai_agents (
    client_id,
    name,
    agent_description,
    content,
    interaction_type,
    settings,
    logo_url,
    logo_storage_path,
    created_at,
    updated_at
  ) VALUES (
    new_client_id,
    p_agent_name,
    p_agent_description,
    '',
    'config',
    jsonb_build_object(
      'agent_name', p_agent_name,
      'agent_description', p_agent_description,
      'client_name', p_client_name,
      'logo_url', p_logo_url,
      'logo_storage_path', p_logo_storage_path,
      'created_at', NOW()
    ),
    p_logo_url,
    p_logo_storage_path,
    NOW(),
    NOW()
  );
  
  -- Create activity log for client creation
  INSERT INTO client_activities (
    client_id,
    activity_type,
    description,
    metadata
  ) VALUES (
    new_client_id,
    'client_created',
    'New client created with AI agent: ' || p_agent_name,
    jsonb_build_object(
      'client_name', p_client_name,
      'agent_name', p_agent_name,
      'email', p_email
    )
  );
  
  RETURN new_client_id;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.create_new_client(p_client_name text, p_email text, p_agent_name text, p_widget_settings jsonb, p_status text, p_website_url_refresh_rate integer, p_drive_link_refresh_rate integer)
 RETURNS uuid
 LANGUAGE plpgsql
AS $function$
DECLARE
  new_client_id UUID;
BEGIN
  INSERT INTO clients (
    client_name,
    email,
    agent_name,
    widget_settings,
    status,
    website_url_refresh_rate,
    drive_link_refresh_rate,
    created_at,
    updated_at
  ) VALUES (
    p_client_name,
    p_email,
    p_agent_name,
    p_widget_settings,
    p_status,
    p_website_url_refresh_rate,
    p_drive_link_refresh_rate,
    NOW(),
    NOW()
  )
  RETURNING id INTO new_client_id;
  
  RETURN new_client_id;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.ensure_agent_name_consistency()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
  client_agent_name text;
BEGIN
  -- Find the agent_name from the client
  SELECT agent_name INTO client_agent_name
  FROM clients
  WHERE id = NEW.client_id;
  
  IF client_agent_name IS NOT NULL THEN
    -- Always use the client's agent_name for consistency
    NEW.name = client_agent_name;
  END IF;
  
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.exec_sql(sql_query text, query_params json DEFAULT NULL::json)
 RETURNS SETOF json
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
  result json;
  param_values text[];
BEGIN
  IF query_params IS NULL THEN
    -- Execute without parameters
    RETURN QUERY EXECUTE sql_query;
  ELSE
    -- Extract parameter values from json array
    SELECT array_agg(value::text ORDER BY ordinality)
    INTO param_values
    FROM json_array_elements(query_params) WITH ORDINALITY;
    
    -- Execute with parameters using array directly
    RETURN QUERY EXECUTE sql_query USING param_values;
  END IF;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.extract_google_drive_links(content text)
 RETURNS text[]
 LANGUAGE plpgsql
AS $function$
DECLARE
    drive_links text[];
BEGIN
    -- Match common Google Drive URL patterns
    drive_links := ARRAY(
        SELECT DISTINCT matches[1]
        FROM regexp_matches(
            content,
            'https://(?:drive|docs)\.google\.com/(?:file/d/|drive/folders/|open\?id=|document/d/|spreadsheets/d/|presentation/d/)([a-zA-Z0-9_-]+)',
            'g'
        ) AS matches
    );
    RETURN drive_links;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.fix_agent_name_mismatches()
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    -- Update ai_agents records to match client agent_name
    UPDATE public.ai_agents a
    SET name = c.agent_name
    FROM public.clients c
    WHERE a.client_id = c.id
        AND c.agent_name IS NOT NULL
        AND a.name <> c.agent_name;
    
    RAISE NOTICE 'Agent names synchronized between clients and ai_agents tables';
END;
$function$
;

CREATE OR REPLACE FUNCTION public.fix_agent_names()
 RETURNS TABLE(client_id uuid, client_name text, old_agent_name text, new_agent_name text, records_updated bigint)
 LANGUAGE plpgsql
AS $function$
DECLARE
  client_record RECORD;
  old_name text;
  records_count bigint;
BEGIN
  -- Loop through all clients with agent_name
  FOR client_record IN
    SELECT c.id, c.client_name, c.agent_name
    FROM clients c
    WHERE c.agent_name IS NOT NULL
  LOOP
    -- Get old agent name from ai_agents for logging purposes
    SELECT DISTINCT name INTO old_name
    FROM ai_agents a
    WHERE a.client_id = client_record.id
    AND a.name != client_record.agent_name
    LIMIT 1;
    
    -- If there's a mismatch, update the AI agents records
    IF old_name IS NOT NULL THEN
      -- Count how many records we'll update for this client
      SELECT COUNT(*) INTO records_count
      FROM ai_agents a
      WHERE a.client_id = client_record.id
      AND a.name != client_record.agent_name;
      
      -- Update all AI agent records for this client
      UPDATE ai_agents a
      SET name = client_record.agent_name
      WHERE a.client_id = client_record.id
      AND a.name != client_record.agent_name;
      
      -- Log the activity
      INSERT INTO client_activities (
        client_id,
        activity_type,
        description,
        metadata
      ) VALUES (
        client_record.id,
        'agent_name_updated',
        'Updated agent name from "' || old_name || '" to "' || client_record.agent_name || '"',
        jsonb_build_object(
          'old_name', old_name,
          'new_name', client_record.agent_name,
          'records_updated', records_count,
          'system_update', true
        )
      );
      
      -- Return result row
      client_id := client_record.id;
      client_name := client_record.client_name;
      old_agent_name := old_name;
      new_agent_name := client_record.agent_name;
      records_updated := records_count;
      RETURN NEXT;
    END IF;
  END LOOP;
  
  RETURN;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.fix_agent_quotes()
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  -- Update agent_name in clients table
  UPDATE clients
  SET agent_name = REPLACE(agent_name, '"', '''')
  WHERE agent_name LIKE '%"%';
  
  -- Update agent_description in widget_settings
  UPDATE clients
  SET widget_settings = jsonb_set(
    widget_settings, 
    '{agent_description}', 
    to_jsonb(REPLACE(widget_settings->>'agent_description', '"', '''')),
    true
  )
  WHERE widget_settings->>'agent_description' LIKE '%"%';
  
  -- Update name and agent_description in ai_agents table
  UPDATE ai_agents
  SET 
    name = REPLACE(name, '"', ''''),
    agent_description = REPLACE(agent_description, '"', '''')
  WHERE name LIKE '%"%' OR agent_description LIKE '%"%';
  
  -- Update ai_prompt in ai_agents table (which may contain agent names/descriptions)
  UPDATE ai_agents
  SET ai_prompt = REPLACE(ai_prompt, '"', '''')
  WHERE ai_prompt LIKE '%"%';

  -- Also update any JSON settings that might contain agent names/descriptions
  UPDATE ai_agents
  SET settings = jsonb_set(
    settings, 
    '{agent_description}', 
    to_jsonb(REPLACE(settings->>'agent_description', '"', '''')),
    true
  )
  WHERE settings->>'agent_description' LIKE '%"%';

  RAISE NOTICE 'Agent names and descriptions updated to replace double quotes with single quotes';
END;
$function$
;

CREATE OR REPLACE FUNCTION public.generate_logo_url()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    logo_url TEXT;
BEGIN
    -- Generate the public URL for the new logo using the uploaded file's name
    logo_url := 'https://mgjodiqecnnltsgorife.supabase.co/storage/v1/object/public/widget-logos/Logo%20URL/' || NEW.name;

    -- Log the generated logo URL (for debugging purposes)
    RAISE NOTICE 'Generated logo URL: %', logo_url;

    -- Here, we are no longer trying to upload the URL to Supabase storage.
    -- We're just generating the URL and can now save it anywhere you want (if needed).

    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_active_days(client_id_param uuid, agent_name_param text)
 RETURNS integer
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    active_days integer;
BEGIN
    SELECT COUNT(DISTINCT DATE(created_at))
    INTO active_days
    FROM ai_agents
    WHERE 
        client_id = client_id_param AND
        name = agent_name_param AND
        interaction_type = 'chat_interaction';
    
    RETURN active_days;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_active_days_count(client_id_param uuid)
 RETURNS integer
 LANGUAGE plpgsql
AS $function$
DECLARE
  active_days INTEGER;
BEGIN
  -- Count the number of distinct days where the client had chat interactions
  SELECT COUNT(DISTINCT DATE(created_at))
  INTO active_days
  FROM client_activities
  WHERE client_id = client_id_param
  AND activity_type = 'chat_interaction';
  
  RETURN COALESCE(active_days, 0);
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_agent_dashboard_stats(client_id_param uuid, agent_name_param text)
 RETURNS json
 LANGUAGE plpgsql
AS $function$
DECLARE
  total_interactions integer;
  active_days integer;
  avg_response_time numeric;
  top_queries json;
BEGIN
  -- Get total interactions
  SELECT COUNT(*) INTO total_interactions
  FROM ai_agents
  WHERE client_id = client_id_param
    AND name = agent_name_param
    AND interaction_type = 'chat_interaction'
    AND is_error = false;
    
  -- Get active days
  SELECT COUNT(DISTINCT DATE(created_at)) INTO active_days
  FROM ai_agents
  WHERE client_id = client_id_param
    AND name = agent_name_param
    AND interaction_type = 'chat_interaction';
    
  -- Get average response time
  SELECT COALESCE(AVG(response_time_ms)::numeric / 1000, 0) INTO avg_response_time
  FROM ai_agents
  WHERE client_id = client_id_param
    AND name = agent_name_param
    AND interaction_type = 'chat_interaction'
    AND response_time_ms IS NOT NULL;
    
  -- Get top queries
  SELECT json_agg(q) INTO top_queries
  FROM (
    SELECT query_text, COUNT(*) as frequency
    FROM ai_agents
    WHERE client_id = client_id_param
      AND name = agent_name_param
      AND interaction_type = 'chat_interaction'
      AND query_text IS NOT NULL
    GROUP BY query_text
    ORDER BY frequency DESC
    LIMIT 5
  ) q;
  
  -- Return stats as JSON
  RETURN json_build_object(
    'total_interactions', total_interactions,
    'active_days', active_days,
    'average_response_time', avg_response_time,
    'top_queries', COALESCE(top_queries, '[]'::json)
  );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_ai_interactions(client_id_param uuid, limit_param integer DEFAULT 20)
 RETURNS SETOF ai_interactions
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  RETURN QUERY
  SELECT *
  FROM ai_interactions
  WHERE client_id = client_id_param
  ORDER BY created_at DESC
  LIMIT limit_param;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_average_response_time(client_id_param uuid, agent_name_param text)
 RETURNS numeric
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    avg_time numeric;
BEGIN
    SELECT AVG(response_time_ms)::numeric / 1000
    INTO avg_time
    FROM ai_agents
    WHERE 
        client_id = client_id_param AND
        name = agent_name_param AND
        interaction_type = 'chat_interaction' AND
        response_time_ms IS NOT NULL;
    
    RETURN COALESCE(avg_time, 0);
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_chat_sessions_for_client(client_id_param uuid)
 RETURNS SETOF ai_interactions
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  RETURN QUERY
  SELECT *
  FROM ai_interactions
  WHERE client_id = client_id_param
  ORDER BY created_at DESC;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_common_queries(client_id_param uuid, agent_name_param text, limit_param integer)
 RETURNS TABLE(query_text text, frequency bigint)
 LANGUAGE plpgsql
AS $function$
BEGIN
  RETURN QUERY
  SELECT 
    a.query_text,
    COUNT(*) as frequency
  FROM ai_agents a
  WHERE 
    a.client_id = client_id_param
    AND (agent_name_param IS NULL OR a.name = agent_name_param)
    AND a.interaction_type = 'chat_interaction'
    AND a.query_text IS NOT NULL
  GROUP BY a.query_text
  ORDER BY frequency DESC
  LIMIT limit_param;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_document_access_status(document_id integer)
 RETURNS text
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  -- Return the access status for the document
  RETURN (
    SELECT access_status
    FROM document_links
    WHERE id = document_id
  );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_recent_error_logs(client_id_param uuid, agent_name_param text, limit_param integer DEFAULT 10)
 RETURNS TABLE(id uuid, error_type text, error_message text, error_status text, query_text text, created_at timestamp with time zone)
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN QUERY
    SELECT 
        a.id,
        a.error_type,
        a.error_message,
        a.error_status,
        a.query_text,
        a.created_at
    FROM ai_agents a
    WHERE 
        a.client_id = client_id_param AND
        a.name = agent_name_param AND
        a.is_error = true
    ORDER BY a.created_at DESC
    LIMIT limit_param;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_recent_interactions(client_id_param uuid, limit_param integer DEFAULT 5)
 RETURNS SETOF ai_interactions
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  RETURN QUERY
  SELECT *
  FROM ai_interactions
  WHERE client_id = client_id_param
  ORDER BY created_at DESC
  LIMIT limit_param;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.get_total_interactions(client_id_param uuid, agent_name_param text)
 RETURNS integer
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    total_count integer;
BEGIN
    SELECT COUNT(*)
    INTO total_count
    FROM ai_agents
    WHERE 
        client_id = client_id_param AND
        name = agent_name_param AND
        interaction_type = 'chat_interaction';
    
    RETURN total_count;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_agent_name_change()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF OLD.agent_name IS DISTINCT FROM NEW.agent_name THEN
    INSERT INTO client_activities (
      client_id,
      activity_type,
      description,
      metadata
    ) VALUES (
      NEW.id,
      'agent_name_updated',
      'Updated agent name from "' || COALESCE(OLD.agent_name, 'none') || '" to "' || NEW.agent_name || '"',
      jsonb_build_object(
        'old_value', OLD.agent_name,
        'new_value', NEW.agent_name
      )
    );
  END IF;
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_chatbot_update()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF OLD.name <> NEW.name THEN
    INSERT INTO client_activities (client_id, activity_type, description, metadata)
    VALUES (NEW.client_id, 'chatbot_updated', 'Changed chatbot name from "' || OLD.name || '" to "' || NEW.name || '"',
           jsonb_build_object('field', 'name', 'old_value', OLD.name, 'new_value', NEW.name, 'chatbot_id', NEW.id));
  END IF;

  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_client_creation()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  -- Create activity log entry
  INSERT INTO client_activities (
    client_id,
    activity_type,
    description,
    metadata
  ) VALUES (
    NEW.id,
    'client_created',
    'New client created with AI agent: ' || NEW.agent_name,
    jsonb_build_object(
      'agent_name', NEW.agent_name,
      'email', NEW.email
    )
  );
  
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_client_deletion()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    INSERT INTO client_activities (
        client_id,
        activity_type,
        description,
        metadata
    ) VALUES (
        OLD.id,
        'client_deleted',
        'Client scheduled for deletion',
        jsonb_build_object(
            'client_name', OLD.client_name,
            'scheduled_deletion_date', NEW.deletion_scheduled_at,
            'email', OLD.email
        )
    );
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_client_recovery()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    INSERT INTO client_activities (
        client_id,
        activity_type,
        description,
        metadata
    ) VALUES (
        NEW.id,
        'client_recovered',
        'Client recovered from deletion',
        jsonb_build_object(
            'client_name', NEW.client_name,
            'email', NEW.email
        )
    );
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_client_update()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF OLD.name <> NEW.name THEN
    INSERT INTO client_activities (client_id, activity_type, description, metadata)
    VALUES (NEW.id, 'client_updated', 'Changed client name from "' || OLD.name || '" to "' || NEW.name || '"',
           jsonb_build_object('field', 'name', 'old_value', OLD.name, 'new_value', NEW.name));
  END IF;

  IF (OLD.company IS NULL AND NEW.company IS NOT NULL) OR (OLD.company IS NOT NULL AND NEW.company <> OLD.company) THEN
    INSERT INTO client_activities (client_id, activity_type, description, metadata)
    VALUES (NEW.id, 'client_updated', 'Updated company from "' || COALESCE(OLD.company, 'none') || '" to "' || NEW.company || '"',
           jsonb_build_object('field', 'company', 'old_value', OLD.company, 'new_value', NEW.company));
  END IF;

  IF (OLD.email IS NULL AND NEW.email IS NOT NULL) OR (OLD.email IS NOT NULL AND NEW.email <> OLD.email) THEN
    INSERT INTO client_activities (client_id, activity_type, description, metadata)
    VALUES (NEW.id, 'client_updated', 'Updated email from "' || COALESCE(OLD.email, 'none') || '" to "' || NEW.email || '"',
           jsonb_build_object('field', 'email', 'old_value', OLD.email, 'new_value', NEW.email));
  END IF;

  IF (OLD.website IS NULL AND NEW.website IS NOT NULL) OR (OLD.website IS NOT NULL AND NEW.website <> OLD.website) THEN
    INSERT INTO client_activities (client_id, activity_type, description, metadata)
    VALUES (NEW.id, 'client_updated', 'Updated website from "' || COALESCE(OLD.website, 'none') || '" to "' || NEW.website || '"',
           jsonb_build_object('field', 'website', 'old_value', OLD.website, 'new_value', NEW.website));
  END IF;

  IF (OLD.description IS NULL AND NEW.description IS NOT NULL) OR (OLD.description IS NOT NULL AND NEW.description <> OLD.description) THEN
    INSERT INTO client_activities (client_id, activity_type, description, metadata)
    VALUES (NEW.id, 'client_updated', 'Updated client description',
           jsonb_build_object('field', 'description'));
  END IF;

  IF (OLD.agent_name IS NULL AND NEW.agent_name IS NOT NULL) OR 
     (OLD.agent_name IS NOT NULL AND NEW.agent_name <> OLD.agent_name) THEN
    INSERT INTO client_activities (client_id, activity_type, description, metadata)
    VALUES (NEW.id, 'client_updated', 'Updated agent name from "' || COALESCE(OLD.agent_name, 'none') || '" to "' || NEW.agent_name || '"',
           jsonb_build_object('field', 'agent_name', 'old_value', OLD.agent_name, 'new_value', NEW.agent_name));
  END IF;

  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_client_updates()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF OLD.email IS DISTINCT FROM NEW.email THEN
    INSERT INTO client_activities (
      client_id,
      activity_type,
      description,
      metadata
    ) VALUES (
      NEW.id,
      'client_updated',
      'Updated email from "' || COALESCE(OLD.email, 'none') || '" to "' || NEW.email || '"',
      jsonb_build_object(
        'field', 'email',
        'old_value', OLD.email,
        'new_value', NEW.email
      )
    );
  END IF;

  IF OLD.client_name IS DISTINCT FROM NEW.client_name THEN
    INSERT INTO client_activities (
      client_id,
      activity_type,
      description,
      metadata
    ) VALUES (
      NEW.id,
      'client_updated',
      'Updated client name from "' || COALESCE(OLD.client_name, 'none') || '" to "' || NEW.client_name || '"',
      jsonb_build_object(
        'field', 'client_name',
        'old_value', OLD.client_name,
        'new_value', NEW.client_name
      )
    );
  END IF;

  IF OLD.agent_name IS DISTINCT FROM NEW.agent_name THEN
    INSERT INTO client_activities (
      client_id,
      activity_type,
      description,
      metadata
    ) VALUES (
      NEW.id,
      'client_updated',
      'Updated agent name from "' || COALESCE(OLD.agent_name, 'none') || '" to "' || NEW.agent_name || '"',
      jsonb_build_object(
        'field', 'agent_name',
        'old_value', OLD.agent_name,
        'new_value', NEW.agent_name
      )
    );
  END IF;

  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_common_query_upsert()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Create activity when query frequency reaches certain thresholds
    IF NEW.frequency IN (10, 50, 100, 500, 1000) THEN
        INSERT INTO client_activities (
            client_id,
            activity_type,
            description,
            metadata
        ) VALUES (
            NEW.client_id,
            'common_query_milestone',
            'Query "' || substring(NEW.query_text, 1, 50) || '..." has been asked ' || NEW.frequency || ' times',
            jsonb_build_object(
                'query_text', NEW.query_text,
                'frequency', NEW.frequency
            )
        );
    END IF;

    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_drive_link_creation()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  INSERT INTO client_activities (
    client_id,
    activity_type,
    description,
    metadata
  ) VALUES (
    NEW.client_id,
    'drive_link_added',
    'Added Google Drive link: ' || NEW.link,
    jsonb_build_object(
      'link', NEW.link,
      'refresh_rate', NEW.refresh_rate
    )
  );
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_drive_link_deletion()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    INSERT INTO client_activities (
        client_id,
        activity_type,
        description,
        metadata
    ) VALUES (
        OLD.client_id,
        'drive_link_deleted',
        'Deleted Google Drive link: ' || OLD.link,
        jsonb_build_object(
            'link', OLD.link,
            'refresh_rate', OLD.refresh_rate
        )
    );
    RETURN OLD;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_error_log_insert()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Create activity for new error logs
    INSERT INTO client_activities (
        client_id,
        activity_type,
        description,
        metadata
    ) VALUES (
        NEW.client_id,
        'error_logged',
        'New error: ' || NEW.error_type || ' - ' || substring(NEW.message, 1, 100),
        jsonb_build_object(
            'error_type', NEW.error_type,
            'message', NEW.message,
            'status', NEW.status,
            'error_id', NEW.id
        )
    );

    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_interaction_insert()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    client_id uuid;
    current_month date;
BEGIN
    -- Get client_id from chatbot
    SELECT c.client_id INTO client_id
    FROM chatbots c
    WHERE c.id = NEW.chatbot_id;

    -- Get current month (truncated to first day)
    current_month := date_trunc('month', NEW.created_at)::date;

    -- Update or insert monthly usage
    INSERT INTO monthly_usage (client_id, month, total_interactions, unique_users)
    VALUES (
        client_id,
        current_month,
        1,
        1
    )
    ON CONFLICT (client_id, month)
    DO UPDATE SET
        total_interactions = monthly_usage.total_interactions + 1;

    -- Create activity record for milestone interactions (every 100)
    IF (SELECT total_interactions FROM monthly_usage 
        WHERE client_id = client_id AND month = current_month) % 100 = 0 THEN
        INSERT INTO client_activities (
            client_id,
            activity_type,
            description,
            metadata
        ) VALUES (
            client_id,
            'interaction_milestone',
            'Reached ' || (SELECT total_interactions FROM monthly_usage 
                          WHERE client_id = client_id AND month = current_month) || 
            ' interactions this month',
            jsonb_build_object(
                'month', current_month,
                'total_interactions', (SELECT total_interactions FROM monthly_usage 
                                     WHERE client_id = client_id AND month = current_month)
            )
        );
    END IF;

    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_new_chatbot()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Create the embeddings table for the new chatbot
    PERFORM create_chatbot_table(NEW.agent_name);
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_new_client_ai_agent()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  -- Log the creation to client_activities
  INSERT INTO client_activities (
    client_id,
    activity_type,
    description,
    metadata
  ) VALUES (
    NEW.id,
    'ai_agent_created',
    'Created AI agent: ' || NEW.agent_name,
    jsonb_build_object(
      'agent_name', NEW.agent_name
    )
  );
  
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_new_user()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
begin
  INSERT INTO public.user_roles (user_id, role)
  VALUES (new.id, 'client');
  
  return new;
end;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_source_creation()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  INSERT INTO client_activities (
    client_id,
    activity_type,
    description,
    metadata
  ) VALUES (
    NEW.client_id,
    'source_added',
    'Added ' || NEW.source_type || ' source: ' || NEW.url,
    jsonb_build_object(
      'source_type', NEW.source_type,
      'url', NEW.url,
      'refresh_rate', NEW.refresh_rate
    )
  );
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_source_deletion()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
begin
  -- Clear vector data
  update client_sources
  set content_vector = null,
      content_text = null,
      embedding_status = 'deleted',
      last_vectorized_at = now()
  where id = old.id;
  
  -- Log the deletion
  insert into client_activities (
    client_id,
    activity_type,
    description,
    metadata
  ) values (
    old.client_id,
    'source_deleted',
    'Deleted ' || old.source_type || ' source: ' || old.url,
    jsonb_build_object(
      'source_type', old.source_type,
      'url', old.url
    )
  );
  
  return old;
end;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_url_creation()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  INSERT INTO client_activities (
    client_id,
    activity_type,
    description,
    metadata
  ) VALUES (
    NEW.client_id,
    'website_url_added',
    'Added website URL: ' || NEW.url,
    jsonb_build_object(
      'url', NEW.url,
      'refresh_rate', NEW.refresh_rate
    )
  );
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_url_deletion()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Insert activity log specifically for website_urls
    INSERT INTO client_activities (
        client_id,
        activity_type,
        description,
        metadata
    ) VALUES (
        OLD.client_id,
        'url_deleted',
        'Deleted website URL: ' || OLD.url,
        jsonb_build_object(
            'url', OLD.url,
            'refresh_rate', OLD.refresh_rate
        )
    );
    
    RETURN OLD;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_url_source_deletion()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Simple logging of URL deletion
    INSERT INTO client_activities (
        client_id,
        activity_type,
        description,
        metadata
    ) VALUES (
        OLD.client_id,
        'url_deleted',
        'Website URL was deleted',
        jsonb_build_object('url', OLD.url)
    );
    RETURN OLD;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_widget_settings_changes()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF (OLD.widget_settings IS DISTINCT FROM NEW.widget_settings) THEN
    INSERT INTO client_activities (
      client_id,
      activity_type,
      description,
      metadata
    ) VALUES (
      NEW.id,
      'widget_settings_updated',
      'Updated widget settings',
      jsonb_build_object(
        'previous_settings', OLD.widget_settings,
        'new_settings', NEW.widget_settings
      )
    );
  END IF;
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.handle_widget_update()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  IF OLD.agent_name <> NEW.agent_name THEN
    INSERT INTO client_activities (client_id, activity_type, description, metadata)
    VALUES (NEW.client_id, 'widget_updated', 'Changed AI agent name from "' || OLD.agent_name || '" to "' || NEW.agent_name || '"',
           jsonb_build_object('field', 'agent_name', 'old_value', OLD.agent_name, 'new_value', NEW.agent_name));
  END IF;

  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.is_client_active(client_id uuid, check_time timestamp with time zone)
 RETURNS boolean
 LANGUAGE plpgsql
AS $function$
BEGIN
    RETURN EXISTS (
        SELECT 1
        FROM client_activities
        WHERE client_id = $1
        AND created_at >= (check_time - interval '48 hours')
        AND activity_type = 'chat_interaction'
    );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.is_invitation_valid(token text)
 RETURNS boolean
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN EXISTS (
        SELECT 1 FROM client_invitations
        WHERE client_invitations.token = token
        AND status = 'pending'
        AND expires_at > NOW()
    );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.log_agent_activity_to_client_activities()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Only track chat interactions and errors
    IF NEW.interaction_type IN ('chat_interaction', 'error') THEN
        -- Determine the activity type and description
        DECLARE
            activity_type text;
            description text;
            metadata_obj jsonb;
        BEGIN
            IF NEW.interaction_type = 'chat_interaction' THEN
                activity_type := 'chat_interaction';
                description := 'Chat interaction with agent: ' || NEW.name;
                metadata_obj := jsonb_build_object(
                    'agent_name', NEW.name,
                    'query', NEW.query_text,
                    'response_time_ms', NEW.response_time_ms
                );
            ELSE -- Error
                activity_type := 'agent_error';
                description := 'Error in agent: ' || NEW.name || ' - ' || COALESCE(NEW.error_type, 'unknown');
                metadata_obj := jsonb_build_object(
                    'agent_name', NEW.name,
                    'error_type', NEW.error_type,
                    'error_message', NEW.error_message
                );
            END IF;
            
            -- Log to client_activities
            INSERT INTO client_activities (
                client_id,
                activity_type,
                description,
                metadata
            ) VALUES (
                NEW.client_id,
                activity_type,
                description,
                metadata_obj
            );
        END;
    END IF;
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.log_agent_error(client_id_param uuid, agent_name_param text, error_type_param text, error_message_param text, query_text_param text DEFAULT NULL::text, settings_json jsonb DEFAULT '{}'::jsonb)
 RETURNS uuid
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    new_id uuid;
    agent_id uuid;
BEGIN
    -- Check if agent exists
    SELECT id INTO agent_id 
    FROM ai_agents 
    WHERE client_id = client_id_param AND name = agent_name_param
    LIMIT 1;
    
    -- If agent doesn't exist, create it
    IF agent_id IS NULL THEN
        INSERT INTO ai_agents (
            client_id,
            name,
            settings
        ) VALUES (
            client_id_param,
            agent_name_param,
            '{}'::jsonb
        )
        RETURNING id INTO agent_id;
    END IF;
    
    -- Enhance settings with error details
    settings_json := jsonb_set(
        jsonb_set(settings_json, '{type}', '"error"'),
        '{error_type}', to_jsonb(error_type_param)
    );
    
    -- Insert the error as a new record
    INSERT INTO ai_agents (
        client_id, 
        name, 
        content, 
        settings, 
        interaction_type,
        query_text,
        is_error,
        error_type,
        error_message,
        error_status
    )
    VALUES (
        client_id_param,
        agent_name_param,
        error_message_param,  -- Store error message in content
        settings_json,
        'error',
        query_text_param,
        true,
        error_type_param,
        error_message_param,
        'pending'
    )
    RETURNING id INTO new_id;
    
    RETURN new_id;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.log_agent_name_fix()
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  -- Log the change in client_activities
  INSERT INTO public.client_activities (
    client_id,
    activity_type,
    description,
    metadata
  )
  SELECT DISTINCT
    client_id,
    'client_updated'::activity_type_enum as activity_type,
    'Fixed AI agent naming to use exact names as entered by clients',
    jsonb_build_object(
      'migration_type', 'agent_name_exact_format',
      'migration_date', NOW(),
      'details', 'Removed automatic transformations of agent names'
    )
  FROM public.ai_agents
  WHERE client_id IN (SELECT id FROM public.clients);
  
  RAISE NOTICE 'Updated agent naming policy to use exact names as entered by clients';
END;
$function$
;

CREATE OR REPLACE FUNCTION public.log_ai_agent_creation()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  -- We've removed the call to create_ai_agent_table and changed the activity_type
  IF TG_OP = 'UPDATE' AND OLD.agent_name IS DISTINCT FROM NEW.agent_name THEN
    INSERT INTO client_activities (
      client_id,
      activity_type,
      description,
      metadata
    ) VALUES (
      NEW.id,
      'client_updated', -- Changed from 'ai_agent_updated' to a valid enum value
      'Updated AI agent from "' || OLD.agent_name || '" to "' || NEW.agent_name || '"',
      jsonb_build_object(
        'old_agent_name', OLD.agent_name,
        'new_agent_name', NEW.agent_name,
        'original_activity_type', 'ai_agent_updated'
      )
    );
  END IF;
  
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.log_chat_interaction(client_id_param uuid, agent_name_param text, query_text_param text, response_text_param text, response_time_ms_param integer, topic_param text DEFAULT NULL::text, sentiment_param text DEFAULT NULL::text, settings_json jsonb DEFAULT '{}'::jsonb)
 RETURNS uuid
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    new_id uuid;
    agent_id uuid;
BEGIN
    -- Check if agent exists
    SELECT id INTO agent_id 
    FROM ai_agents 
    WHERE client_id = client_id_param AND name = agent_name_param
    LIMIT 1;
    
    -- If agent doesn't exist, create it
    IF agent_id IS NULL THEN
        INSERT INTO ai_agents (
            client_id,
            name,
            settings
        ) VALUES (
            client_id_param,
            agent_name_param,
            '{}'::jsonb
        )
        RETURNING id INTO agent_id;
    END IF;
    
    -- Enhance settings with interaction details
    settings_json := jsonb_set(
        jsonb_set(
            jsonb_set(settings_json, '{type}', '"chat_interaction"'),
            '{query}', to_jsonb(query_text_param)
        ),
        '{response_time_ms}', to_jsonb(response_time_ms_param)
    );
    
    -- Insert the interaction as a new record
    INSERT INTO ai_agents (
        client_id, 
        name, 
        content, 
        settings, 
        interaction_type,
        query_text,
        response_time_ms,
        topic,
        sentiment
    )
    VALUES (
        client_id_param,
        agent_name_param,
        response_text_param,  -- Store response in content
        settings_json,
        'chat_interaction',
        query_text_param,
        response_time_ms_param,
        topic_param,
        sentiment_param
    )
    RETURNING id INTO new_id;
    
    RETURN new_id;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.log_client_activity(client_id_param uuid, activity_type_param text, description_param text, metadata_param jsonb DEFAULT '{}'::jsonb)
 RETURNS json
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
  new_activity_id uuid;
BEGIN
  -- Insert the activity record
  INSERT INTO client_activities (
    client_id,
    activity_type,
    description,
    metadata
  ) VALUES (
    client_id_param,
    activity_type_param::activity_type_enum,  -- Cast to the enum type
    description_param,
    metadata_param
  )
  RETURNING id INTO new_activity_id;
  
  -- Return success response
  RETURN json_build_object(
    'success', true,
    'activity_id', new_activity_id
  );
  
EXCEPTION WHEN OTHERS THEN
  -- Return error information
  RETURN json_build_object(
    'success', false,
    'error', SQLERRM,
    'error_detail', SQLSTATE
  );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.log_invitation_events()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    IF TG_OP = 'INSERT' THEN
        INSERT INTO client_activities (
            client_id,
            activity_type,
            description,
            metadata
        ) VALUES (
            NEW.client_id,
            'invitation_sent',
            'Invitation sent to ' || NEW.email,
            jsonb_build_object(
                'email', NEW.email,
                'expires_at', NEW.expires_at
            )
        );
    ELSIF TG_OP = 'UPDATE' AND NEW.status = 'accepted' THEN
        INSERT INTO client_activities (
            client_id,
            activity_type,
            description,
            metadata
        ) VALUES (
            NEW.client_id,
            'invitation_accepted',
            'Invitation accepted by ' || NEW.email,
            jsonb_build_object(
                'email', NEW.email,
                'accepted_at', NEW.accepted_at
            )
        );
    END IF;
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.match_agent_1742397281528(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (agent_1742397281528.embedding <=> query_embedding) as similarity
            FROM agent_1742397281528
            WHERE metadata @> filter
            ORDER BY agent_1742397281528.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_agent_1742425072029(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (agent_1742425072029.embedding <=> query_embedding) as similarity
            FROM agent_1742425072029
            WHERE metadata @> filter
            ORDER BY agent_1742425072029.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_agent_1742426304880(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (agent_1742426304880.embedding <=> query_embedding) as similarity
            FROM agent_1742426304880
            WHERE metadata @> filter
            ORDER BY agent_1742426304880.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_ai_agent(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (ai_agent.embedding <=> query_embedding) as similarity
            FROM ai_agent
            WHERE metadata @> filter
            ORDER BY ai_agent.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_ai_agents(client_id_param uuid, agent_name_param text, query_embedding vector, match_count integer DEFAULT 10, additional_filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id uuid, name text, content text, settings jsonb, similarity double precision, url text)
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
    RETURN QUERY
    SELECT
        e.id,
        e.name,
        e.content,
        e.settings,
        1 - (e.embedding <=> query_embedding) as similarity,
        e.url
    FROM ai_agents e
    WHERE 
        e.client_id = client_id_param AND
        e.name = agent_name_param AND
        (additional_filter IS NULL OR e.settings @> additional_filter) AND
        e.embedding IS NOT NULL
    ORDER BY e.embedding <=> query_embedding
    LIMIT match_count;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.match_ai_agents(query_embedding vector, client_id_filter uuid, agent_name_filter text, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, client_id uuid, agent_name text, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
#variable_conflict use_column
BEGIN
  RETURN query
  SELECT
    id,
    client_id,
    agent_name,
    content,
    metadata,
    1 - (ai_agents.embedding <=> query_embedding) as similarity
  FROM ai_agents
  WHERE 
    client_id = client_id_filter AND
    agent_name = agent_name_filter AND
    metadata @> filter
  ORDER BY ai_agents.embedding <=> query_embedding
  LIMIT match_count;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.match_airtable(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (airtable.embedding <=> query_embedding) as similarity
            FROM airtable
            WHERE metadata @> filter
            ORDER BY airtable.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_asd(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
#variable_conflict use_column
begin
  return query
  select
    id,
    content,
    metadata,
    1 - (asd.embedding <=> query_embedding) as similarity
  from asd
  where metadata @> filter
  order by asd.embedding <=> query_embedding
  limit match_count;
end;
$function$
;

CREATE OR REPLACE FUNCTION public.match_ask_parent_handbook(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (ask_parent_handbook.embedding <=> query_embedding) as similarity
            FROM ask_parent_handbook
            WHERE metadata @> filter
            ORDER BY ask_parent_handbook.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_biegye(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (biegye.embedding <=> query_embedding) as similarity
            FROM biegye
            WHERE metadata @> filter
            ORDER BY biegye.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_bigje(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (bigje.embedding <=> query_embedding) as similarity
            FROM bigje
            WHERE metadata @> filter
            ORDER BY bigje.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_biyger(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (biyger.embedding <=> query_embedding) as similarity
            FROM biyger
            WHERE metadata @> filter
            ORDER BY biyger.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_bokvn(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (bokvn.embedding <=> query_embedding) as similarity
            FROM bokvn
            WHERE metadata @> filter
            ORDER BY bokvn.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_buffalo_school_board(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (buffalo_school_board.embedding <=> query_embedding) as similarity
            FROM buffalo_school_board
            WHERE metadata @> filter
            ORDER BY buffalo_school_board.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_byclicks(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (byclicks.embedding <=> query_embedding) as similarity
            FROM byclicks
            WHERE metadata @> filter
            ORDER BY byclicks.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_cafgt11(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (cafgt11.embedding <=> query_embedding) as similarity
            FROM cafgt11
            WHERE metadata @> filter
            ORDER BY cafgt11.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_cc(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (cc.embedding <=> query_embedding) as similarity
            FROM cc
            WHERE metadata @> filter
            ORDER BY cc.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_client_3(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (client_3.embedding <=> query_embedding) as similarity
            FROM client_3
            WHERE metadata @> filter
            ORDER BY client_3.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_coca_cola(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (coca_cola.embedding <=> query_embedding) as similarity
            FROM coca_cola
            WHERE metadata @> filter
            ORDER BY coca_cola.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_coins(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (coins.embedding <=> query_embedding) as similarity
            FROM coins
            WHERE metadata @> filter
            ORDER BY coins.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_deals(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (deals.embedding <=> query_embedding) as similarity
            FROM deals
            WHERE metadata @> filter
            ORDER BY deals.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_digicel(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (digicel.embedding <=> query_embedding) as similarity
            FROM digicel
            WHERE metadata @> filter
            ORDER BY digicel.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_documents(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
#variable_conflict use_column
begin
  return query
  select
    id,
    content,
    metadata,
    1 - (documents.embedding <=> query_embedding) as similarity
  from documents
  where metadata @> filter
  order by documents.embedding <=> query_embedding
  limit match_count;
end;
$function$
;

CREATE OR REPLACE FUNCTION public.match_frenniy(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (frenniy.embedding <=> query_embedding) as similarity
            FROM frenniy
            WHERE metadata @> filter
            ORDER BY frenniy.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_g_g(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (g_g.embedding <=> query_embedding) as similarity
            FROM g_g
            WHERE metadata @> filter
            ORDER BY g_g.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_gaiivo(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (gaiivo.embedding <=> query_embedding) as similarity
            FROM gaiivo
            WHERE metadata @> filter
            ORDER BY gaiivo.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_glouglu(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (glouglu.embedding <=> query_embedding) as similarity
            FROM glouglu
            WHERE metadata @> filter
            ORDER BY glouglu.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_great_deal(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (great_deal.embedding <=> query_embedding) as similarity
      FROM great_deal
      WHERE metadata @> filter
      ORDER BY great_deal.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_imanye_3(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (imanye_3.embedding <=> query_embedding) as similarity
            FROM imanye_3
            WHERE metadata @> filter
            ORDER BY imanye_3.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_llama1(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (llama1.embedding <=> query_embedding) as similarity
            FROM llama1
            WHERE metadata @> filter
            ORDER BY llama1.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_llama11(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (llama11.embedding <=> query_embedding) as similarity
            FROM llama11
            WHERE metadata @> filter
            ORDER BY llama11.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_llama3(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (llama3.embedding <=> query_embedding) as similarity
            FROM llama3
            WHERE metadata @> filter
            ORDER BY llama3.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_llama4(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (llama4.embedding <=> query_embedding) as similarity
            FROM llama4
            WHERE metadata @> filter
            ORDER BY llama4.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_llama5(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (llama5.embedding <=> query_embedding) as similarity
            FROM llama5
            WHERE metadata @> filter
            ORDER BY llama5.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_llama7(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (llama7.embedding <=> query_embedding) as similarity
            FROM llama7
            WHERE metadata @> filter
            ORDER BY llama7.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_llama9(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (llama9.embedding <=> query_embedding) as similarity
            FROM llama9
            WHERE metadata @> filter
            ORDER BY llama9.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_mailer(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (mailer.embedding <=> query_embedding) as similarity
            FROM mailer
            WHERE metadata @> filter
            ORDER BY mailer.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_manyel_2(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (manyel_2.embedding <=> query_embedding) as similarity
            FROM manyel_2
            WHERE metadata @> filter
            ORDER BY manyel_2.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_metricool(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (metricool.embedding <=> query_embedding) as similarity
            FROM metricool
            WHERE metadata @> filter
            ORDER BY metricool.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_n8n(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (n8n.embedding <=> query_embedding) as similarity
            FROM n8n
            WHERE metadata @> filter
            ORDER BY n8n.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_n8n123(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (n8n123.embedding <=> query_embedding) as similarity
            FROM n8n123
            WHERE metadata @> filter
            ORDER BY n8n123.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_neem_25(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (neem_25.embedding <=> query_embedding) as similarity
      FROM neem_25
      WHERE metadata @> filter
      ORDER BY neem_25.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_news(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (news.embedding <=> query_embedding) as similarity
      FROM news
      WHERE metadata @> filter
      ORDER BY news.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_news_2(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (news_2.embedding <=> query_embedding) as similarity
            FROM news_2
            WHERE metadata @> filter
            ORDER BY news_2.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_news_3(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (news_3.embedding <=> query_embedding) as similarity
            FROM news_3
            WHERE metadata @> filter
            ORDER BY news_3.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_news_4(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (news_4.embedding <=> query_embedding) as similarity
            FROM news_4
            WHERE metadata @> filter
            ORDER BY news_4.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_news_5(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (news_5.embedding <=> query_embedding) as similarity
            FROM news_5
            WHERE metadata @> filter
            ORDER BY news_5.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_news_one(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (news_one.embedding <=> query_embedding) as similarity
            FROM news_one
            WHERE metadata @> filter
            ORDER BY news_one.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_nnmo1(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (nnmo1.embedding <=> query_embedding) as similarity
      FROM nnmo1
      WHERE metadata @> filter
      ORDER BY nnmo1.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_notion(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (notion.embedding <=> query_embedding) as similarity
            FROM notion
            WHERE metadata @> filter
            ORDER BY notion.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_pet__pets(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (pet__pets.embedding <=> query_embedding) as similarity
            FROM pet__pets
            WHERE metadata @> filter
            ORDER BY pet__pets.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_pierreme12(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (pierreme12.embedding <=> query_embedding) as similarity
            FROM pierreme12
            WHERE metadata @> filter
            ORDER BY pierreme12.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_pierreme123(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (pierreme123.embedding <=> query_embedding) as similarity
            FROM pierreme123
            WHERE metadata @> filter
            ORDER BY pierreme123.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_primelee1(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (primelee1.embedding <=> query_embedding) as similarity
            FROM primelee1
            WHERE metadata @> filter
            ORDER BY primelee1.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_proque(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (proque.embedding <=> query_embedding) as similarity
            FROM proque
            WHERE metadata @> filter
            ORDER BY proque.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_proton(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (proton.embedding <=> query_embedding) as similarity
            FROM proton
            WHERE metadata @> filter
            ORDER BY proton.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_sadhana_forest(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (sadhana_forest.embedding <=> query_embedding) as similarity
            FROM sadhana_forest
            WHERE metadata @> filter
            ORDER BY sadhana_forest.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_saldo(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (saldo.embedding <=> query_embedding) as similarity
            FROM saldo
            WHERE metadata @> filter
            ORDER BY saldo.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_skynet(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (skynet.embedding <=> query_embedding) as similarity
            FROM skynet
            WHERE metadata @> filter
            ORDER BY skynet.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_story(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (story.embedding <=> query_embedding) as similarity
            FROM story
            WHERE metadata @> filter
            ORDER BY story.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_tea_team(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (tea_team.embedding <=> query_embedding) as similarity
            FROM tea_team
            WHERE metadata @> filter
            ORDER BY tea_team.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_teplate(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (teplate.embedding <=> query_embedding) as similarity
            FROM teplate
            WHERE metadata @> filter
            ORDER BY teplate.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_tesi(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (tesi.embedding <=> query_embedding) as similarity
            FROM tesi
            WHERE metadata @> filter
            ORDER BY tesi.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test12345(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test12345.embedding <=> query_embedding) as similarity
            FROM test12345
            WHERE metadata @> filter
            ORDER BY test12345.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test1t(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test1t.embedding <=> query_embedding) as similarity
            FROM test1t
            WHERE metadata @> filter
            ORDER BY test1t.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test5(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test5.embedding <=> query_embedding) as similarity
            FROM test5
            WHERE metadata @> filter
            ORDER BY test5.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test6_gmail_com(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test6_gmail_com.embedding <=> query_embedding) as similarity
            FROM test6_gmail_com
            WHERE metadata @> filter
            ORDER BY test6_gmail_com.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test7(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test7.embedding <=> query_embedding) as similarity
            FROM test7
            WHERE metadata @> filter
            ORDER BY test7.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test_98(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test_98.embedding <=> query_embedding) as similarity
            FROM test_98
            WHERE metadata @> filter
            ORDER BY test_98.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test_agent_1741894950(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test_agent_1741894950.embedding <=> query_embedding) as similarity
            FROM test_agent_1741894950
            WHERE metadata @> filter
            ORDER BY test_agent_1741894950.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test_agent_1741895003(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test_agent_1741895003.embedding <=> query_embedding) as similarity
            FROM test_agent_1741895003
            WHERE metadata @> filter
            ORDER BY test_agent_1741895003.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_test_xyt7ti(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (test_xyt7ti.embedding <=> query_embedding) as similarity
            FROM test_xyt7ti
            WHERE metadata @> filter
            ORDER BY test_xyt7ti.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testa(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testa.embedding <=> query_embedding) as similarity
            FROM testa
            WHERE metadata @> filter
            ORDER BY testa.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testab(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testab.embedding <=> query_embedding) as similarity
            FROM testab
            WHERE metadata @> filter
            ORDER BY testab.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testac(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testac.embedding <=> query_embedding) as similarity
            FROM testac
            WHERE metadata @> filter
            ORDER BY testac.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testad(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testad.embedding <=> query_embedding) as similarity
            FROM testad
            WHERE metadata @> filter
            ORDER BY testad.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testagen6(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testagen6.embedding <=> query_embedding) as similarity
            FROM testagen6
            WHERE metadata @> filter
            ORDER BY testagen6.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testagent(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testagent.embedding <=> query_embedding) as similarity
            FROM testagent
            WHERE metadata @> filter
            ORDER BY testagent.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testagent1(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testagent1.embedding <=> query_embedding) as similarity
            FROM testagent1
            WHERE metadata @> filter
            ORDER BY testagent1.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testagent4(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testagent4.embedding <=> query_embedding) as similarity
            FROM testagent4
            WHERE metadata @> filter
            ORDER BY testagent4.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testagent5(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testagent5.embedding <=> query_embedding) as similarity
            FROM testagent5
            WHERE metadata @> filter
            ORDER BY testagent5.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testagent7(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testagent7.embedding <=> query_embedding) as similarity
            FROM testagent7
            WHERE metadata @> filter
            ORDER BY testagent7.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testagent8(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testagent8.embedding <=> query_embedding) as similarity
            FROM testagent8
            WHERE metadata @> filter
            ORDER BY testagent8.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testb(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testb.embedding <=> query_embedding) as similarity
            FROM testb
            WHERE metadata @> filter
            ORDER BY testb.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testc(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testc.embedding <=> query_embedding) as similarity
            FROM testc
            WHERE metadata @> filter
            ORDER BY testc.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testclient11(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testclient11.embedding <=> query_embedding) as similarity
            FROM testclient11
            WHERE metadata @> filter
            ORDER BY testclient11.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testclient12(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testclient12.embedding <=> query_embedding) as similarity
            FROM testclient12
            WHERE metadata @> filter
            ORDER BY testclient12.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testclient3(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testclient3.embedding <=> query_embedding) as similarity
            FROM testclient3
            WHERE metadata @> filter
            ORDER BY testclient3.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testclient4(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testclient4.embedding <=> query_embedding) as similarity
            FROM testclient4
            WHERE metadata @> filter
            ORDER BY testclient4.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testclient5(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testclient5.embedding <=> query_embedding) as similarity
            FROM testclient5
            WHERE metadata @> filter
            ORDER BY testclient5.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testd(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testd.embedding <=> query_embedding) as similarity
            FROM testd
            WHERE metadata @> filter
            ORDER BY testd.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_teste(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (teste.embedding <=> query_embedding) as similarity
            FROM teste
            WHERE metadata @> filter
            ORDER BY teste.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testest(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testest.embedding <=> query_embedding) as similarity
            FROM testest
            WHERE metadata @> filter
            ORDER BY testest.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testest1(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testest1.embedding <=> query_embedding) as similarity
            FROM testest1
            WHERE metadata @> filter
            ORDER BY testest1.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testest12(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testest12.embedding <=> query_embedding) as similarity
            FROM testest12
            WHERE metadata @> filter
            ORDER BY testest12.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testf(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testf.embedding <=> query_embedding) as similarity
            FROM testf
            WHERE metadata @> filter
            ORDER BY testf.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testg(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testg.embedding <=> query_embedding) as similarity
            FROM testg
            WHERE metadata @> filter
            ORDER BY testg.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testglas(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testglas.embedding <=> query_embedding) as similarity
            FROM testglas
            WHERE metadata @> filter
            ORDER BY testglas.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testh(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testh.embedding <=> query_embedding) as similarity
            FROM testh
            WHERE metadata @> filter
            ORDER BY testh.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testheagent(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testheagent.embedding <=> query_embedding) as similarity
            FROM testheagent
            WHERE metadata @> filter
            ORDER BY testheagent.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testit(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testit.embedding <=> query_embedding) as similarity
            FROM testit
            WHERE metadata @> filter
            ORDER BY testit.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testj(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testj.embedding <=> query_embedding) as similarity
            FROM testj
            WHERE metadata @> filter
            ORDER BY testj.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testk(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testk.embedding <=> query_embedding) as similarity
            FROM testk
            WHERE metadata @> filter
            ORDER BY testk.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testl(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testl.embedding <=> query_embedding) as similarity
            FROM testl
            WHERE metadata @> filter
            ORDER BY testl.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testm(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testm.embedding <=> query_embedding) as similarity
            FROM testm
            WHERE metadata @> filter
            ORDER BY testm.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testme1234(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testme1234.embedding <=> query_embedding) as similarity
            FROM testme1234
            WHERE metadata @> filter
            ORDER BY testme1234.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testn(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testn.embedding <=> query_embedding) as similarity
            FROM testn
            WHERE metadata @> filter
            ORDER BY testn.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testo(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testo.embedding <=> query_embedding) as similarity
            FROM testo
            WHERE metadata @> filter
            ORDER BY testo.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testp(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testp.embedding <=> query_embedding) as similarity
            FROM testp
            WHERE metadata @> filter
            ORDER BY testp.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testq(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testq.embedding <=> query_embedding) as similarity
            FROM testq
            WHERE metadata @> filter
            ORDER BY testq.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testr(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testr.embedding <=> query_embedding) as similarity
            FROM testr
            WHERE metadata @> filter
            ORDER BY testr.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_tests(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (tests.embedding <=> query_embedding) as similarity
            FROM tests
            WHERE metadata @> filter
            ORDER BY tests.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testt(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testt.embedding <=> query_embedding) as similarity
            FROM testt
            WHERE metadata @> filter
            ORDER BY testt.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testu(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testu.embedding <=> query_embedding) as similarity
            FROM testu
            WHERE metadata @> filter
            ORDER BY testu.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testv(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testv.embedding <=> query_embedding) as similarity
            FROM testv
            WHERE metadata @> filter
            ORDER BY testv.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_testw(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (testw.embedding <=> query_embedding) as similarity
            FROM testw
            WHERE metadata @> filter
            ORDER BY testw.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_the_agent(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (the_agent.embedding <=> query_embedding) as similarity
            FROM the_agent
            WHERE metadata @> filter
            ORDER BY the_agent.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_thetest(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (thetest.embedding <=> query_embedding) as similarity
            FROM thetest
            WHERE metadata @> filter
            ORDER BY thetest.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_tweoo(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (tweoo.embedding <=> query_embedding) as similarity
      FROM tweoo
      WHERE metadata @> filter
      ORDER BY tweoo.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_upwork(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (upwork.embedding <=> query_embedding) as similarity
            FROM upwork
            WHERE metadata @> filter
            ORDER BY upwork.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_vahalas(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (vahalas.embedding <=> query_embedding) as similarity
      FROM vahalas
      WHERE metadata @> filter
      ORDER BY vahalas.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_value1(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (value1.embedding <=> query_embedding) as similarity
            FROM value1
            WHERE metadata @> filter
            ORDER BY value1.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_value10(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (value10.embedding <=> query_embedding) as similarity
            FROM value10
            WHERE metadata @> filter
            ORDER BY value10.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_value11(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (value11.embedding <=> query_embedding) as similarity
            FROM value11
            WHERE metadata @> filter
            ORDER BY value11.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_value2(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (value2.embedding <=> query_embedding) as similarity
            FROM value2
            WHERE metadata @> filter
            ORDER BY value2.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_value6(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (value6.embedding <=> query_embedding) as similarity
            FROM value6
            WHERE metadata @> filter
            ORDER BY value6.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_value7(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (value7.embedding <=> query_embedding) as similarity
            FROM value7
            WHERE metadata @> filter
            ORDER BY value7.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_value8(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (value8.embedding <=> query_embedding) as similarity
            FROM value8
            WHERE metadata @> filter
            ORDER BY value8.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_value9(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (value9.embedding <=> query_embedding) as similarity
            FROM value9
            WHERE metadata @> filter
            ORDER BY value9.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_vidgu(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (vidgu.embedding <=> query_embedding) as similarity
      FROM vidgu
      WHERE metadata @> filter
      ORDER BY vidgu.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_vladd2a(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (vladd2a.embedding <=> query_embedding) as similarity
      FROM vladd2a
      WHERE metadata @> filter
      ORDER BY vladd2a.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_vlooh(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (vlooh.embedding <=> query_embedding) as similarity
      FROM vlooh
      WHERE metadata @> filter
      ORDER BY vlooh.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_voigai(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (voigai.embedding <=> query_embedding) as similarity
      FROM voigai
      WHERE metadata @> filter
      ORDER BY voigai.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.match_wechate(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
        #variable_conflict use_column
        BEGIN
            RETURN query
            SELECT
                id,
                content,
                metadata,
                1 - (wechate.embedding <=> query_embedding) as similarity
            FROM wechate
            WHERE metadata @> filter
            ORDER BY wechate.embedding <=> query_embedding
            LIMIT match_count;
        END;
        $function$
;

CREATE OR REPLACE FUNCTION public.match_your_agent(query_embedding vector, match_count integer DEFAULT NULL::integer, filter jsonb DEFAULT '{}'::jsonb)
 RETURNS TABLE(id bigint, content text, metadata jsonb, similarity double precision)
 LANGUAGE plpgsql
AS $function$
    #variable_conflict use_column
    BEGIN
      RETURN query
      SELECT
        id,
        content,
        metadata,
        1 - (your_agent.embedding <=> query_embedding) as similarity
      FROM your_agent
      WHERE metadata @> filter
      ORDER BY your_agent.embedding <=> query_embedding
      LIMIT match_count;
    END;
    $function$
;

CREATE OR REPLACE FUNCTION public.migrate_agent_tables_to_ai_agents()
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    table_name text;
    client_record RECORD;
    query_text text;
    agent_count integer := 0;
BEGIN
    -- Get all tables that are likely agent tables (based on naming convention)
    FOR table_name IN 
        SELECT tablename 
        FROM pg_tables 
        WHERE schemaname = 'public' 
          AND tablename NOT IN (
            'clients', 'ai_agents', 'user_roles', 'website_urls', 'google_drive_links', 
            'client_activities', 'error_logs', 'common_queries', 'profiles', 'email_logs',
            'invitations', 'client_invitations', 'client_recovery_tokens', 'client_temp_passwords'
          )
          AND tablename NOT LIKE 'pg_%'
          AND EXISTS (
            SELECT 1 
            FROM pg_attribute 
            WHERE attrelid = (quote_ident(tablename))::regclass 
              AND attname = 'embedding'
          )
    LOOP
        -- For each agent table, get clients that might use this agent table name
        FOR client_record IN
            SELECT id, agent_name, client_name, email
            FROM clients
            WHERE LOWER(agent_name) = table_name 
               OR LOWER(REPLACE(agent_name, ' ', '_')) = table_name
               OR agent_name SIMILAR TO '%' || table_name || '%'
        LOOP
            -- Migrate data from agent table to ai_agents table
            -- Modify the query to match the actual ai_agents table structure
            query_text := format('
                INSERT INTO ai_agents (
                    client_id,
                    name,
                    content,
                    embedding,
                    settings,
                    interaction_type,
                    created_at,
                    updated_at,
                    is_error
                )
                SELECT 
                    %L::uuid,
                    %L,
                    content,
                    embedding,
                    COALESCE(metadata, ''{}''::jsonb) || jsonb_build_object(
                        ''source_table'', %L,
                        ''original_id'', id,
                        ''migration_date'', NOW()::text
                    ) AS settings,
                    ''imported_data'',
                    NOW(),
                    NOW(),
                    false
                FROM %I
                WHERE content IS NOT NULL
                ON CONFLICT DO NOTHING
                RETURNING id',
                client_record.id, client_record.agent_name, table_name, table_name
            );
            
            EXECUTE query_text;
            GET DIAGNOSTICS agent_count = ROW_COUNT;
            
            -- Log the migration activity if we imported any records
            IF agent_count > 0 THEN
                INSERT INTO client_activities (
                    client_id,
                    activity_type,
                    description,
                    metadata
                ) VALUES (
                    client_record.id,
                    'ai_agent_created',
                    'Migrated ' || agent_count || ' entries from ' || table_name || ' table to unified AI agents structure',
                    jsonb_build_object(
                        'agent_name', client_record.agent_name,
                        'source_table', table_name,
                        'record_count', agent_count,
                        'client_name', client_record.client_name,
                        'email', client_record.email
                    )
                );
                
                RAISE NOTICE 'Migrated % records from table % for client % (agent: %)',
                    agent_count, table_name, client_record.client_name, client_record.agent_name;
            END IF;
        END LOOP;
    END LOOP;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.migrate_all_agent_tables_to_ai_agents()
 RETURNS void
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
DECLARE
    agent_tables text[] := ARRAY[
        'coca_cola', 'deals', 'digicel', 'frenniy', 'gaiivo', 'glouglu', 
        'great_deal', 'imanye_3', 'mailer', 'metricool', 'n8n', 'neem_25', 
        'news', 'nnmo1', 'notion', 'sadhana_forest', 'ai_agent'
    ];
    table_exists boolean;
    table_name text;
    client_record RECORD;
    migration_count integer;
BEGIN
    -- First check which tables actually exist in the database
    RAISE NOTICE 'Starting migration of AI agent tables to unified ai_agents table';
    
    -- For each potential agent table
    FOREACH table_name IN ARRAY agent_tables
    LOOP
        -- Check if the table exists
        EXECUTE format('
            SELECT EXISTS (
                SELECT FROM pg_tables 
                WHERE schemaname = ''public'' 
                AND tablename = %L
            )', table_name) 
        INTO table_exists;
        
        IF table_exists THEN
            RAISE NOTICE 'Found agent table: %', table_name;
            
            -- Look for matching clients
            FOR client_record IN
                SELECT id, agent_name, client_name
                FROM clients
                WHERE LOWER(agent_name) = table_name 
                   OR LOWER(REPLACE(agent_name, ' ', '_')) = table_name
                   OR agent_name ILIKE '%' || table_name || '%'
                   OR table_name ILIKE '%' || agent_name || '%'
            LOOP
                RAISE NOTICE 'Processing migration for client: % (ID: %), Agent: % from table %', 
                    client_record.client_name, client_record.id, client_record.agent_name, table_name;
                
                -- Migrate data using the existing migrate_chatbot_to_ai_agents function
                SELECT migrate_chatbot_to_ai_agents(
                    table_name,
                    client_record.id,
                    client_record.agent_name
                ) INTO migration_count;
                
                IF migration_count > 0 THEN
                    RAISE NOTICE 'Successfully migrated % records from % to ai_agents for client %', 
                        migration_count, table_name, client_record.client_name;
                ELSE
                    RAISE NOTICE 'No records migrated from % for client %', 
                        table_name, client_record.client_name;
                END IF;
            END LOOP;
            
            -- If no matching client was found for this table, create one
            IF NOT EXISTS (
                SELECT 1 FROM clients
                WHERE LOWER(agent_name) = table_name 
                   OR LOWER(REPLACE(agent_name, ' ', '_')) = table_name
                   OR agent_name ILIKE '%' || table_name || '%'
                   OR table_name ILIKE '%' || agent_name || '%'
            ) THEN
                -- Create a new client for this agent table
                WITH new_client AS (
                    INSERT INTO clients (
                        client_name,
                        agent_name,
                        email,
                        status,
                        created_at,
                        updated_at
                    ) VALUES (
                        initcap(replace(table_name, '_', ' ')), -- Convert to title case
                        table_name,
                        'auto-created-' || table_name || '@example.com',
                        'active',
                        NOW(),
                        NOW()
                    )
                    RETURNING id, agent_name, client_name
                )
                SELECT migrate_chatbot_to_ai_agents(
                    table_name,
                    id,
                    agent_name
                ) INTO migration_count
                FROM new_client;
                
                RAISE NOTICE 'Created new client and migrated % records from %', 
                    migration_count, table_name;
            END IF;
        ELSE
            RAISE NOTICE 'Table % does not exist, skipping', table_name;
        END IF;
    END LOOP;
    
    RAISE NOTICE 'Migration complete!';
END;
$function$
;

CREATE OR REPLACE FUNCTION public.migrate_chatbot_to_ai_agents(source_table_name text, client_id uuid, agent_name text)
 RETURNS integer
 LANGUAGE plpgsql
AS $function$
DECLARE
  migration_count integer := 0;
  query_text text;
  has_created_at boolean;
  has_updated_at boolean;
BEGIN
  -- Check if the table exists
  IF NOT EXISTS (
    SELECT FROM pg_tables 
    WHERE schemaname = 'public' 
    AND tablename = source_table_name
  ) THEN
    RAISE NOTICE 'Table % does not exist, skipping', source_table_name;
    RETURN 0;
  END IF;

  -- Check if the table has created_at and updated_at columns
  SELECT EXISTS (
    SELECT FROM information_schema.columns
    WHERE table_schema = 'public'
    AND table_name = source_table_name
    AND column_name = 'created_at'
  ) INTO has_created_at;
  
  SELECT EXISTS (
    SELECT FROM information_schema.columns
    WHERE table_schema = 'public'
    AND table_name = source_table_name
    AND column_name = 'updated_at'
  ) INTO has_updated_at;
  
  -- Build dynamic SQL to copy from the source table to ai_agents table
  -- Adjust for presence/absence of created_at and updated_at columns
  IF has_created_at AND has_updated_at THEN
    query_text := format('
      INSERT INTO ai_agents (
        client_id,
        name,
        content,
        embedding,
        settings,
        interaction_type,
        created_at,
        updated_at,
        is_error
      )
      SELECT 
        %L::uuid,                -- client_id
        %L,                      -- agent_name
        content,                 -- content
        embedding,               -- embedding
        COALESCE(metadata, ''{}''::jsonb) || jsonb_build_object(
          ''source_table'', %L,
          ''original_id'', id,
          ''migration_date'', NOW()::text
        ),                       -- settings
        ''imported_data'',       -- interaction_type
        created_at,              -- created_at
        updated_at,              -- updated_at
        false                    -- is_error
      FROM %I
      WHERE content IS NOT NULL
      ON CONFLICT DO NOTHING
      RETURNING id',
      client_id, agent_name, source_table_name, source_table_name
    );
  ELSE
    query_text := format('
      INSERT INTO ai_agents (
        client_id,
        name,
        content,
        embedding,
        settings,
        interaction_type,
        is_error
      )
      SELECT 
        %L::uuid,                -- client_id
        %L,                      -- agent_name
        content,                 -- content
        embedding,               -- embedding
        COALESCE(metadata, ''{}''::jsonb) || jsonb_build_object(
          ''source_table'', %L,
          ''original_id'', id,
          ''migration_date'', NOW()::text
        ),                       -- settings
        ''imported_data'',       -- interaction_type
        false                    -- is_error
      FROM %I
      WHERE content IS NOT NULL
      ON CONFLICT DO NOTHING
      RETURNING id',
      client_id, agent_name, source_table_name, source_table_name
    );
  END IF;
  
  -- Execute the query
  EXECUTE query_text;
  GET DIAGNOSTICS migration_count = ROW_COUNT;
  
  -- Log the migration
  IF migration_count > 0 THEN
    INSERT INTO client_activities (
      client_id,
      activity_type,
      description,
      metadata
    ) VALUES (
      client_id,
      'ai_agent_created',
      'Migrated ' || migration_count || ' entries from ' || source_table_name || ' table to unified AI agents structure',
      jsonb_build_object(
        'agent_name', agent_name,
        'source_table', source_table_name,
        'record_count', migration_count
      )
    );
    
    RAISE NOTICE 'Migrated % records from table % for agent %',
      migration_count, source_table_name, agent_name;
  END IF;
  
  RETURN migration_count;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.moddatetime()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    NEW.updated_at = CURRENT_TIMESTAMP;
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.notify_dev_changes()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Insert into a queue table for processing
    INSERT INTO dev_notifications (
        event_type,
        client_id,
        client_name,
        chatbot_name,
        source_url,
        created_at
    ) VALUES (
        CASE 
            WHEN TG_OP = 'INSERT' THEN 'new_source'
            WHEN TG_OP = 'DELETE' THEN 'deleted_source'
        END,
        NEW.client_id,
        (SELECT name FROM clients WHERE id = NEW.client_id),
        (SELECT name FROM chatbots WHERE client_id = NEW.client_id LIMIT 1),
        NEW.url,
        NOW()
    );
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.search_similar_content(query_embedding vector, similarity_threshold double precision DEFAULT 0.7, max_results integer DEFAULT 5)
 RETURNS TABLE(id bigint, content_text text, similarity double precision)
 LANGUAGE plpgsql
AS $function$
begin
  return query
  select
    id,
    content_text,
    1 - (content_vector <=> query_embedding) as similarity
  from client_sources
  where content_vector is not null
    and 1 - (content_vector <=> query_embedding) > similarity_threshold
  order by content_vector <=> query_embedding
  limit max_results;
end;
$function$
;

CREATE OR REPLACE FUNCTION public.setup_vector_table_policies(table_name text)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Enable RLS
    EXECUTE format('ALTER TABLE %I ENABLE ROW LEVEL SECURITY', table_name);
    
    -- Create service role policy
    EXECUTE format(
        'CREATE POLICY "Enable all operations for service role" ON %I FOR ALL TO service_role USING (true) WITH CHECK (true)',
        table_name
    );
    
    -- Create authenticated users read policy
    EXECUTE format(
        'CREATE POLICY "Enable read for authenticated users" ON %I FOR SELECT TO authenticated USING (true)',
        table_name
    );
END;
$function$
;

CREATE OR REPLACE FUNCTION public.sync_agent_name_on_client_update()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Only run if agent_name was changed
    IF NEW.agent_name IS DISTINCT FROM OLD.agent_name THEN
        -- Update all associated ai_agents records with exactly the same name
        UPDATE public.ai_agents
        SET name = NEW.agent_name  -- Use the exact name without modifications
        WHERE client_id = NEW.id;
        
        -- Log the synchronization
        INSERT INTO client_activities (
            client_id,
            activity_type,
            description,
            metadata
        ) VALUES (
            NEW.id,
            'system_update',
            'AI agent names synchronized with client settings',
            jsonb_build_object(
                'old_name', OLD.agent_name,
                'new_name', NEW.agent_name,
                'updated_at', NOW()
            )
        );
    END IF;
    
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.sync_logo_on_client_update()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
  -- When logo_url is updated in clients.widget_settings, sync to ai_agents
  IF (NEW.widget_settings->>'logo_url' IS DISTINCT FROM OLD.widget_settings->>'logo_url') THEN
    UPDATE public.ai_agents
    SET 
      logo_url = NEW.widget_settings->>'logo_url',
      logo_storage_path = NEW.widget_settings->>'logo_storage_path'
    WHERE client_id = NEW.id;
  END IF;
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_ai_agent_on_client_update()
 RETURNS trigger
 LANGUAGE plpgsql
 SECURITY DEFINER
AS $function$
BEGIN
  IF (OLD.agent_name IS DISTINCT FROM NEW.agent_name) OR 
     (OLD.widget_settings->>'agent_description' IS DISTINCT FROM NEW.widget_settings->>'agent_description') THEN
    
    UPDATE public.ai_agents
    SET 
      name = COALESCE(NEW.agent_name, 'AI Assistant'),
      description = NEW.widget_settings->>'agent_description',
      updated_at = NOW()
    WHERE client_id = NEW.id;
  END IF;
  
  RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_ai_agents_updated_at()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_chatbot_metrics()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    total_interactions integer;
    avg_response_time numeric;
    success_rate numeric;
BEGIN
    -- Calculate metrics for the chatbot
    SELECT 
        COUNT(*),
        AVG(EXTRACT(EPOCH FROM (updated_at - created_at))),
        (COUNT(*) FILTER (WHERE status = 'resolved') * 100.0 / NULLIF(COUNT(*), 0))::numeric
    INTO
        total_interactions,
        avg_response_time,
        success_rate
    FROM interactions
    WHERE chatbot_id = NEW.chatbot_id;

    -- Update the chatbot's performance metrics
    UPDATE chatbots
    SET performance_metrics = jsonb_build_object(
        'total_interactions', total_interactions,
        'avg_response_time', ROUND(avg_response_time::numeric, 2),
        'success_rate', ROUND(success_rate, 2),
        'last_updated', NOW()
    )
    WHERE id = NEW.chatbot_id;

    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_client_last_active()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    UPDATE clients
    SET last_active = NOW()
    WHERE id = NEW.client_id;
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_client_last_active_on_agent_interaction()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    -- Only update for chat interactions
    IF NEW.interaction_type = 'chat_interaction' THEN
        UPDATE clients
        SET last_active = NOW()
        WHERE id = NEW.client_id;
    END IF;
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_client_metrics()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
DECLARE
    total_count integer;
    prev_count integer;
    growth numeric;
BEGIN
    -- Calculate total interactions for the client
    SELECT COUNT(*) INTO total_count
    FROM interactions i
    JOIN chatbots c ON i.chatbot_id = c.id
    WHERE c.client_id = NEW.client_id;

    -- Get previous day's count
    SELECT interactions_count INTO prev_count
    FROM client_metrics
    WHERE client_id = NEW.client_id
    AND date = (CURRENT_DATE - INTERVAL '1 day')::date;

    -- Calculate growth rate
    IF prev_count IS NOT NULL AND prev_count > 0 THEN
        growth := ((total_count - prev_count)::numeric / prev_count::numeric) * 100;
    ELSE
        growth := 0;
    END IF;

    -- Create activity for significant growth (over 20%)
    IF growth > 20 THEN
        INSERT INTO client_activities (
            client_id,
            activity_type,
            description,
            metadata
        ) VALUES (
            NEW.client_id,
            'growth_milestone',
            'Achieved ' || ROUND(growth, 2) || '% growth in interactions',
            jsonb_build_object(
                'growth_rate', growth,
                'previous_count', prev_count,
                'new_count', total_count
            )
        );
    END IF;

    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_logo_url(client_id uuid, logo_url text, storage_path text)
 RETURNS void
 LANGUAGE plpgsql
AS $function$
BEGIN
  UPDATE clients
  SET widget_settings = jsonb_set(
    jsonb_set(widget_settings, '{logo_url}', to_jsonb(logo_url)),
    '{logo_storage_path}',
    to_jsonb(storage_path)
  )
  WHERE id = client_id;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_monthly_usage()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    INSERT INTO monthly_usage (client_id, month, total_interactions)
    VALUES (
        NEW.client_id,
        DATE_TRUNC('month', NEW.created_at)::DATE,
        1
    )
    ON CONFLICT (client_id, month)
    DO UPDATE SET
        total_interactions = monthly_usage.total_interactions + 1,
        updated_at = TIMEZONE('utc', NOW());
    RETURN NEW;
END;
$function$
;

CREATE OR REPLACE FUNCTION public.update_updated_at_column()
 RETURNS trigger
 LANGUAGE plpgsql
AS $function$
BEGIN
    NEW.updated_at = now();
    RETURN NEW;
END;
$function$
;

grant delete on table "public"."ai_agent" to "anon";

grant insert on table "public"."ai_agent" to "anon";

grant references on table "public"."ai_agent" to "anon";

grant select on table "public"."ai_agent" to "anon";

grant trigger on table "public"."ai_agent" to "anon";

grant truncate on table "public"."ai_agent" to "anon";

grant update on table "public"."ai_agent" to "anon";

grant delete on table "public"."ai_agent" to "authenticated";

grant insert on table "public"."ai_agent" to "authenticated";

grant references on table "public"."ai_agent" to "authenticated";

grant select on table "public"."ai_agent" to "authenticated";

grant trigger on table "public"."ai_agent" to "authenticated";

grant truncate on table "public"."ai_agent" to "authenticated";

grant update on table "public"."ai_agent" to "authenticated";

grant delete on table "public"."ai_agent" to "service_role";

grant insert on table "public"."ai_agent" to "service_role";

grant references on table "public"."ai_agent" to "service_role";

grant select on table "public"."ai_agent" to "service_role";

grant trigger on table "public"."ai_agent" to "service_role";

grant truncate on table "public"."ai_agent" to "service_role";

grant update on table "public"."ai_agent" to "service_role";

grant delete on table "public"."ai_agent" to "stephen@soprisapps.com";

grant insert on table "public"."ai_agent" to "stephen@soprisapps.com";

grant references on table "public"."ai_agent" to "stephen@soprisapps.com";

grant select on table "public"."ai_agent" to "stephen@soprisapps.com";

grant trigger on table "public"."ai_agent" to "stephen@soprisapps.com";

grant truncate on table "public"."ai_agent" to "stephen@soprisapps.com";

grant update on table "public"."ai_agent" to "stephen@soprisapps.com";

grant delete on table "public"."ai_agents" to "stephen@soprisapps.com";

grant insert on table "public"."ai_agents" to "stephen@soprisapps.com";

grant references on table "public"."ai_agents" to "stephen@soprisapps.com";

grant select on table "public"."ai_agents" to "stephen@soprisapps.com";

grant trigger on table "public"."ai_agents" to "stephen@soprisapps.com";

grant truncate on table "public"."ai_agents" to "stephen@soprisapps.com";

grant update on table "public"."ai_agents" to "stephen@soprisapps.com";

grant delete on table "public"."ai_agents_backup" to "anon";

grant insert on table "public"."ai_agents_backup" to "anon";

grant references on table "public"."ai_agents_backup" to "anon";

grant select on table "public"."ai_agents_backup" to "anon";

grant trigger on table "public"."ai_agents_backup" to "anon";

grant truncate on table "public"."ai_agents_backup" to "anon";

grant update on table "public"."ai_agents_backup" to "anon";

grant delete on table "public"."ai_agents_backup" to "authenticated";

grant insert on table "public"."ai_agents_backup" to "authenticated";

grant references on table "public"."ai_agents_backup" to "authenticated";

grant select on table "public"."ai_agents_backup" to "authenticated";

grant trigger on table "public"."ai_agents_backup" to "authenticated";

grant truncate on table "public"."ai_agents_backup" to "authenticated";

grant update on table "public"."ai_agents_backup" to "authenticated";

grant delete on table "public"."ai_agents_backup" to "service_role";

grant insert on table "public"."ai_agents_backup" to "service_role";

grant references on table "public"."ai_agents_backup" to "service_role";

grant select on table "public"."ai_agents_backup" to "service_role";

grant trigger on table "public"."ai_agents_backup" to "service_role";

grant truncate on table "public"."ai_agents_backup" to "service_role";

grant update on table "public"."ai_agents_backup" to "service_role";

grant delete on table "public"."ai_agents_backup" to "stephen@soprisapps.com";

grant insert on table "public"."ai_agents_backup" to "stephen@soprisapps.com";

grant references on table "public"."ai_agents_backup" to "stephen@soprisapps.com";

grant select on table "public"."ai_agents_backup" to "stephen@soprisapps.com";

grant trigger on table "public"."ai_agents_backup" to "stephen@soprisapps.com";

grant truncate on table "public"."ai_agents_backup" to "stephen@soprisapps.com";

grant update on table "public"."ai_agents_backup" to "stephen@soprisapps.com";

grant delete on table "public"."ai_documents" to "anon";

grant insert on table "public"."ai_documents" to "anon";

grant references on table "public"."ai_documents" to "anon";

grant select on table "public"."ai_documents" to "anon";

grant trigger on table "public"."ai_documents" to "anon";

grant truncate on table "public"."ai_documents" to "anon";

grant update on table "public"."ai_documents" to "anon";

grant delete on table "public"."ai_documents" to "authenticated";

grant insert on table "public"."ai_documents" to "authenticated";

grant references on table "public"."ai_documents" to "authenticated";

grant select on table "public"."ai_documents" to "authenticated";

grant trigger on table "public"."ai_documents" to "authenticated";

grant truncate on table "public"."ai_documents" to "authenticated";

grant update on table "public"."ai_documents" to "authenticated";

grant delete on table "public"."ai_documents" to "service_role";

grant insert on table "public"."ai_documents" to "service_role";

grant references on table "public"."ai_documents" to "service_role";

grant select on table "public"."ai_documents" to "service_role";

grant trigger on table "public"."ai_documents" to "service_role";

grant truncate on table "public"."ai_documents" to "service_role";

grant update on table "public"."ai_documents" to "service_role";

grant delete on table "public"."ai_documents" to "stephen@soprisapps.com";

grant insert on table "public"."ai_documents" to "stephen@soprisapps.com";

grant references on table "public"."ai_documents" to "stephen@soprisapps.com";

grant select on table "public"."ai_documents" to "stephen@soprisapps.com";

grant trigger on table "public"."ai_documents" to "stephen@soprisapps.com";

grant truncate on table "public"."ai_documents" to "stephen@soprisapps.com";

grant update on table "public"."ai_documents" to "stephen@soprisapps.com";

grant delete on table "public"."ai_interactions" to "anon";

grant insert on table "public"."ai_interactions" to "anon";

grant references on table "public"."ai_interactions" to "anon";

grant select on table "public"."ai_interactions" to "anon";

grant trigger on table "public"."ai_interactions" to "anon";

grant truncate on table "public"."ai_interactions" to "anon";

grant update on table "public"."ai_interactions" to "anon";

grant delete on table "public"."ai_interactions" to "authenticated";

grant insert on table "public"."ai_interactions" to "authenticated";

grant references on table "public"."ai_interactions" to "authenticated";

grant select on table "public"."ai_interactions" to "authenticated";

grant trigger on table "public"."ai_interactions" to "authenticated";

grant truncate on table "public"."ai_interactions" to "authenticated";

grant update on table "public"."ai_interactions" to "authenticated";

grant delete on table "public"."ai_interactions" to "service_role";

grant insert on table "public"."ai_interactions" to "service_role";

grant references on table "public"."ai_interactions" to "service_role";

grant select on table "public"."ai_interactions" to "service_role";

grant trigger on table "public"."ai_interactions" to "service_role";

grant truncate on table "public"."ai_interactions" to "service_role";

grant update on table "public"."ai_interactions" to "service_role";

grant delete on table "public"."ai_interactions" to "stephen@soprisapps.com";

grant insert on table "public"."ai_interactions" to "stephen@soprisapps.com";

grant references on table "public"."ai_interactions" to "stephen@soprisapps.com";

grant select on table "public"."ai_interactions" to "stephen@soprisapps.com";

grant trigger on table "public"."ai_interactions" to "stephen@soprisapps.com";

grant truncate on table "public"."ai_interactions" to "stephen@soprisapps.com";

grant update on table "public"."ai_interactions" to "stephen@soprisapps.com";

grant delete on table "public"."airtable" to "stephen@soprisapps.com";

grant insert on table "public"."airtable" to "stephen@soprisapps.com";

grant references on table "public"."airtable" to "stephen@soprisapps.com";

grant select on table "public"."airtable" to "stephen@soprisapps.com";

grant trigger on table "public"."airtable" to "stephen@soprisapps.com";

grant truncate on table "public"."airtable" to "stephen@soprisapps.com";

grant update on table "public"."airtable" to "stephen@soprisapps.com";

grant delete on table "public"."asd" to "anon";

grant insert on table "public"."asd" to "anon";

grant references on table "public"."asd" to "anon";

grant select on table "public"."asd" to "anon";

grant trigger on table "public"."asd" to "anon";

grant truncate on table "public"."asd" to "anon";

grant update on table "public"."asd" to "anon";

grant delete on table "public"."asd" to "authenticated";

grant insert on table "public"."asd" to "authenticated";

grant references on table "public"."asd" to "authenticated";

grant select on table "public"."asd" to "authenticated";

grant trigger on table "public"."asd" to "authenticated";

grant truncate on table "public"."asd" to "authenticated";

grant update on table "public"."asd" to "authenticated";

grant delete on table "public"."asd" to "service_role";

grant insert on table "public"."asd" to "service_role";

grant references on table "public"."asd" to "service_role";

grant select on table "public"."asd" to "service_role";

grant trigger on table "public"."asd" to "service_role";

grant truncate on table "public"."asd" to "service_role";

grant update on table "public"."asd" to "service_role";

grant delete on table "public"."asd" to "stephen@soprisapps.com";

grant insert on table "public"."asd" to "stephen@soprisapps.com";

grant references on table "public"."asd" to "stephen@soprisapps.com";

grant select on table "public"."asd" to "stephen@soprisapps.com";

grant trigger on table "public"."asd" to "stephen@soprisapps.com";

grant truncate on table "public"."asd" to "stephen@soprisapps.com";

grant update on table "public"."asd" to "stephen@soprisapps.com";

grant delete on table "public"."buffalo_school_board" to "stephen@soprisapps.com";

grant insert on table "public"."buffalo_school_board" to "stephen@soprisapps.com";

grant references on table "public"."buffalo_school_board" to "stephen@soprisapps.com";

grant select on table "public"."buffalo_school_board" to "stephen@soprisapps.com";

grant trigger on table "public"."buffalo_school_board" to "stephen@soprisapps.com";

grant truncate on table "public"."buffalo_school_board" to "stephen@soprisapps.com";

grant update on table "public"."buffalo_school_board" to "stephen@soprisapps.com";

grant delete on table "public"."byclicks" to "stephen@soprisapps.com";

grant insert on table "public"."byclicks" to "stephen@soprisapps.com";

grant references on table "public"."byclicks" to "stephen@soprisapps.com";

grant select on table "public"."byclicks" to "stephen@soprisapps.com";

grant trigger on table "public"."byclicks" to "stephen@soprisapps.com";

grant truncate on table "public"."byclicks" to "stephen@soprisapps.com";

grant update on table "public"."byclicks" to "stephen@soprisapps.com";

grant delete on table "public"."cc" to "stephen@soprisapps.com";

grant insert on table "public"."cc" to "stephen@soprisapps.com";

grant references on table "public"."cc" to "stephen@soprisapps.com";

grant select on table "public"."cc" to "stephen@soprisapps.com";

grant trigger on table "public"."cc" to "stephen@soprisapps.com";

grant truncate on table "public"."cc" to "stephen@soprisapps.com";

grant update on table "public"."cc" to "stephen@soprisapps.com";

grant delete on table "public"."client_3" to "stephen@soprisapps.com";

grant insert on table "public"."client_3" to "stephen@soprisapps.com";

grant references on table "public"."client_3" to "stephen@soprisapps.com";

grant select on table "public"."client_3" to "stephen@soprisapps.com";

grant trigger on table "public"."client_3" to "stephen@soprisapps.com";

grant truncate on table "public"."client_3" to "stephen@soprisapps.com";

grant update on table "public"."client_3" to "stephen@soprisapps.com";

grant delete on table "public"."client_activities" to "stephen@soprisapps.com";

grant insert on table "public"."client_activities" to "stephen@soprisapps.com";

grant references on table "public"."client_activities" to "stephen@soprisapps.com";

grant select on table "public"."client_activities" to "stephen@soprisapps.com";

grant trigger on table "public"."client_activities" to "stephen@soprisapps.com";

grant truncate on table "public"."client_activities" to "stephen@soprisapps.com";

grant update on table "public"."client_activities" to "stephen@soprisapps.com";

grant delete on table "public"."client_invitations" to "anon";

grant insert on table "public"."client_invitations" to "anon";

grant references on table "public"."client_invitations" to "anon";

grant select on table "public"."client_invitations" to "anon";

grant trigger on table "public"."client_invitations" to "anon";

grant truncate on table "public"."client_invitations" to "anon";

grant update on table "public"."client_invitations" to "anon";

grant delete on table "public"."client_invitations" to "authenticated";

grant insert on table "public"."client_invitations" to "authenticated";

grant references on table "public"."client_invitations" to "authenticated";

grant select on table "public"."client_invitations" to "authenticated";

grant trigger on table "public"."client_invitations" to "authenticated";

grant truncate on table "public"."client_invitations" to "authenticated";

grant update on table "public"."client_invitations" to "authenticated";

grant delete on table "public"."client_invitations" to "service_role";

grant insert on table "public"."client_invitations" to "service_role";

grant references on table "public"."client_invitations" to "service_role";

grant select on table "public"."client_invitations" to "service_role";

grant trigger on table "public"."client_invitations" to "service_role";

grant truncate on table "public"."client_invitations" to "service_role";

grant update on table "public"."client_invitations" to "service_role";

grant delete on table "public"."client_invitations" to "stephen@soprisapps.com";

grant insert on table "public"."client_invitations" to "stephen@soprisapps.com";

grant references on table "public"."client_invitations" to "stephen@soprisapps.com";

grant select on table "public"."client_invitations" to "stephen@soprisapps.com";

grant trigger on table "public"."client_invitations" to "stephen@soprisapps.com";

grant truncate on table "public"."client_invitations" to "stephen@soprisapps.com";

grant update on table "public"."client_invitations" to "stephen@soprisapps.com";

grant delete on table "public"."client_recovery_tokens" to "stephen@soprisapps.com";

grant insert on table "public"."client_recovery_tokens" to "stephen@soprisapps.com";

grant references on table "public"."client_recovery_tokens" to "stephen@soprisapps.com";

grant select on table "public"."client_recovery_tokens" to "stephen@soprisapps.com";

grant trigger on table "public"."client_recovery_tokens" to "stephen@soprisapps.com";

grant truncate on table "public"."client_recovery_tokens" to "stephen@soprisapps.com";

grant update on table "public"."client_recovery_tokens" to "stephen@soprisapps.com";

grant delete on table "public"."client_temp_passwords" to "stephen@soprisapps.com";

grant insert on table "public"."client_temp_passwords" to "stephen@soprisapps.com";

grant references on table "public"."client_temp_passwords" to "stephen@soprisapps.com";

grant select on table "public"."client_temp_passwords" to "stephen@soprisapps.com";

grant trigger on table "public"."client_temp_passwords" to "stephen@soprisapps.com";

grant truncate on table "public"."client_temp_passwords" to "stephen@soprisapps.com";

grant update on table "public"."client_temp_passwords" to "stephen@soprisapps.com";

grant delete on table "public"."coca_cola" to "stephen@soprisapps.com";

grant insert on table "public"."coca_cola" to "stephen@soprisapps.com";

grant references on table "public"."coca_cola" to "stephen@soprisapps.com";

grant select on table "public"."coca_cola" to "stephen@soprisapps.com";

grant trigger on table "public"."coca_cola" to "stephen@soprisapps.com";

grant truncate on table "public"."coca_cola" to "stephen@soprisapps.com";

grant update on table "public"."coca_cola" to "stephen@soprisapps.com";

grant delete on table "public"."coins" to "stephen@soprisapps.com";

grant insert on table "public"."coins" to "stephen@soprisapps.com";

grant references on table "public"."coins" to "stephen@soprisapps.com";

grant select on table "public"."coins" to "stephen@soprisapps.com";

grant trigger on table "public"."coins" to "stephen@soprisapps.com";

grant truncate on table "public"."coins" to "stephen@soprisapps.com";

grant update on table "public"."coins" to "stephen@soprisapps.com";

grant delete on table "public"."common_queries" to "anon";

grant insert on table "public"."common_queries" to "anon";

grant references on table "public"."common_queries" to "anon";

grant select on table "public"."common_queries" to "anon";

grant trigger on table "public"."common_queries" to "anon";

grant truncate on table "public"."common_queries" to "anon";

grant update on table "public"."common_queries" to "anon";

grant delete on table "public"."common_queries" to "authenticated";

grant insert on table "public"."common_queries" to "authenticated";

grant references on table "public"."common_queries" to "authenticated";

grant select on table "public"."common_queries" to "authenticated";

grant trigger on table "public"."common_queries" to "authenticated";

grant truncate on table "public"."common_queries" to "authenticated";

grant update on table "public"."common_queries" to "authenticated";

grant delete on table "public"."common_queries" to "service_role";

grant insert on table "public"."common_queries" to "service_role";

grant references on table "public"."common_queries" to "service_role";

grant select on table "public"."common_queries" to "service_role";

grant trigger on table "public"."common_queries" to "service_role";

grant truncate on table "public"."common_queries" to "service_role";

grant update on table "public"."common_queries" to "service_role";

grant delete on table "public"."common_queries" to "stephen@soprisapps.com";

grant insert on table "public"."common_queries" to "stephen@soprisapps.com";

grant references on table "public"."common_queries" to "stephen@soprisapps.com";

grant select on table "public"."common_queries" to "stephen@soprisapps.com";

grant trigger on table "public"."common_queries" to "stephen@soprisapps.com";

grant truncate on table "public"."common_queries" to "stephen@soprisapps.com";

grant update on table "public"."common_queries" to "stephen@soprisapps.com";

grant delete on table "public"."deals" to "stephen@soprisapps.com";

grant insert on table "public"."deals" to "stephen@soprisapps.com";

grant references on table "public"."deals" to "stephen@soprisapps.com";

grant select on table "public"."deals" to "stephen@soprisapps.com";

grant trigger on table "public"."deals" to "stephen@soprisapps.com";

grant truncate on table "public"."deals" to "stephen@soprisapps.com";

grant update on table "public"."deals" to "stephen@soprisapps.com";

grant delete on table "public"."digicel" to "stephen@soprisapps.com";

grant insert on table "public"."digicel" to "stephen@soprisapps.com";

grant references on table "public"."digicel" to "stephen@soprisapps.com";

grant select on table "public"."digicel" to "stephen@soprisapps.com";

grant trigger on table "public"."digicel" to "stephen@soprisapps.com";

grant truncate on table "public"."digicel" to "stephen@soprisapps.com";

grant update on table "public"."digicel" to "stephen@soprisapps.com";

grant delete on table "public"."document_links" to "anon";

grant insert on table "public"."document_links" to "anon";

grant references on table "public"."document_links" to "anon";

grant select on table "public"."document_links" to "anon";

grant trigger on table "public"."document_links" to "anon";

grant truncate on table "public"."document_links" to "anon";

grant update on table "public"."document_links" to "anon";

grant delete on table "public"."document_links" to "authenticated";

grant insert on table "public"."document_links" to "authenticated";

grant references on table "public"."document_links" to "authenticated";

grant select on table "public"."document_links" to "authenticated";

grant trigger on table "public"."document_links" to "authenticated";

grant truncate on table "public"."document_links" to "authenticated";

grant update on table "public"."document_links" to "authenticated";

grant delete on table "public"."document_links" to "service_role";

grant insert on table "public"."document_links" to "service_role";

grant references on table "public"."document_links" to "service_role";

grant select on table "public"."document_links" to "service_role";

grant trigger on table "public"."document_links" to "service_role";

grant truncate on table "public"."document_links" to "service_role";

grant update on table "public"."document_links" to "service_role";

grant delete on table "public"."document_links" to "stephen@soprisapps.com";

grant insert on table "public"."document_links" to "stephen@soprisapps.com";

grant references on table "public"."document_links" to "stephen@soprisapps.com";

grant select on table "public"."document_links" to "stephen@soprisapps.com";

grant trigger on table "public"."document_links" to "stephen@soprisapps.com";

grant truncate on table "public"."document_links" to "stephen@soprisapps.com";

grant update on table "public"."document_links" to "stephen@soprisapps.com";

grant delete on table "public"."document_processing_jobs" to "stephen@soprisapps.com";

grant insert on table "public"."document_processing_jobs" to "stephen@soprisapps.com";

grant references on table "public"."document_processing_jobs" to "stephen@soprisapps.com";

grant select on table "public"."document_processing_jobs" to "stephen@soprisapps.com";

grant trigger on table "public"."document_processing_jobs" to "stephen@soprisapps.com";

grant truncate on table "public"."document_processing_jobs" to "stephen@soprisapps.com";

grant update on table "public"."document_processing_jobs" to "stephen@soprisapps.com";

grant delete on table "public"."email_logs" to "anon";

grant insert on table "public"."email_logs" to "anon";

grant references on table "public"."email_logs" to "anon";

grant select on table "public"."email_logs" to "anon";

grant trigger on table "public"."email_logs" to "anon";

grant truncate on table "public"."email_logs" to "anon";

grant update on table "public"."email_logs" to "anon";

grant delete on table "public"."email_logs" to "authenticated";

grant insert on table "public"."email_logs" to "authenticated";

grant references on table "public"."email_logs" to "authenticated";

grant select on table "public"."email_logs" to "authenticated";

grant trigger on table "public"."email_logs" to "authenticated";

grant truncate on table "public"."email_logs" to "authenticated";

grant update on table "public"."email_logs" to "authenticated";

grant delete on table "public"."email_logs" to "service_role";

grant insert on table "public"."email_logs" to "service_role";

grant references on table "public"."email_logs" to "service_role";

grant select on table "public"."email_logs" to "service_role";

grant trigger on table "public"."email_logs" to "service_role";

grant truncate on table "public"."email_logs" to "service_role";

grant update on table "public"."email_logs" to "service_role";

grant delete on table "public"."email_logs" to "stephen@soprisapps.com";

grant insert on table "public"."email_logs" to "stephen@soprisapps.com";

grant references on table "public"."email_logs" to "stephen@soprisapps.com";

grant select on table "public"."email_logs" to "stephen@soprisapps.com";

grant trigger on table "public"."email_logs" to "stephen@soprisapps.com";

grant truncate on table "public"."email_logs" to "stephen@soprisapps.com";

grant update on table "public"."email_logs" to "stephen@soprisapps.com";

grant delete on table "public"."error_logs" to "anon";

grant insert on table "public"."error_logs" to "anon";

grant references on table "public"."error_logs" to "anon";

grant select on table "public"."error_logs" to "anon";

grant trigger on table "public"."error_logs" to "anon";

grant truncate on table "public"."error_logs" to "anon";

grant update on table "public"."error_logs" to "anon";

grant delete on table "public"."error_logs" to "authenticated";

grant insert on table "public"."error_logs" to "authenticated";

grant references on table "public"."error_logs" to "authenticated";

grant select on table "public"."error_logs" to "authenticated";

grant trigger on table "public"."error_logs" to "authenticated";

grant truncate on table "public"."error_logs" to "authenticated";

grant update on table "public"."error_logs" to "authenticated";

grant delete on table "public"."error_logs" to "service_role";

grant insert on table "public"."error_logs" to "service_role";

grant references on table "public"."error_logs" to "service_role";

grant select on table "public"."error_logs" to "service_role";

grant trigger on table "public"."error_logs" to "service_role";

grant truncate on table "public"."error_logs" to "service_role";

grant update on table "public"."error_logs" to "service_role";

grant delete on table "public"."error_logs" to "stephen@soprisapps.com";

grant insert on table "public"."error_logs" to "stephen@soprisapps.com";

grant references on table "public"."error_logs" to "stephen@soprisapps.com";

grant select on table "public"."error_logs" to "stephen@soprisapps.com";

grant trigger on table "public"."error_logs" to "stephen@soprisapps.com";

grant truncate on table "public"."error_logs" to "stephen@soprisapps.com";

grant update on table "public"."error_logs" to "stephen@soprisapps.com";

grant delete on table "public"."frenniy" to "stephen@soprisapps.com";

grant insert on table "public"."frenniy" to "stephen@soprisapps.com";

grant references on table "public"."frenniy" to "stephen@soprisapps.com";

grant select on table "public"."frenniy" to "stephen@soprisapps.com";

grant trigger on table "public"."frenniy" to "stephen@soprisapps.com";

grant truncate on table "public"."frenniy" to "stephen@soprisapps.com";

grant update on table "public"."frenniy" to "stephen@soprisapps.com";

grant delete on table "public"."g_g" to "stephen@soprisapps.com";

grant insert on table "public"."g_g" to "stephen@soprisapps.com";

grant references on table "public"."g_g" to "stephen@soprisapps.com";

grant select on table "public"."g_g" to "stephen@soprisapps.com";

grant trigger on table "public"."g_g" to "stephen@soprisapps.com";

grant truncate on table "public"."g_g" to "stephen@soprisapps.com";

grant update on table "public"."g_g" to "stephen@soprisapps.com";

grant delete on table "public"."gaiivo" to "stephen@soprisapps.com";

grant insert on table "public"."gaiivo" to "stephen@soprisapps.com";

grant references on table "public"."gaiivo" to "stephen@soprisapps.com";

grant select on table "public"."gaiivo" to "stephen@soprisapps.com";

grant trigger on table "public"."gaiivo" to "stephen@soprisapps.com";

grant truncate on table "public"."gaiivo" to "stephen@soprisapps.com";

grant update on table "public"."gaiivo" to "stephen@soprisapps.com";

grant delete on table "public"."glouglu" to "stephen@soprisapps.com";

grant insert on table "public"."glouglu" to "stephen@soprisapps.com";

grant references on table "public"."glouglu" to "stephen@soprisapps.com";

grant select on table "public"."glouglu" to "stephen@soprisapps.com";

grant trigger on table "public"."glouglu" to "stephen@soprisapps.com";

grant truncate on table "public"."glouglu" to "stephen@soprisapps.com";

grant update on table "public"."glouglu" to "stephen@soprisapps.com";

grant delete on table "public"."google_drive_links" to "anon";

grant insert on table "public"."google_drive_links" to "anon";

grant references on table "public"."google_drive_links" to "anon";

grant select on table "public"."google_drive_links" to "anon";

grant trigger on table "public"."google_drive_links" to "anon";

grant truncate on table "public"."google_drive_links" to "anon";

grant update on table "public"."google_drive_links" to "anon";

grant delete on table "public"."google_drive_links" to "authenticated";

grant insert on table "public"."google_drive_links" to "authenticated";

grant references on table "public"."google_drive_links" to "authenticated";

grant select on table "public"."google_drive_links" to "authenticated";

grant trigger on table "public"."google_drive_links" to "authenticated";

grant truncate on table "public"."google_drive_links" to "authenticated";

grant update on table "public"."google_drive_links" to "authenticated";

grant delete on table "public"."google_drive_links" to "service_role";

grant insert on table "public"."google_drive_links" to "service_role";

grant references on table "public"."google_drive_links" to "service_role";

grant select on table "public"."google_drive_links" to "service_role";

grant trigger on table "public"."google_drive_links" to "service_role";

grant truncate on table "public"."google_drive_links" to "service_role";

grant update on table "public"."google_drive_links" to "service_role";

grant delete on table "public"."google_drive_links" to "stephen@soprisapps.com";

grant insert on table "public"."google_drive_links" to "stephen@soprisapps.com";

grant references on table "public"."google_drive_links" to "stephen@soprisapps.com";

grant select on table "public"."google_drive_links" to "stephen@soprisapps.com";

grant trigger on table "public"."google_drive_links" to "stephen@soprisapps.com";

grant truncate on table "public"."google_drive_links" to "stephen@soprisapps.com";

grant update on table "public"."google_drive_links" to "stephen@soprisapps.com";

grant delete on table "public"."great_deal" to "stephen@soprisapps.com";

grant insert on table "public"."great_deal" to "stephen@soprisapps.com";

grant references on table "public"."great_deal" to "stephen@soprisapps.com";

grant select on table "public"."great_deal" to "stephen@soprisapps.com";

grant trigger on table "public"."great_deal" to "stephen@soprisapps.com";

grant truncate on table "public"."great_deal" to "stephen@soprisapps.com";

grant update on table "public"."great_deal" to "stephen@soprisapps.com";

grant delete on table "public"."imanye_3" to "stephen@soprisapps.com";

grant insert on table "public"."imanye_3" to "stephen@soprisapps.com";

grant references on table "public"."imanye_3" to "stephen@soprisapps.com";

grant select on table "public"."imanye_3" to "stephen@soprisapps.com";

grant trigger on table "public"."imanye_3" to "stephen@soprisapps.com";

grant truncate on table "public"."imanye_3" to "stephen@soprisapps.com";

grant update on table "public"."imanye_3" to "stephen@soprisapps.com";

grant delete on table "public"."invitations" to "anon";

grant insert on table "public"."invitations" to "anon";

grant references on table "public"."invitations" to "anon";

grant select on table "public"."invitations" to "anon";

grant trigger on table "public"."invitations" to "anon";

grant truncate on table "public"."invitations" to "anon";

grant update on table "public"."invitations" to "anon";

grant delete on table "public"."invitations" to "authenticated";

grant insert on table "public"."invitations" to "authenticated";

grant references on table "public"."invitations" to "authenticated";

grant select on table "public"."invitations" to "authenticated";

grant trigger on table "public"."invitations" to "authenticated";

grant truncate on table "public"."invitations" to "authenticated";

grant update on table "public"."invitations" to "authenticated";

grant delete on table "public"."invitations" to "service_role";

grant insert on table "public"."invitations" to "service_role";

grant references on table "public"."invitations" to "service_role";

grant select on table "public"."invitations" to "service_role";

grant trigger on table "public"."invitations" to "service_role";

grant truncate on table "public"."invitations" to "service_role";

grant update on table "public"."invitations" to "service_role";

grant delete on table "public"."invitations" to "stephen@soprisapps.com";

grant insert on table "public"."invitations" to "stephen@soprisapps.com";

grant references on table "public"."invitations" to "stephen@soprisapps.com";

grant select on table "public"."invitations" to "stephen@soprisapps.com";

grant trigger on table "public"."invitations" to "stephen@soprisapps.com";

grant truncate on table "public"."invitations" to "stephen@soprisapps.com";

grant update on table "public"."invitations" to "stephen@soprisapps.com";

grant delete on table "public"."mailer" to "stephen@soprisapps.com";

grant insert on table "public"."mailer" to "stephen@soprisapps.com";

grant references on table "public"."mailer" to "stephen@soprisapps.com";

grant select on table "public"."mailer" to "stephen@soprisapps.com";

grant trigger on table "public"."mailer" to "stephen@soprisapps.com";

grant truncate on table "public"."mailer" to "stephen@soprisapps.com";

grant update on table "public"."mailer" to "stephen@soprisapps.com";

grant delete on table "public"."manyel_2" to "stephen@soprisapps.com";

grant insert on table "public"."manyel_2" to "stephen@soprisapps.com";

grant references on table "public"."manyel_2" to "stephen@soprisapps.com";

grant select on table "public"."manyel_2" to "stephen@soprisapps.com";

grant trigger on table "public"."manyel_2" to "stephen@soprisapps.com";

grant truncate on table "public"."manyel_2" to "stephen@soprisapps.com";

grant update on table "public"."manyel_2" to "stephen@soprisapps.com";

grant delete on table "public"."metricool" to "stephen@soprisapps.com";

grant insert on table "public"."metricool" to "stephen@soprisapps.com";

grant references on table "public"."metricool" to "stephen@soprisapps.com";

grant select on table "public"."metricool" to "stephen@soprisapps.com";

grant trigger on table "public"."metricool" to "stephen@soprisapps.com";

grant truncate on table "public"."metricool" to "stephen@soprisapps.com";

grant update on table "public"."metricool" to "stephen@soprisapps.com";

grant delete on table "public"."n8n" to "stephen@soprisapps.com";

grant insert on table "public"."n8n" to "stephen@soprisapps.com";

grant references on table "public"."n8n" to "stephen@soprisapps.com";

grant select on table "public"."n8n" to "stephen@soprisapps.com";

grant trigger on table "public"."n8n" to "stephen@soprisapps.com";

grant truncate on table "public"."n8n" to "stephen@soprisapps.com";

grant update on table "public"."n8n" to "stephen@soprisapps.com";

grant delete on table "public"."n8n123" to "stephen@soprisapps.com";

grant insert on table "public"."n8n123" to "stephen@soprisapps.com";

grant references on table "public"."n8n123" to "stephen@soprisapps.com";

grant select on table "public"."n8n123" to "stephen@soprisapps.com";

grant trigger on table "public"."n8n123" to "stephen@soprisapps.com";

grant truncate on table "public"."n8n123" to "stephen@soprisapps.com";

grant update on table "public"."n8n123" to "stephen@soprisapps.com";

grant delete on table "public"."n8n_chat_histories" to "anon";

grant insert on table "public"."n8n_chat_histories" to "anon";

grant references on table "public"."n8n_chat_histories" to "anon";

grant select on table "public"."n8n_chat_histories" to "anon";

grant trigger on table "public"."n8n_chat_histories" to "anon";

grant truncate on table "public"."n8n_chat_histories" to "anon";

grant update on table "public"."n8n_chat_histories" to "anon";

grant delete on table "public"."n8n_chat_histories" to "authenticated";

grant insert on table "public"."n8n_chat_histories" to "authenticated";

grant references on table "public"."n8n_chat_histories" to "authenticated";

grant select on table "public"."n8n_chat_histories" to "authenticated";

grant trigger on table "public"."n8n_chat_histories" to "authenticated";

grant truncate on table "public"."n8n_chat_histories" to "authenticated";

grant update on table "public"."n8n_chat_histories" to "authenticated";

grant delete on table "public"."n8n_chat_histories" to "service_role";

grant insert on table "public"."n8n_chat_histories" to "service_role";

grant references on table "public"."n8n_chat_histories" to "service_role";

grant select on table "public"."n8n_chat_histories" to "service_role";

grant trigger on table "public"."n8n_chat_histories" to "service_role";

grant truncate on table "public"."n8n_chat_histories" to "service_role";

grant update on table "public"."n8n_chat_histories" to "service_role";

grant delete on table "public"."n8n_chat_histories" to "stephen@soprisapps.com";

grant insert on table "public"."n8n_chat_histories" to "stephen@soprisapps.com";

grant references on table "public"."n8n_chat_histories" to "stephen@soprisapps.com";

grant select on table "public"."n8n_chat_histories" to "stephen@soprisapps.com";

grant trigger on table "public"."n8n_chat_histories" to "stephen@soprisapps.com";

grant truncate on table "public"."n8n_chat_histories" to "stephen@soprisapps.com";

grant update on table "public"."n8n_chat_histories" to "stephen@soprisapps.com";

grant delete on table "public"."neem_25" to "stephen@soprisapps.com";

grant insert on table "public"."neem_25" to "stephen@soprisapps.com";

grant references on table "public"."neem_25" to "stephen@soprisapps.com";

grant select on table "public"."neem_25" to "stephen@soprisapps.com";

grant trigger on table "public"."neem_25" to "stephen@soprisapps.com";

grant truncate on table "public"."neem_25" to "stephen@soprisapps.com";

grant update on table "public"."neem_25" to "stephen@soprisapps.com";

grant delete on table "public"."news" to "stephen@soprisapps.com";

grant insert on table "public"."news" to "stephen@soprisapps.com";

grant references on table "public"."news" to "stephen@soprisapps.com";

grant select on table "public"."news" to "stephen@soprisapps.com";

grant trigger on table "public"."news" to "stephen@soprisapps.com";

grant truncate on table "public"."news" to "stephen@soprisapps.com";

grant update on table "public"."news" to "stephen@soprisapps.com";

grant delete on table "public"."news_2" to "stephen@soprisapps.com";

grant insert on table "public"."news_2" to "stephen@soprisapps.com";

grant references on table "public"."news_2" to "stephen@soprisapps.com";

grant select on table "public"."news_2" to "stephen@soprisapps.com";

grant trigger on table "public"."news_2" to "stephen@soprisapps.com";

grant truncate on table "public"."news_2" to "stephen@soprisapps.com";

grant update on table "public"."news_2" to "stephen@soprisapps.com";

grant delete on table "public"."news_3" to "stephen@soprisapps.com";

grant insert on table "public"."news_3" to "stephen@soprisapps.com";

grant references on table "public"."news_3" to "stephen@soprisapps.com";

grant select on table "public"."news_3" to "stephen@soprisapps.com";

grant trigger on table "public"."news_3" to "stephen@soprisapps.com";

grant truncate on table "public"."news_3" to "stephen@soprisapps.com";

grant update on table "public"."news_3" to "stephen@soprisapps.com";

grant delete on table "public"."news_4" to "stephen@soprisapps.com";

grant insert on table "public"."news_4" to "stephen@soprisapps.com";

grant references on table "public"."news_4" to "stephen@soprisapps.com";

grant select on table "public"."news_4" to "stephen@soprisapps.com";

grant trigger on table "public"."news_4" to "stephen@soprisapps.com";

grant truncate on table "public"."news_4" to "stephen@soprisapps.com";

grant update on table "public"."news_4" to "stephen@soprisapps.com";

grant delete on table "public"."news_5" to "stephen@soprisapps.com";

grant insert on table "public"."news_5" to "stephen@soprisapps.com";

grant references on table "public"."news_5" to "stephen@soprisapps.com";

grant select on table "public"."news_5" to "stephen@soprisapps.com";

grant trigger on table "public"."news_5" to "stephen@soprisapps.com";

grant truncate on table "public"."news_5" to "stephen@soprisapps.com";

grant update on table "public"."news_5" to "stephen@soprisapps.com";

grant delete on table "public"."news_one" to "stephen@soprisapps.com";

grant insert on table "public"."news_one" to "stephen@soprisapps.com";

grant references on table "public"."news_one" to "stephen@soprisapps.com";

grant select on table "public"."news_one" to "stephen@soprisapps.com";

grant trigger on table "public"."news_one" to "stephen@soprisapps.com";

grant truncate on table "public"."news_one" to "stephen@soprisapps.com";

grant update on table "public"."news_one" to "stephen@soprisapps.com";

grant delete on table "public"."nnmo1" to "stephen@soprisapps.com";

grant insert on table "public"."nnmo1" to "stephen@soprisapps.com";

grant references on table "public"."nnmo1" to "stephen@soprisapps.com";

grant select on table "public"."nnmo1" to "stephen@soprisapps.com";

grant trigger on table "public"."nnmo1" to "stephen@soprisapps.com";

grant truncate on table "public"."nnmo1" to "stephen@soprisapps.com";

grant update on table "public"."nnmo1" to "stephen@soprisapps.com";

grant delete on table "public"."notion" to "stephen@soprisapps.com";

grant insert on table "public"."notion" to "stephen@soprisapps.com";

grant references on table "public"."notion" to "stephen@soprisapps.com";

grant select on table "public"."notion" to "stephen@soprisapps.com";

grant trigger on table "public"."notion" to "stephen@soprisapps.com";

grant truncate on table "public"."notion" to "stephen@soprisapps.com";

grant update on table "public"."notion" to "stephen@soprisapps.com";

grant delete on table "public"."pet__pets" to "stephen@soprisapps.com";

grant insert on table "public"."pet__pets" to "stephen@soprisapps.com";

grant references on table "public"."pet__pets" to "stephen@soprisapps.com";

grant select on table "public"."pet__pets" to "stephen@soprisapps.com";

grant trigger on table "public"."pet__pets" to "stephen@soprisapps.com";

grant truncate on table "public"."pet__pets" to "stephen@soprisapps.com";

grant update on table "public"."pet__pets" to "stephen@soprisapps.com";

grant delete on table "public"."profiles" to "anon";

grant insert on table "public"."profiles" to "anon";

grant references on table "public"."profiles" to "anon";

grant select on table "public"."profiles" to "anon";

grant trigger on table "public"."profiles" to "anon";

grant truncate on table "public"."profiles" to "anon";

grant update on table "public"."profiles" to "anon";

grant delete on table "public"."profiles" to "authenticated";

grant insert on table "public"."profiles" to "authenticated";

grant references on table "public"."profiles" to "authenticated";

grant select on table "public"."profiles" to "authenticated";

grant trigger on table "public"."profiles" to "authenticated";

grant truncate on table "public"."profiles" to "authenticated";

grant update on table "public"."profiles" to "authenticated";

grant delete on table "public"."profiles" to "service_role";

grant insert on table "public"."profiles" to "service_role";

grant references on table "public"."profiles" to "service_role";

grant select on table "public"."profiles" to "service_role";

grant trigger on table "public"."profiles" to "service_role";

grant truncate on table "public"."profiles" to "service_role";

grant update on table "public"."profiles" to "service_role";

grant delete on table "public"."profiles" to "stephen@soprisapps.com";

grant insert on table "public"."profiles" to "stephen@soprisapps.com";

grant references on table "public"."profiles" to "stephen@soprisapps.com";

grant select on table "public"."profiles" to "stephen@soprisapps.com";

grant trigger on table "public"."profiles" to "stephen@soprisapps.com";

grant truncate on table "public"."profiles" to "stephen@soprisapps.com";

grant update on table "public"."profiles" to "stephen@soprisapps.com";

grant delete on table "public"."proque" to "stephen@soprisapps.com";

grant insert on table "public"."proque" to "stephen@soprisapps.com";

grant references on table "public"."proque" to "stephen@soprisapps.com";

grant select on table "public"."proque" to "stephen@soprisapps.com";

grant trigger on table "public"."proque" to "stephen@soprisapps.com";

grant truncate on table "public"."proque" to "stephen@soprisapps.com";

grant update on table "public"."proque" to "stephen@soprisapps.com";

grant delete on table "public"."proton" to "stephen@soprisapps.com";

grant insert on table "public"."proton" to "stephen@soprisapps.com";

grant references on table "public"."proton" to "stephen@soprisapps.com";

grant select on table "public"."proton" to "stephen@soprisapps.com";

grant trigger on table "public"."proton" to "stephen@soprisapps.com";

grant truncate on table "public"."proton" to "stephen@soprisapps.com";

grant update on table "public"."proton" to "stephen@soprisapps.com";

grant insert on table "public"."sadhana_forest" to "anon";

grant delete on table "public"."sadhana_forest" to "stephen@soprisapps.com";

grant insert on table "public"."sadhana_forest" to "stephen@soprisapps.com";

grant references on table "public"."sadhana_forest" to "stephen@soprisapps.com";

grant select on table "public"."sadhana_forest" to "stephen@soprisapps.com";

grant trigger on table "public"."sadhana_forest" to "stephen@soprisapps.com";

grant truncate on table "public"."sadhana_forest" to "stephen@soprisapps.com";

grant update on table "public"."sadhana_forest" to "stephen@soprisapps.com";

grant delete on table "public"."saldo" to "stephen@soprisapps.com";

grant insert on table "public"."saldo" to "stephen@soprisapps.com";

grant references on table "public"."saldo" to "stephen@soprisapps.com";

grant select on table "public"."saldo" to "stephen@soprisapps.com";

grant trigger on table "public"."saldo" to "stephen@soprisapps.com";

grant truncate on table "public"."saldo" to "stephen@soprisapps.com";

grant update on table "public"."saldo" to "stephen@soprisapps.com";

grant delete on table "public"."story" to "stephen@soprisapps.com";

grant insert on table "public"."story" to "stephen@soprisapps.com";

grant references on table "public"."story" to "stephen@soprisapps.com";

grant select on table "public"."story" to "stephen@soprisapps.com";

grant trigger on table "public"."story" to "stephen@soprisapps.com";

grant truncate on table "public"."story" to "stephen@soprisapps.com";

grant update on table "public"."story" to "stephen@soprisapps.com";

grant delete on table "public"."test5" to "stephen@soprisapps.com";

grant insert on table "public"."test5" to "stephen@soprisapps.com";

grant references on table "public"."test5" to "stephen@soprisapps.com";

grant select on table "public"."test5" to "stephen@soprisapps.com";

grant trigger on table "public"."test5" to "stephen@soprisapps.com";

grant truncate on table "public"."test5" to "stephen@soprisapps.com";

grant update on table "public"."test5" to "stephen@soprisapps.com";

grant delete on table "public"."test6_gmail_com" to "stephen@soprisapps.com";

grant insert on table "public"."test6_gmail_com" to "stephen@soprisapps.com";

grant references on table "public"."test6_gmail_com" to "stephen@soprisapps.com";

grant select on table "public"."test6_gmail_com" to "stephen@soprisapps.com";

grant trigger on table "public"."test6_gmail_com" to "stephen@soprisapps.com";

grant truncate on table "public"."test6_gmail_com" to "stephen@soprisapps.com";

grant update on table "public"."test6_gmail_com" to "stephen@soprisapps.com";

grant delete on table "public"."test7" to "stephen@soprisapps.com";

grant insert on table "public"."test7" to "stephen@soprisapps.com";

grant references on table "public"."test7" to "stephen@soprisapps.com";

grant select on table "public"."test7" to "stephen@soprisapps.com";

grant trigger on table "public"."test7" to "stephen@soprisapps.com";

grant truncate on table "public"."test7" to "stephen@soprisapps.com";

grant update on table "public"."test7" to "stephen@soprisapps.com";

grant delete on table "public"."test_98" to "stephen@soprisapps.com";

grant insert on table "public"."test_98" to "stephen@soprisapps.com";

grant references on table "public"."test_98" to "stephen@soprisapps.com";

grant select on table "public"."test_98" to "stephen@soprisapps.com";

grant trigger on table "public"."test_98" to "stephen@soprisapps.com";

grant truncate on table "public"."test_98" to "stephen@soprisapps.com";

grant update on table "public"."test_98" to "stephen@soprisapps.com";

grant delete on table "public"."test_agent_1741894950" to "stephen@soprisapps.com";

grant insert on table "public"."test_agent_1741894950" to "stephen@soprisapps.com";

grant references on table "public"."test_agent_1741894950" to "stephen@soprisapps.com";

grant select on table "public"."test_agent_1741894950" to "stephen@soprisapps.com";

grant trigger on table "public"."test_agent_1741894950" to "stephen@soprisapps.com";

grant truncate on table "public"."test_agent_1741894950" to "stephen@soprisapps.com";

grant update on table "public"."test_agent_1741894950" to "stephen@soprisapps.com";

grant delete on table "public"."test_agent_1741895003" to "stephen@soprisapps.com";

grant insert on table "public"."test_agent_1741895003" to "stephen@soprisapps.com";

grant references on table "public"."test_agent_1741895003" to "stephen@soprisapps.com";

grant select on table "public"."test_agent_1741895003" to "stephen@soprisapps.com";

grant trigger on table "public"."test_agent_1741895003" to "stephen@soprisapps.com";

grant truncate on table "public"."test_agent_1741895003" to "stephen@soprisapps.com";

grant update on table "public"."test_agent_1741895003" to "stephen@soprisapps.com";

grant delete on table "public"."test_xyt7ti" to "stephen@soprisapps.com";

grant insert on table "public"."test_xyt7ti" to "stephen@soprisapps.com";

grant references on table "public"."test_xyt7ti" to "stephen@soprisapps.com";

grant select on table "public"."test_xyt7ti" to "stephen@soprisapps.com";

grant trigger on table "public"."test_xyt7ti" to "stephen@soprisapps.com";

grant truncate on table "public"."test_xyt7ti" to "stephen@soprisapps.com";

grant update on table "public"."test_xyt7ti" to "stephen@soprisapps.com";

grant delete on table "public"."the_agent" to "anon";

grant insert on table "public"."the_agent" to "anon";

grant references on table "public"."the_agent" to "anon";

grant select on table "public"."the_agent" to "anon";

grant trigger on table "public"."the_agent" to "anon";

grant truncate on table "public"."the_agent" to "anon";

grant update on table "public"."the_agent" to "anon";

grant delete on table "public"."the_agent" to "authenticated";

grant insert on table "public"."the_agent" to "authenticated";

grant references on table "public"."the_agent" to "authenticated";

grant select on table "public"."the_agent" to "authenticated";

grant trigger on table "public"."the_agent" to "authenticated";

grant truncate on table "public"."the_agent" to "authenticated";

grant update on table "public"."the_agent" to "authenticated";

grant delete on table "public"."the_agent" to "service_role";

grant insert on table "public"."the_agent" to "service_role";

grant references on table "public"."the_agent" to "service_role";

grant select on table "public"."the_agent" to "service_role";

grant trigger on table "public"."the_agent" to "service_role";

grant truncate on table "public"."the_agent" to "service_role";

grant update on table "public"."the_agent" to "service_role";

grant delete on table "public"."the_agent" to "stephen@soprisapps.com";

grant insert on table "public"."the_agent" to "stephen@soprisapps.com";

grant references on table "public"."the_agent" to "stephen@soprisapps.com";

grant select on table "public"."the_agent" to "stephen@soprisapps.com";

grant trigger on table "public"."the_agent" to "stephen@soprisapps.com";

grant truncate on table "public"."the_agent" to "stephen@soprisapps.com";

grant update on table "public"."the_agent" to "stephen@soprisapps.com";

grant delete on table "public"."upwork" to "stephen@soprisapps.com";

grant insert on table "public"."upwork" to "stephen@soprisapps.com";

grant references on table "public"."upwork" to "stephen@soprisapps.com";

grant select on table "public"."upwork" to "stephen@soprisapps.com";

grant trigger on table "public"."upwork" to "stephen@soprisapps.com";

grant truncate on table "public"."upwork" to "stephen@soprisapps.com";

grant update on table "public"."upwork" to "stephen@soprisapps.com";

grant delete on table "public"."user_roles" to "stephen@soprisapps.com";

grant insert on table "public"."user_roles" to "stephen@soprisapps.com";

grant references on table "public"."user_roles" to "stephen@soprisapps.com";

grant select on table "public"."user_roles" to "stephen@soprisapps.com";

grant trigger on table "public"."user_roles" to "stephen@soprisapps.com";

grant truncate on table "public"."user_roles" to "stephen@soprisapps.com";

grant update on table "public"."user_roles" to "stephen@soprisapps.com";

grant delete on table "public"."vahalas" to "stephen@soprisapps.com";

grant insert on table "public"."vahalas" to "stephen@soprisapps.com";

grant references on table "public"."vahalas" to "stephen@soprisapps.com";

grant select on table "public"."vahalas" to "stephen@soprisapps.com";

grant trigger on table "public"."vahalas" to "stephen@soprisapps.com";

grant truncate on table "public"."vahalas" to "stephen@soprisapps.com";

grant update on table "public"."vahalas" to "stephen@soprisapps.com";

grant delete on table "public"."value1" to "stephen@soprisapps.com";

grant insert on table "public"."value1" to "stephen@soprisapps.com";

grant references on table "public"."value1" to "stephen@soprisapps.com";

grant select on table "public"."value1" to "stephen@soprisapps.com";

grant trigger on table "public"."value1" to "stephen@soprisapps.com";

grant truncate on table "public"."value1" to "stephen@soprisapps.com";

grant update on table "public"."value1" to "stephen@soprisapps.com";

grant delete on table "public"."value10" to "stephen@soprisapps.com";

grant insert on table "public"."value10" to "stephen@soprisapps.com";

grant references on table "public"."value10" to "stephen@soprisapps.com";

grant select on table "public"."value10" to "stephen@soprisapps.com";

grant trigger on table "public"."value10" to "stephen@soprisapps.com";

grant truncate on table "public"."value10" to "stephen@soprisapps.com";

grant update on table "public"."value10" to "stephen@soprisapps.com";

grant delete on table "public"."value11" to "stephen@soprisapps.com";

grant insert on table "public"."value11" to "stephen@soprisapps.com";

grant references on table "public"."value11" to "stephen@soprisapps.com";

grant select on table "public"."value11" to "stephen@soprisapps.com";

grant trigger on table "public"."value11" to "stephen@soprisapps.com";

grant truncate on table "public"."value11" to "stephen@soprisapps.com";

grant update on table "public"."value11" to "stephen@soprisapps.com";

grant delete on table "public"."value2" to "stephen@soprisapps.com";

grant insert on table "public"."value2" to "stephen@soprisapps.com";

grant references on table "public"."value2" to "stephen@soprisapps.com";

grant select on table "public"."value2" to "stephen@soprisapps.com";

grant trigger on table "public"."value2" to "stephen@soprisapps.com";

grant truncate on table "public"."value2" to "stephen@soprisapps.com";

grant update on table "public"."value2" to "stephen@soprisapps.com";

grant delete on table "public"."value6" to "stephen@soprisapps.com";

grant insert on table "public"."value6" to "stephen@soprisapps.com";

grant references on table "public"."value6" to "stephen@soprisapps.com";

grant select on table "public"."value6" to "stephen@soprisapps.com";

grant trigger on table "public"."value6" to "stephen@soprisapps.com";

grant truncate on table "public"."value6" to "stephen@soprisapps.com";

grant update on table "public"."value6" to "stephen@soprisapps.com";

grant delete on table "public"."value7" to "stephen@soprisapps.com";

grant insert on table "public"."value7" to "stephen@soprisapps.com";

grant references on table "public"."value7" to "stephen@soprisapps.com";

grant select on table "public"."value7" to "stephen@soprisapps.com";

grant trigger on table "public"."value7" to "stephen@soprisapps.com";

grant truncate on table "public"."value7" to "stephen@soprisapps.com";

grant update on table "public"."value7" to "stephen@soprisapps.com";

grant delete on table "public"."value8" to "stephen@soprisapps.com";

grant insert on table "public"."value8" to "stephen@soprisapps.com";

grant references on table "public"."value8" to "stephen@soprisapps.com";

grant select on table "public"."value8" to "stephen@soprisapps.com";

grant trigger on table "public"."value8" to "stephen@soprisapps.com";

grant truncate on table "public"."value8" to "stephen@soprisapps.com";

grant update on table "public"."value8" to "stephen@soprisapps.com";

grant delete on table "public"."value9" to "stephen@soprisapps.com";

grant insert on table "public"."value9" to "stephen@soprisapps.com";

grant references on table "public"."value9" to "stephen@soprisapps.com";

grant select on table "public"."value9" to "stephen@soprisapps.com";

grant trigger on table "public"."value9" to "stephen@soprisapps.com";

grant truncate on table "public"."value9" to "stephen@soprisapps.com";

grant update on table "public"."value9" to "stephen@soprisapps.com";

grant delete on table "public"."vidgu" to "stephen@soprisapps.com";

grant insert on table "public"."vidgu" to "stephen@soprisapps.com";

grant references on table "public"."vidgu" to "stephen@soprisapps.com";

grant select on table "public"."vidgu" to "stephen@soprisapps.com";

grant trigger on table "public"."vidgu" to "stephen@soprisapps.com";

grant truncate on table "public"."vidgu" to "stephen@soprisapps.com";

grant update on table "public"."vidgu" to "stephen@soprisapps.com";

grant delete on table "public"."vladd2a" to "stephen@soprisapps.com";

grant insert on table "public"."vladd2a" to "stephen@soprisapps.com";

grant references on table "public"."vladd2a" to "stephen@soprisapps.com";

grant select on table "public"."vladd2a" to "stephen@soprisapps.com";

grant trigger on table "public"."vladd2a" to "stephen@soprisapps.com";

grant truncate on table "public"."vladd2a" to "stephen@soprisapps.com";

grant update on table "public"."vladd2a" to "stephen@soprisapps.com";

grant delete on table "public"."vlooh" to "stephen@soprisapps.com";

grant insert on table "public"."vlooh" to "stephen@soprisapps.com";

grant references on table "public"."vlooh" to "stephen@soprisapps.com";

grant select on table "public"."vlooh" to "stephen@soprisapps.com";

grant trigger on table "public"."vlooh" to "stephen@soprisapps.com";

grant truncate on table "public"."vlooh" to "stephen@soprisapps.com";

grant update on table "public"."vlooh" to "stephen@soprisapps.com";

grant delete on table "public"."voigai" to "stephen@soprisapps.com";

grant insert on table "public"."voigai" to "stephen@soprisapps.com";

grant references on table "public"."voigai" to "stephen@soprisapps.com";

grant select on table "public"."voigai" to "stephen@soprisapps.com";

grant trigger on table "public"."voigai" to "stephen@soprisapps.com";

grant truncate on table "public"."voigai" to "stephen@soprisapps.com";

grant update on table "public"."voigai" to "stephen@soprisapps.com";

grant delete on table "public"."website_urls" to "anon";

grant insert on table "public"."website_urls" to "anon";

grant references on table "public"."website_urls" to "anon";

grant select on table "public"."website_urls" to "anon";

grant trigger on table "public"."website_urls" to "anon";

grant truncate on table "public"."website_urls" to "anon";

grant update on table "public"."website_urls" to "anon";

grant delete on table "public"."website_urls" to "authenticated";

grant insert on table "public"."website_urls" to "authenticated";

grant references on table "public"."website_urls" to "authenticated";

grant select on table "public"."website_urls" to "authenticated";

grant trigger on table "public"."website_urls" to "authenticated";

grant truncate on table "public"."website_urls" to "authenticated";

grant update on table "public"."website_urls" to "authenticated";

grant delete on table "public"."website_urls" to "service_role";

grant insert on table "public"."website_urls" to "service_role";

grant references on table "public"."website_urls" to "service_role";

grant select on table "public"."website_urls" to "service_role";

grant trigger on table "public"."website_urls" to "service_role";

grant truncate on table "public"."website_urls" to "service_role";

grant update on table "public"."website_urls" to "service_role";

grant delete on table "public"."website_urls" to "stephen@soprisapps.com";

grant insert on table "public"."website_urls" to "stephen@soprisapps.com";

grant references on table "public"."website_urls" to "stephen@soprisapps.com";

grant select on table "public"."website_urls" to "stephen@soprisapps.com";

grant trigger on table "public"."website_urls" to "stephen@soprisapps.com";

grant truncate on table "public"."website_urls" to "stephen@soprisapps.com";

grant update on table "public"."website_urls" to "stephen@soprisapps.com";

grant delete on table "public"."wechate" to "stephen@soprisapps.com";

grant insert on table "public"."wechate" to "stephen@soprisapps.com";

grant references on table "public"."wechate" to "stephen@soprisapps.com";

grant select on table "public"."wechate" to "stephen@soprisapps.com";

grant trigger on table "public"."wechate" to "stephen@soprisapps.com";

grant truncate on table "public"."wechate" to "stephen@soprisapps.com";

grant update on table "public"."wechate" to "stephen@soprisapps.com";

grant delete on table "public"."your_agent" to "stephen@soprisapps.com";

grant insert on table "public"."your_agent" to "stephen@soprisapps.com";

grant references on table "public"."your_agent" to "stephen@soprisapps.com";

grant select on table "public"."your_agent" to "stephen@soprisapps.com";

grant trigger on table "public"."your_agent" to "stephen@soprisapps.com";

grant truncate on table "public"."your_agent" to "stephen@soprisapps.com";

grant update on table "public"."your_agent" to "stephen@soprisapps.com";

create policy "Enable access to authenticated users"
on "public"."ai_agent"
as permissive
for all
to authenticated
using (true);


create policy "Enable all operations for service role"
on "public"."ai_agent"
as permissive
for all
to service_role
using (true)
with check (true);


create policy "Enable read for authenticated users"
on "public"."ai_agent"
as permissive
for select
to authenticated
using (true);


create policy "Admins can access all AI agents"
on "public"."ai_agents"
as permissive
for all
to authenticated
using ((EXISTS ( SELECT 1
   FROM user_roles
  WHERE ((user_roles.user_id = auth.uid()) AND (user_roles.role = 'admin'::app_role)))));


create policy "Allow delete access for all authenticated users"
on "public"."ai_agents"
as permissive
for delete
to authenticated
using (true);


create policy "Allow insert access for all authenticated users"
on "public"."ai_agents"
as permissive
for insert
to authenticated
with check (true);


create policy "Allow read access for all authenticated users"
on "public"."ai_agents"
as permissive
for select
to authenticated
using (true);


create policy "Allow update access for all authenticated users"
on "public"."ai_agents"
as permissive
for update
to authenticated
using (true);


create policy "Clients can access only their AI agent data"
on "public"."ai_agents"
as permissive
for all
to public
using ((client_id = auth.uid()));


create policy "Clients can access their own AI agents"
on "public"."ai_agents"
as permissive
for all
to authenticated
using ((client_id = auth.uid()));


create policy "Enable all access"
on "public"."airtable"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable all access"
on "public"."buffalo_school_board"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable all access"
on "public"."cc"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Allow all operations on client_activities"
on "public"."client_activities"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Allow inserting client activities"
on "public"."client_activities"
as permissive
for insert
to authenticated
with check (true);


create policy "Allow viewing client activities"
on "public"."client_activities"
as permissive
for select
to authenticated
using (true);


create policy "Enable insert access for authenticated users"
on "public"."client_activities"
as permissive
for insert
to authenticated
with check (true);


create policy "Enable read access for all users"
on "public"."client_activities"
as permissive
for select
to public
using (true);


create policy "Enable read access for authenticated users"
on "public"."client_activities"
as permissive
for select
to authenticated
using (true);


create policy "client_activities_all_operations"
on "public"."client_activities"
as permissive
for all
to public
using (true)
with check (true);


create policy "service_role_manage_all"
on "public"."client_invitations"
as permissive
for all
to service_role
using (true)
with check (true);


create policy "Authenticated users can insert temp passwords"
on "public"."client_temp_passwords"
as permissive
for insert
to authenticated
with check (true);


create policy "Authenticated users can select their own temp passwords"
on "public"."client_temp_passwords"
as permissive
for select
to authenticated
using ((auth.uid() = ( SELECT user_roles.user_id
   FROM user_roles
  WHERE (client_temp_passwords.agent_id = client_temp_passwords.agent_id))));


create policy "Edge functions can access all client_temp_passwords"
on "public"."client_temp_passwords"
as permissive
for all
to public
using (true)
with check (true);


create policy "Service role can do all operations"
on "public"."client_temp_passwords"
as permissive
for all
to service_role
using (true)
with check (true);


create policy "service_role_manage_all"
on "public"."client_temp_passwords"
as permissive
for all
to service_role
using (true)
with check (true);


create policy "Enable access to authenticated users"
on "public"."coca_cola"
as permissive
for all
to authenticated
using (true);


create policy "Enable all operations for service role"
on "public"."coca_cola"
as permissive
for all
to service_role
using (true)
with check (true);


create policy "Enable read for authenticated users"
on "public"."coca_cola"
as permissive
for select
to authenticated
using (true);


create policy "Enable all access"
on "public"."coins"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable read access for all users"
on "public"."common_queries"
as permissive
for select
to public
using (true);


create policy "Allow all operations for authenticated users"
on "public"."document_processing_jobs"
as permissive
for all
to authenticated
using (true);


create policy "Enable all for authenticated users"
on "public"."document_processing_jobs"
as permissive
for all
to public
using (true)
with check (true);


create policy "Admins can insert email logs"
on "public"."email_logs"
as permissive
for insert
to authenticated
with check ((auth.uid() IN ( SELECT user_roles.user_id
   FROM user_roles
  WHERE (user_roles.role = 'admin'::app_role))));


create policy "Users can view their own email logs"
on "public"."email_logs"
as permissive
for select
to authenticated
using ((auth.uid() IN ( SELECT user_roles.user_id
   FROM user_roles
  WHERE (user_roles.role = 'admin'::app_role))));


create policy "Enable read access for all users"
on "public"."error_logs"
as permissive
for select
to public
using (true);


create policy "Enable all access"
on "public"."gaiivo"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable all access"
on "public"."glouglu"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable all access"
on "public"."imanye_3"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Allow admins to manage invitations"
on "public"."invitations"
as permissive
for all
to public
using ((EXISTS ( SELECT 1
   FROM user_roles
  WHERE ((user_roles.user_id = auth.uid()) AND (user_roles.role = 'admin'::app_role)))));


create policy "Enable all access"
on "public"."mailer"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable all access"
on "public"."manyel_2"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable all access"
on "public"."metricool"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable all access"
on "public"."notion"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Users can read their own profile"
on "public"."profiles"
as permissive
for select
to public
using ((auth.uid() = id));


create policy "Users can update their own profile"
on "public"."profiles"
as permissive
for update
to public
using ((auth.uid() = id))
with check ((auth.uid() = id));


create policy "Enable all access"
on "public"."proton"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable access to authenticated users"
on "public"."sadhana_forest"
as permissive
for all
to authenticated
using (true);


create policy "Enable all operations for service role"
on "public"."sadhana_forest"
as permissive
for all
to service_role
using (true)
with check (true);


create policy "Enable read for authenticated users"
on "public"."sadhana_forest"
as permissive
for select
to authenticated
using (true);


create policy "Enable all access"
on "public"."saldo"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable all access"
on "public"."story"
as permissive
for all
to authenticated
using (true)
with check (true);


create policy "Enable access to authenticated users"
on "public"."the_agent"
as permissive
for all
to authenticated
using (true);


create policy "Enable all operations for service role"
on "public"."the_agent"
as permissive
for all
to service_role
using (true)
with check (true);


create policy "Enable read for authenticated users"
on "public"."the_agent"
as permissive
for select
to authenticated
using (true);


create policy "Enable access to authenticated users"
on "public"."upwork"
as permissive
for all
to authenticated
using (true);


create policy "Enable all operations for service role"
on "public"."upwork"
as permissive
for all
to service_role
using (true)
with check (true);


create policy "Enable read for authenticated users"
on "public"."upwork"
as permissive
for select
to authenticated
using (true);


create policy "Allow first admin setup"
on "public"."user_roles"
as permissive
for insert
to public
with check (((NOT (EXISTS ( SELECT 1
   FROM user_roles user_roles_1
  WHERE (user_roles_1.role = 'admin'::app_role)))) OR (EXISTS ( SELECT 1
   FROM user_roles user_roles_1
  WHERE ((user_roles_1.user_id = auth.uid()) AND (user_roles_1.role = 'admin'::app_role))))));


create policy "Users can read their own roles"
on "public"."user_roles"
as permissive
for select
to public
using ((auth.uid() = user_id));


create policy "Users can view their own roles"
on "public"."user_roles"
as permissive
for select
to authenticated
using ((user_id = auth.uid()));


CREATE TRIGGER update_ai_agents_updated_at BEFORE UPDATE ON public.ai_agents FOR EACH ROW EXECUTE FUNCTION update_ai_agents_updated_at();

CREATE TRIGGER update_common_queries_updated_at BEFORE UPDATE ON public.common_queries FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_document_processing_jobs_updated_at BEFORE UPDATE ON public.document_processing_jobs FOR EACH ROW EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER on_drive_link_created AFTER INSERT ON public.google_drive_links FOR EACH ROW EXECUTE FUNCTION handle_drive_link_creation();

CREATE TRIGGER on_drive_link_deleted BEFORE DELETE ON public.google_drive_links FOR EACH ROW EXECUTE FUNCTION handle_drive_link_deletion();

CREATE TRIGGER handle_updated_at BEFORE UPDATE ON public.profiles FOR EACH ROW EXECUTE FUNCTION moddatetime();

CREATE TRIGGER on_website_url_created AFTER INSERT ON public.website_urls FOR EACH ROW EXECUTE FUNCTION handle_url_creation();

CREATE TRIGGER on_website_url_deleted BEFORE DELETE ON public.website_urls FOR EACH ROW EXECUTE FUNCTION handle_url_deletion();


